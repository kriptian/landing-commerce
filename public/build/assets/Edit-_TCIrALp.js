import{A as Ce,r as _,c as E,z as Se,o as je,a as Ae,w as Oe,b as a,d as i,e as O,u as d,h as Ve,f as M,g as t,s as v,i as j,j as f,v as w,O as $e,m as I,F as k,l as A,t as C,C as Z,k as F,n as De}from"./app-C1p7wth_.js";import{_ as Ee}from"./AuthenticatedLayout-f39HC9dH.js";import{_ as ee}from"./AlertModal-DpSUIOE5.js";import{_ as Me}from"./Modal-BmdD5t2h.js";import{_ as ze}from"./SecondaryButton-CsXl9AGU.js";import{D as Pe}from"./DangerButton-BoiWZw1F.js";const Ue={class:"font-semibold text-xl text-gray-800 leading-tight"},Ie={class:"py-12"},Te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},qe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Be={class:"p-6 text-gray-900"},Le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ne={class:"mb-4"},Fe=t("label",{for:"name",class:"block font-medium text-sm text-gray-700"},"Nombre",-1),Ge={class:"mb-4"},He=t("label",{for:"price",class:"block font-medium text-sm text-gray-700"},"Precio (Principal)",-1),Re={class:"inline-flex items-center gap-2 mb-3 select-none"},Qe=t("span",{class:"font-semibold"},"Controlar inventario",-1),We={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Je=t("label",{for:"quantity",class:"block font-medium text-sm text-gray-700"},"Inventario (Total)",-1),Xe=["disabled"],Ye=t("label",{for:"alert_general",class:"block font-medium text-sm text-gray-700"},"Alerta (Opcional)",-1),Ke=["disabled"],Ze=t("label",{for:"purchase_price",class:"block font-medium text-sm text-gray-700"},"Precio de compra",-1),et={class:"mb-2"},tt=t("label",{class:"block font-medium text-sm text-gray-700"},"Categorías",-1),st={key:0,class:"mt-1 text-sm text-amber-600 font-medium"},ot={class:"space-y-3"},lt=["onUpdate:modelValue","onChange","required"],nt=t("option",{value:null},"Seleccione una categoría",-1),rt=["value"],at={key:1,class:"mt-1 text-sm text-red-600"},it={class:"mb-4"},dt=t("label",{for:"short_description",class:"block font-medium text-sm text-gray-700"},"Descripción Corta",-1),ct={class:"mb-4"},ut=t("label",{for:"long_description",class:"block font-medium text-sm text-gray-700"},"Descripción Larga",-1),pt={class:"mb-4"},mt=t("label",{for:"specifications",class:"block font-medium text-sm text-gray-700"},"Especificaciones (separadas por comas)",-1),ht={class:"md:col-span-2 mt-6 border-t pt-6"},gt=t("h3",{class:"text-lg font-medium text-gray-900"},"Atributos de variantes",-1),ft=t("p",{class:"text-sm text-gray-600 mb-4"},'Definí atributos como "Color" y "Talla" y sus valores separados por comas. Podés regenerar combinaciones.',-1),vt={class:"mb-4 p-4 border rounded-md bg-gray-50"},_t={class:"space-y-2"},bt={class:"md:col-span-2"},yt=t("label",{class:"block text-sm font-medium text-gray-700"},"Nombre",-1),xt=["onUpdate:modelValue"],wt={class:"md:col-span-3"},kt=t("label",{class:"block text-sm font-medium text-gray-700"},"Valores (separados por coma)",-1),Ct=["onUpdate:modelValue"],St={class:"md:col-span-5 flex items-center gap-2"},jt=["onClick","title","aria-label"],At={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},Ot=t("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"},null,-1),Vt=[Ot],$t={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},Dt=t("path",{d:"M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z"},null,-1),Et=[Dt],Mt=["textContent"],zt={key:0,class:"md:col-span-5 grid grid-cols-1 md:grid-cols-5 gap-3 items-start"},Pt={class:"md:col-span-2"},Ut=t("label",{class:"block text-sm font-medium text-gray-700"},"Depende de",-1),It=["onUpdate:modelValue"],Tt=t("option",{value:""},"(sin dependencia)",-1),qt=["value","disabled"],Bt={key:0,class:"md:col-span-3"},Lt=t("label",{class:"block text-sm font-medium text-gray-700"},"Permitir valores del hijo según el valor del padre",-1),Nt={class:"mt-2 space-y-3"},Ft={class:"text-xs font-semibold text-gray-700 mb-2"},Gt={class:"flex flex-wrap gap-3"},Ht=["checked","onChange"],Rt={class:"md:col-span-5 flex items-center gap-4 mt-3"},Qt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[t("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"})],-1),Wt=[Qt],Jt=t("span",{class:"text-xs md:hidden"},"Añadir",-1),Xt={class:"flex items-center gap-2"},Yt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[t("path",{d:"M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z"})],-1),Kt=[Yt],Zt=t("span",{class:"text-xs md:hidden"},"Quitar",-1),es={class:"mt-6 border-t pt-6"},ts={class:"p-4 border rounded-md bg-gray-50 col-span-2"},ss={class:"flex items-center justify-between mb-2"},os=t("label",{class:"block font-medium text-sm text-gray-700"},"Imágenes actuales",-1),ls={class:"text-xs text-gray-500"},ns={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3"},rs=["onClick"],as=["src"],is=["onClick"],ds={key:1,class:"text-sm text-gray-500 mt-2"},cs={class:"mt-4 col-span-2"},us=t("label",{for:"new_gallery_files",class:"block font-medium text-sm text-gray-700"},"Añadir más imágenes",-1),ps=t("p",{class:"mt-1 text-xs text-gray-500"},"Formatos de imagen y hasta 2 MB por archivo.",-1),ms={class:"relative flex items-center justify-center bg-gray-50 border rounded-lg h-[60vh] min-h-[320px] mb-3 select-none"},hs=["src"],gs={class:"flex items-center gap-2 overflow-x-auto py-2"},fs=["onClick"],vs=["src"],_s={class:"md:col-span-2 flex items-center justify-end mt-6 border-t pt-6"},bs=["disabled"],ys=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),t("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),xs=t("span",null,"Guardar",-1),ws=[ys,xs],ks={class:"p-6"},Cs=t("h2",{class:"text-lg font-medium text-gray-900"}," ¿Deseás guardar los cambios del producto? ",-1),Ss=t("p",{class:"mt-1 text-sm text-gray-600"}," Se actualizará la información y variantes del producto. ",-1),js={class:"mt-6 flex justify-end"},As=2*1024*1024,zs={__name:"Edit",props:{product:Object,categories:Array,selectedCategoryPath:Array},setup(te){const c=te,G=Ce(),T=_(!!G?.props?.flash?.success);_(G?.props?.flash?.success||"");const z=_(!1),V=_(!1),P=_([]),se=o=>{const s=Array.from(o?.target?.files||[]),e=[],l=[];for(const n of s){if(!(n?.type||"").startsWith("image/")){e.push(`${n.name}: no es una imagen válida.`);continue}if(n.size>As){e.push(`${n.name}: supera el límite de 2 MB.`);continue}l.push(n)}if(e.length){P.value=["Problemas con las imágenes seleccionadas:",...e],V.value=!0,o?.target&&(o.target.value=""),r.new_gallery_files=[];return}r.new_gallery_files=l},m=_([{options:c.categories,selected:null}]),oe=async()=>{if(!Array.isArray(c.selectedCategoryPath)||c.selectedCategoryPath.length===0)return;for(let s=0;s<c.selectedCategoryPath.length;s++){const e=c.selectedCategoryPath[s];if(m.value[s]||(m.value[s]={options:[],selected:null}),s>0&&m.value[s].options.length===0){const l=m.value[s-1].selected;if(l){const u=await(await fetch(route("admin.categories.children",l))).json();m.value[s].options=Array.isArray(u.data)?u.data:[]}}m.value[s].selected=e.id,r.category_id=e.id,s<c.selectedCategoryPath.length-1&&(m.value[s+1]||(m.value[s+1]={options:[],selected:null}))}const o=r.category_id;if(o){const e=await(await fetch(route("admin.categories.children",o))).json(),l=Array.isArray(e.data)?e.data:[];l.length>0&&m.value.push({options:l,selected:null})}},le=o=>{m.value.splice(o+1)},ne=async o=>{const s=m.value[o].selected;if(le(o),r.category_id=s||null,!s)return;const e=await fetch(route("admin.categories.children",s));if(!e.ok)return;const l=await e.json(),n=Array.isArray(l.data)?l.data:[];n.length>0&&(m.value.push({options:n,selected:null}),r.category_id=null)},U=E(()=>{if(m.value.length>1){const o=m.value[m.value.length-1];if(o.options.length>0&&!o.selected)return!m.value.some(e=>e.selected===r.category_id)}return!1}),re=o=>Object.entries(o).map(([s,e])=>`${s}:${e}`).join(", "),ae=c.product.variants.map(o=>({id:o.id,options_text:re(o.options),price:o.price??"",purchase_price:o.purchase_price??null,retail_price:o.retail_price??null,stock:o.stock,alert:o.alert??null})),r=Se({_method:"PUT",name:c.product.name,price:c.product.price,purchase_price:c.product.purchase_price??null,track_inventory:c.product.track_inventory??!0,quantity:c.product.quantity,alert:c.product.alert??null,category_id:c.product.category_id,short_description:c.product.short_description,long_description:c.product.long_description,specifications:c.product.specifications?JSON.parse(c.product.specifications).join(", "):"",new_gallery_files:[],images_to_delete:[],variants:ae,variants_to_delete:[],variant_attributes:[]}),b=_([{name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}}]),ie=()=>{b.value.push({name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}})},de=o=>{b.value.splice(o,1)},$=o=>String(o||"").split(",").map(s=>s.trim()).filter(Boolean);function ce(o,s,e){return(o.rulesSelected&&Array.isArray(o.rulesSelected[s])?o.rulesSelected[s]:[]).includes(e)}function ue(o,s,e,l){const n=!!l?.target?.checked;o.rulesSelected||(o.rulesSelected={});const u=Array.isArray(o.rulesSelected[s])?[...o.rulesSelected[s]]:[],g=u.indexOf(e);n&&g===-1&&u.push(e),!n&&g!==-1&&u.splice(g,1),o.rulesSelected[s]=u}function pe(o){o.__showDependency=!o.__showDependency,o.__showDependency||(o.dependsOn="",o.rulesSelected={},o.rules={})}const me=()=>{try{const o=Array.isArray(c.product.variants)?c.product.variants:[];if(o.length===0)return;const s=new Set;o.forEach(l=>{Object.keys(l?.options||{}).forEach(n=>s.add(n))});const e=[];s.forEach(l=>{const n=new Set;o.forEach(g=>{const p=(g?.options||{})[l];p!=null&&String(p).trim()!==""&&n.add(String(p))});const u=Array.from(n).join(", ");e.push({name:l,valuesText:u,dependsOn:"",rules:{},rulesSelected:{}})}),e.length>0&&(b.value=e)}catch{}},he=()=>{try{const o=c.product?.variant_attributes,s=Array.isArray(o)?o:[];if(s.length===0)return!1;const e=s.map(l=>{const n=Array.isArray(l?.values)?l.values:$(l?.valuesText||""),u=String(l?.dependsOn||"").trim(),g=typeof l?.rulesSelected=="object"&&l.rulesSelected?l.rulesSelected:{},p=typeof l?.rules=="object"&&l.rules?l.rules:{},x=!!(u||Object.keys(g).length||Object.keys(p).length);return{name:String(l?.name||""),valuesText:n.join(", "),dependsOn:u,rulesSelected:g,rules:p,__showDependency:x}}).filter(l=>l.name);if(e.length>0)return b.value=e,!0}catch{}return!1},ge=()=>{try{const o=c.product?.variant_attributes||[];if(!Array.isArray(o)||o.length===0)return;const s=Object.fromEntries(b.value.map(e=>[e.name,e]));for(const e of o){const l=s[e.name];l&&(e.dependsOn&&(l.dependsOn=e.dependsOn,l.__showDependency=!0),e.rulesSelected&&typeof e.rulesSelected=="object"?(l.rulesSelected=e.rulesSelected,Object.keys(l.rulesSelected||{}).length>0&&(l.__showDependency=!0)):e.rules&&typeof e.rules=="object"&&(l.rules=e.rules,Object.keys(l.rules||{}).length>0&&(l.__showDependency=!0)))}}catch{}},h=_([...c.product.images]),H=o=>{r.images_to_delete.push(o.id),h.value=h.value.filter(s=>s.id!==o.id)},q=_(!1),y=_(0),R=_(!1);function B(){R.value=window.innerWidth<768}je(()=>{B(),window.addEventListener("resize",B),oe(),he()||(me(),ge())}),Ae(()=>window.removeEventListener("resize",B));const L=E(()=>R.value?1:4),fe=E(()=>h.value.slice(0,L.value)),Q=E(()=>h.value.slice(L.value));function W(o=0){y.value=o,q.value=!0}function J(){q.value=!1}function ve(){const o=h.value.length;o!==0&&(y.value=(y.value-1+o)%o)}function _e(){const o=h.value.length;o!==0&&(y.value=(y.value+1)%o)}function be(o){o<0||o>=h.value.length||(y.value=o)}const ye=E(()=>{if(r.variants.length>0){let o=0;return r.variants.forEach(s=>{o+=Number(s.stock)||0}),o}return Number(r.quantity)||0});Oe(ye,o=>{r.variants.length>0&&(r.quantity=o)});const xe=()=>{if(U.value){P.value=["Debés seleccionar una subcategoría. La categoría principal tiene subcategorías disponibles y es obligatorio elegir una de ellas."],V.value=!0,De(()=>{const o=document.querySelector(".space-y-3 select");o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),o.focus())});return}try{const o=b.value.map(s=>({name:String(s.name||"").trim(),values:$(s.valuesText),dependsOn:String(s.dependsOn||"").trim(),rules:s.rules||{},rulesSelected:s.rulesSelected||{}})).filter(s=>s.name&&s.values.length>0);if(r.variant_attributes=o,o.length>0){let n=function(p){l.has(p.name)||(p.dependsOn&&s[p.dependsOn]&&n(s[p.dependsOn]),l.add(p.name),e.push(p))},g=function(p,x){if(p===e.length){u.push({...x});return}const S=e[p];let Y=S.values;if(S.dependsOn){const D=x[S.dependsOn];if(D!=null){const N=S.rulesSelected?.[D]??S.rules?.[D]??[],K=Array.isArray(N)?N:$(N);K.length>0&&(Y=S.values.filter(ke=>K.includes(ke)))}}for(const D of Y)x[S.name]=D,g(p+1,x);delete x[S.name]};const s=Object.fromEntries(o.map(p=>[p.name,p])),e=[],l=new Set;o.forEach(n);const u=[];g(0,{}),r.variants=u.map(p=>({id:null,options_text:e.map(x=>`${x.name}:${p[x.name]}`).join(", "),price:"",purchase_price:null,stock:0,alert:null}))}else r.variants=[]}catch{}z.value=!0},X=()=>{z.value=!1},we=()=>{r.post(route("admin.products.update",c.product.id),{onError:async()=>{const o=[];for(const[s,e]of Object.entries(r.errors))s.startsWith("new_gallery_files.")&&String(e).toLowerCase().includes("image")?o.push("Una o más imágenes nuevas superan el tamaño máximo permitido (2 MB) o no son válidas."):o.push(String(e));P.value=o,V.value=o.length>0},onFinish:()=>{z.value=!1}})};return(o,s)=>(i(),a(k,null,[O(d(Ve),{title:"Editar Producto"}),O(Ee,null,{header:M(()=>[t("h2",Ue,"Editar Producto: "+C(d(r).name),1)]),default:M(()=>[t("div",Ie,[t("div",Te,[t("div",qe,[t("div",Be,[t("form",{onSubmit:v(xe,["prevent"])},[t("div",Le,[t("div",null,[t("div",Ne,[Fe,f(t("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>d(r).name=e),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,d(r).name]])]),t("div",Ge,[He,f(t("input",{id:"price","onUpdate:modelValue":s[1]||(s[1]=e=>d(r).price=e),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,d(r).price]])]),t("label",Re,[f(t("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=e=>d(r).track_inventory=e),class:"rounded"},null,512),[[$e,d(r).track_inventory]]),Qe]),d(r).track_inventory?(i(),a("div",We,[t("div",null,[Je,f(t("input",{id:"quantity","onUpdate:modelValue":s[3]||(s[3]=e=>d(r).quantity=e),type:"number",class:I(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,required:"",title:"Stock si no hay variantes. Con variantes, se suma automáticamente."},null,10,Xe),[[w,d(r).quantity]])]),t("div",null,[Ye,f(t("input",{id:"alert_general","onUpdate:modelValue":s[4]||(s[4]=e=>d(r).alert=e),type:"number",class:I(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,title:"Se considera bajo stock cuando cantidad ≤ alerta."},null,10,Ke),[[w,d(r).alert]])]),t("div",null,[Ze,f(t("input",{id:"purchase_price","onUpdate:modelValue":s[5]||(s[5]=e=>d(r).purchase_price=e),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[w,d(r).purchase_price]])])])):j("",!0),t("div",et,[tt,U.value?(i(),a("p",st," ⚠️ Es obligatorio seleccionar una subcategoría ")):j("",!0)]),t("div",ot,[(i(!0),a(k,null,A(m.value,(e,l)=>(i(),a("div",{key:l,class:"mb-1"},[f(t("select",{class:I(["block w-full rounded-md shadow-sm border-gray-300",{"border-red-500":U.value&&l===m.value.length-1&&!e.selected}]),"onUpdate:modelValue":n=>e.selected=n,onChange:n=>ne(l),required:l===m.value.length-1&&e.options.length>0},[nt,(i(!0),a(k,null,A(e.options,n=>(i(),a("option",{key:n.id,value:n.id},C(n.name),9,rt))),128))],42,lt),[[Z,e.selected]])]))),128))]),U.value?(i(),a("p",at," Debés seleccionar una subcategoría. La categoría principal tiene subcategorías disponibles. ")):j("",!0)]),t("div",null,[t("div",it,[dt,f(t("textarea",{id:"short_description","onUpdate:modelValue":s[6]||(s[6]=e=>d(r).short_description=e),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3"},null,512),[[w,d(r).short_description]])]),t("div",ct,[ut,f(t("textarea",{id:"long_description","onUpdate:modelValue":s[7]||(s[7]=e=>d(r).long_description=e),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"5"},null,512),[[w,d(r).long_description]])]),t("div",pt,[mt,f(t("input",{id:"specifications","onUpdate:modelValue":s[8]||(s[8]=e=>d(r).specifications=e),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[w,d(r).specifications]])])])]),t("div",ht,[gt,ft,t("div",vt,[t("div",_t,[(i(!0),a(k,null,A(b.value,(e,l)=>(i(),a("div",{key:`attr-${l}`,class:"grid grid-cols-1 md:grid-cols-5 gap-3 items-center"},[t("div",bt,[yt,f(t("input",{"onUpdate:modelValue":n=>e.name=n,type:"text",placeholder:"Color",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,xt),[[w,e.name]])]),t("div",wt,[kt,f(t("input",{"onUpdate:modelValue":n=>e.valuesText=n,type:"text",placeholder:"Rojo, Verde, Azul",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,Ct),[[w,e.valuesText]])]),t("div",St,[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:n=>pe(e),title:e.__showDependency?"Ocultar dependencia":"Configurar dependencia","aria-label":e.__showDependency?"Ocultar dependencia":"Configurar dependencia"},[e.__showDependency?(i(),a("svg",$t,Et)):(i(),a("svg",At,Vt))],8,jt),t("span",{class:"text-xs text-blue-600 md:hidden",textContent:C(e.__showDependency?"Ocultar":"Depend.")},null,8,Mt)]),e.__showDependency?(i(),a("div",zt,[t("div",Pt,[Ut,f(t("select",{"onUpdate:modelValue":n=>e.dependsOn=n,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},[Tt,(i(!0),a(k,null,A(b.value,(n,u)=>(i(),a("option",{key:`dep-${l}-${u}`,value:n.name,disabled:n===e||!n.name},C(n.name||"(sin nombre)"),9,qt))),128))],8,It),[[Z,e.dependsOn]])]),e.dependsOn?(i(),a("div",Bt,[Lt,t("div",Nt,[(i(!0),a(k,null,A($(b.value.find(n=>n.name===e.dependsOn)?.valuesText||""),n=>(i(),a("div",{key:`pv-${l}-${n}`,class:"border rounded p-2"},[t("div",Ft,[F(C(e.dependsOn)+" = ",1),t("strong",null,C(n),1)]),t("div",Gt,[(i(!0),a(k,null,A($(e.valuesText),u=>(i(),a("label",{key:`cv-${l}-${n}-${u}`,class:"inline-flex items-center gap-1 text-sm"},[t("input",{type:"checkbox",checked:ce(e,n,u),onChange:g=>ue(e,n,u,g),class:"rounded"},null,40,Ht),t("span",null,C(u),1)]))),128))])]))),128))])])):j("",!0)])):j("",!0)]))),128))]),t("div",Rt,[t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:ie,title:"Añadir atributo","aria-label":"Añadir atributo"},Wt),Jt]),t("div",Xt,[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300",onClick:s[9]||(s[9]=e=>de(b.value.length-1)),title:"Quitar atributo","aria-label":"Quitar atributo"},Kt),Zt])])])]),t("div",es,[t("div",ts,[t("div",ss,[os,t("span",ls,C(h.value.length)+" imagen(es)",1)]),h.value.length>0?(i(),a("div",ns,[(i(!0),a(k,null,A(fe.value,(e,l)=>(i(),a("div",{key:e.id,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer",onClick:n=>W(l)},[t("img",{src:e.path,class:"w-full h-full aspect-[4/3] object-cover",alt:"Imagen del producto"},null,8,as),t("button",{onClick:v(n=>H(e),["stop","prevent"]),type:"button",class:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center shadow-md hover:bg-red-700"}," × ",8,is)],8,rs))),128)),Q.value.length>0?(i(),a("div",{key:0,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer flex items-center justify-center text-gray-800 font-bold text-base h-full min-h-[90px]",onClick:s[10]||(s[10]=e=>W(L.value))}," +"+C(Q.value.length),1)):j("",!0)])):(i(),a("p",ds,"Este producto no tiene imágenes."))]),t("div",cs,[us,t("input",{id:"new_gallery_files",onInput:s[11]||(s[11]=e=>se(e)),type:"file",multiple:"",class:"block mt-1 w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),ps])]),q.value?(i(),a("div",{key:0,class:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",style:{"pointer-events":"auto"},onClick:v(J,["self"])},[t("div",{class:"bg-white rounded-lg p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden relative",onClick:s[17]||(s[17]=v(()=>{},["stop"]))},[t("button",{type:"button",class:"absolute top-3 right-3 bg-gray-900 text-white rounded-full w-8 h-8 flex items-center justify-center z-30",onClick:v(J,["stop","prevent"]),onMousedown:s[12]||(s[12]=v(()=>{},["stop","prevent"]))},"×",32),t("div",ms,[t("button",{class:"absolute left-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:v(ve,["stop","prevent"]),onMousedown:s[13]||(s[13]=v(()=>{},["stop","prevent"]))},"‹",32),t("img",{src:h.value[y.value]?.path,class:"max-w-full max-h-full object-contain",alt:"Imagen"},null,8,hs),t("button",{class:"absolute right-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:v(_e,["stop","prevent"]),onMousedown:s[14]||(s[14]=v(()=>{},["stop","prevent"]))},"›",32),h.value[y.value]?(i(),a("button",{key:0,class:"absolute top-2 right-12 bg-red-600 text-white rounded px-2 py-1 text-xs z-20",type:"button",onClick:s[15]||(s[15]=v(e=>H(h.value[y.value]),["stop","prevent"])),onMousedown:s[16]||(s[16]=v(()=>{},["stop","prevent"]))},"Eliminar",32)):j("",!0)]),t("div",gs,[(i(!0),a(k,null,A(h.value,(e,l)=>(i(),a("div",{key:e.id,class:I(["border rounded p-1 cursor-pointer flex-shrink-0",{"ring-2 ring-blue-500":l===y.value}]),onClick:n=>be(l)},[t("img",{src:e.path,class:"w-20 h-20 object-cover rounded",alt:"thumb"},null,8,vs)],10,fs))),128))])])])):j("",!0),t("div",_s,[t("button",{type:"submit",disabled:d(r).processing,class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},ws,8,bs)])],32)])])])])]),_:1}),O(Me,{show:z.value,onClose:X},{default:M(()=>[t("div",ks,[Cs,Ss,t("div",js,[O(ze,{onClick:X},{default:M(()=>[F("Cancelar")]),_:1}),O(Pe,{class:"ms-3",onClick:we,disabled:d(r).processing},{default:M(()=>[F(" Guardar cambios ")]),_:1},8,["disabled"])])])]),_:1},8,["show"]),O(ee,{show:T.value,type:"success",title:"Producto actualizado","primary-text":"Entendido",onPrimary:s[18]||(s[18]=e=>T.value=!1),onClose:s[19]||(s[19]=e=>T.value=!1)},null,8,["show"]),O(ee,{show:V.value,type:"error",title:"No pudimos actualizar el producto",message:"Revisá los siguientes puntos:",messages:P.value,"primary-text":"Entendido",onPrimary:s[20]||(s[20]=e=>V.value=!1),onClose:s[21]||(s[21]=e=>V.value=!1)},null,8,["show","messages"])],64))}};export{zs as default};
