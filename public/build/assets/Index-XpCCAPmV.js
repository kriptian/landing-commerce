import{r,c as j,w as ee,B as te,C as q,D as se,a as o,o as n,b as d,d as P,h as ae,e as h,f as e,T as W,i as b,j as M,q as oe,m as D,t as l,F as k,n as G,p as x,E as U,s as K,g as ne,l as re,z as le}from"./app-DuuN3wQf.js";import{_ as ie}from"./AuthenticatedLayout-Ljt7PewI.js";import{_ as ce}from"./Pagination-CaDJwS3m.js";import"./AlertModal-DTAn80qJ.js";import"./Modal-BbwZiN4u.js";const ue=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestión de Inventario",-1),de={class:"py-12"},pe={class:"max-w-screen-2xl mx-auto sm:px-6 lg:px-8"},me={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},he={class:"p-6 text-gray-900"},xe={class:"mb-4 flex items-center justify-between"},ve={class:"flex items-center gap-3"},fe=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})],-1),_e=[fe],ye={key:0,class:"relative"},ge={class:"flex items-center gap-2"},we=["href"],be=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{d:"M7 10a1 1 0 011-1h2V4a1 1 0 112 0v5h2a1 1 0 01.7 1.714l-3 3a1 1 0 01-1.4 0l-3-3A1 1 0 017 10z"}),e("path",{d:"M5 15a1 1 0 011 1v2a2 2 0 002 2h8a2 2 0 002-2v-2a1 1 0 112 0v2a4 4 0 01-4 4H8a4 4 0 01-4-4v-2a1 1 0 011-1z"})],-1),ke={class:"relative z-30"},Le=e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"})],-1),Ee={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded-md shadow-lg z-50"},Se=["onClick"],ze={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},Ce={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},Ne={class:"min-w-[920px] sm:min-w-full divide-y divide-gray-200"},Me={class:"sticky top-0 z-10 bg-gray-50"},Te=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),Be=[Te],Ie=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"STOCK ACTUAL",-1),Fe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ COMPRA",-1),Re=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ VENTA",-1),Ae=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"% Gan.",-1),Ve=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ Gan.",-1),Oe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Estado",-1),Xe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap w-12"},[e("span",{class:"sr-only"},"Acciones")],-1),$e={class:"bg-white divide-y divide-gray-200"},je={key:0,class:"odd:bg-white even:bg-gray-100"},qe=["title"],Pe={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-800 font-bold"},We={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},De={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},Ge={key:0},Ue={key:1},Ke={key:0},He={key:1},Ye={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Je={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap w-12"},Qe=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),Ze={key:0},et=e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," No hay productos para mostrar. ",-1),tt=[et],H="inv_firstcol_w_px",st=90,at=320,ct={__name:"Index",props:{products:Object,filters:Object},setup(v){const L=v,f=r(!!L.filters?.search),p=r(L.filters?.search||""),c=r(L.filters?.status||""),T=r(null),_=r(!1),E=[{value:"",label:"Todos"},{value:"out_of_stock",label:"Agotados"},{value:"low_stock",label:"¡Pocas unidades!"}],Y=j(()=>(E.find(s=>s.value===c.value)||E[0]).label),J=async()=>{f.value=!f.value,f.value?(await q(),T.value?.focus()):(p.value="",S())},S=()=>{le.get(route("admin.inventory.index"),{search:p.value||void 0,status:c.value||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})};let B;ee(p,()=>{clearTimeout(B),B=setTimeout(()=>S(),350)});const Q=s=>{c.value=s,_.value=!1,S()},Z=s=>{if(!c.value)return!0;const a=Number(s.quantity)||0,t=Number(s.alert)||0;return c.value==="out_of_stock"?a<=0:c.value==="low_stock"?t>0&&a>0&&a<=t:!0},I=s=>{const a=Number(s.stock)||0,t=Number(s.alert)||0;return a<=0?{text:"Agotado",class:"bg-red-100 text-red-800"}:t>0&&a<=t?{text:"¡Pocas unidades!",class:"bg-yellow-100 text-yellow-800"}:{text:"En Stock",class:"bg-green-100 text-green-800"}},z=s=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(Number(s||0)),C=(s,a)=>{const t=Number(s||0),i=Number(a||0);return!t||!i||t<=0?null:Number(((i-t)/t*100).toFixed(2))},N=(s,a)=>{const t=Number(s||0),i=Number(a||0);if(!t||!i||t<=0)return null;const $=i-t;return $>=0?$:null},y=r(null),F=r(!1),R=r(!1),m=()=>{const s=y.value;if(!s)return;const a=s.scrollWidth-s.clientWidth,t=s.scrollLeft||0;F.value=t>0,R.value=t<a-1};te(()=>{q(()=>m()),y.value?.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",m)}),se(()=>{y.value?.removeEventListener("scroll",m),window.removeEventListener("resize",m)});const u=r(Number(localStorage.getItem(H))||180),A=j(()=>({width:u.value+"px",minWidth:u.value+"px",maxWidth:u.value+"px"}));let V=0,O=0;const g=s=>{const a=s.touches?s.touches[0].clientX:s.clientX,t=Math.max(st,Math.min(at,O+(a-V)));u.value=t},w=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",w),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",w);try{localStorage.setItem(H,String(u.value))}catch{}},X=s=>{V=s.touches?s.touches[0].clientX:s.clientX,O=u.value,document.addEventListener("mousemove",g,{passive:!1}),document.addEventListener("mouseup",w),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",w)};return(s,a)=>(n(),o(k,null,[d(P(ae),{title:"Gestión de Inventario"}),d(ie,null,{header:h(()=>[ue]),default:h(()=>[e("div",de,[e("div",pe,[e("div",me,[e("div",he,[e("div",xe,[e("div",ve,[e("button",{type:"button",onClick:J,class:"p-2 rounded hover:bg-gray-100 transition"},_e),d(W,{name:"fade-slide"},{default:h(()=>[f.value?(n(),o("div",ye,[M(e("input",{ref_key:"searchInputRef",ref:T,"onUpdate:modelValue":a[0]||(a[0]=t=>p.value=t),type:"text",placeholder:"Buscar producto...",class:"w-64 md:w-80 border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[oe,p.value]])])):b("",!0)]),_:1})]),e("div",ge,[e("a",{href:s.route("admin.inventory.export"),class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150"},[be,D(" Exportar a Excel ")],8,we),e("div",ke,[e("button",{type:"button",onClick:a[1]||(a[1]=t=>_.value=!_.value),class:"inline-flex items-center gap-2 px-3 py-2 border rounded-md shadow-sm hover:bg-gray-50"},[e("span",null,l(Y.value),1),Le]),d(W,{name:"fade-slide"},{default:h(()=>[_.value?(n(),o("ul",Ee,[(n(),o(k,null,G(E,t=>e("li",{key:t.value},[e("button",{type:"button",onClick:i=>Q(t.value),class:x(["w-full text-left px-3 py-2 hover:bg-gray-100",{"font-semibold text-indigo-600":t.value===c.value}])},l(t.label),11,Se)])),64))])):b("",!0)]),_:1})])])]),e("div",{ref_key:"scrollBoxRef",ref:y,class:"relative overflow-x-auto w-full z-0"},[M(e("div",ze,null,512),[[U,F.value]]),M(e("div",Ce,null,512),[[U,R.value]]),e("table",Ne,[e("thead",Me,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:K(A.value)},[D(" Producto "),e("div",{onMousedown:X,onTouchstart:ne(X,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},Be,32)],4),Ie,Fe,Re,Ae,Ve,Oe,Xe])]),e("tbody",$e,[(n(!0),o(k,null,G(v.products.data,(t,i)=>(n(),o(k,{key:t.id},[Z(t)?(n(),o("tr",je,[e("td",{class:x(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r truncate",i%2===1?"bg-gray-100":"bg-white"]),style:K(A.value),title:t.name},l(t.name),15,qe),e("td",Pe,l(t.quantity),1),e("td",We,l(z(t.purchase_price)),1),e("td",De,l(z(t.price)),1),e("td",{class:x(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":C(t.purchase_price,t.price)===null}])},[C(t.purchase_price,t.price)!==null?(n(),o("span",Ge,l(C(t.purchase_price,t.price))+"%",1)):(n(),o("span",Ue,"—"))],2),e("td",{class:x(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":N(t.purchase_price,t.price)===null}])},[N(t.purchase_price,t.price)!==null?(n(),o("span",Ke,l(z(N(t.purchase_price,t.price))),1)):(n(),o("span",He,"—"))],2),e("td",Ye,[e("span",{class:x(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",I({stock:t.quantity,alert:t.alert}).class])},l(I({stock:t.quantity,alert:t.alert}).text),3)]),e("td",Je,[d(P(re),{href:s.route("admin.products.edit",t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:h(()=>[Qe]),_:2},1032,["href"])])])):b("",!0)],64))),128)),v.products.data.length===0?(n(),o("tr",Ze,tt)):b("",!0)])])],512),d(ce,{class:"mt-6",links:v.products.links},null,8,["links"])])])])])]),_:1})],64))}};export{ct as default};
