import{_ as F}from"./AuthenticatedLayout-B8JLnoFT.js";import{H as V,c as v,r as N,B as I,a,o,b as w,y as $,f as t,d as k,h as S,t as s,i,F as _,n as m,e as x,l as O,m as j}from"./app-C7g-682V.js";import{d as T,s as L}from"./pdfUtils-BTHx2ArP.js";import"./AlertModal-D8VaOmQ5.js";import"./Modal-BJKt3I0d.js";const z={key:0,class:"min-h-screen bg-gray-50"},B={class:"bg-white border-b border-gray-200 px-6 py-4 no-print"},A={class:"flex items-center justify-between max-w-4xl mx-auto"},M={class:"font-semibold text-xl text-gray-800"},E={class:"flex gap-2"},q=["disabled"],U={key:0},G={key:1},R=t("span",{class:"hidden sm:inline"},"Descargar",-1),H=["disabled"],W={key:0},J={key:1},K=t("span",{class:"hidden sm:inline"},"Compartir",-1),Q=t("span",null,"ðŸ–¨ï¸",-1),X=t("span",{class:"hidden sm:inline"},"Imprimir",-1),Y=[Q,X],Z=t("span",null,"â¬…ï¸",-1),tt=t("span",{class:"hidden sm:inline"},"Volver",-1),et=[Z,tt],st={class:"py-12"},ot={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},at={class:"print-store-header"},nt={key:0,class:"text-center text-2xl font-bold mb-6 pb-4 border-b-2 border-black"},it={key:0,class:"watermark-container"},lt={class:"watermark-text"},ct={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg relative z-10"},dt={class:"p-6"},rt={class:"mb-6"},_t=t("h3",{class:"text-lg font-semibold mb-4"},"InformaciÃ³n de la Venta",-1),ut={class:"grid grid-cols-2 gap-4"},ht=t("p",{class:"text-sm text-gray-500"},"NÃºmero de Venta",-1),mt={class:"font-medium"},xt=t("p",{class:"text-sm text-gray-500"},"Fecha",-1),pt={class:"font-medium"},yt=t("p",{class:"text-sm text-gray-500"},"Vendedor",-1),bt={class:"font-medium"},gt=t("p",{class:"text-sm text-gray-500"},"MÃ©todo de Pago",-1),ft={class:"font-medium capitalize"},vt={key:0,class:"mt-4"},wt=t("p",{class:"text-sm text-gray-500"},"Notas",-1),kt={class:"font-medium"},jt={class:"mb-6"},Dt=t("h3",{class:"text-lg font-semibold mb-4"},"Productos Vendidos",-1),Pt={class:"overflow-x-auto"},Ct={class:"min-w-full divide-y divide-gray-200"},Ft=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Producto"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Cantidad"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Precio Unit."),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Descuento"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Subtotal")])],-1),Vt={class:"bg-white divide-y divide-gray-200"},Nt={class:"px-4 py-3"},It={class:"font-medium"},$t={key:0,class:"text-sm text-gray-500"},St={class:"px-4 py-3"},Ot={class:"px-4 py-3"},Tt={key:0},Lt={class:"text-sm text-gray-400 line-through"},zt={class:"font-medium"},Bt={key:1},At={class:"px-4 py-3"},Mt={key:0,class:"text-sm text-green-600 font-medium"},Et={key:1,class:"text-sm text-gray-400"},qt={class:"px-4 py-3 font-medium"},Ut={class:"border-t pt-4"},Gt={class:"flex justify-end"},Rt={class:"w-64 space-y-2"},Ht={class:"flex justify-between"},Wt=t("span",null,"Subtotal:",-1),Jt={key:0,class:"flex justify-between text-red-600"},Kt=t("span",null,"Descuento manual:",-1),Qt={class:"flex justify-between text-lg font-bold pt-2 border-t"},Xt=t("span",null,"Total:",-1),Yt={class:"flex items-center justify-between"},Zt={class:"font-semibold text-xl text-gray-800 leading-tight"},te={class:"flex gap-2"},ee=["disabled"],se={key:0},oe={key:1},ae=t("span",{class:"hidden sm:inline"},"Descargar",-1),ne=["disabled"],ie={key:0},le={key:1},ce=t("span",{class:"hidden sm:inline"},"Compartir",-1),de=t("span",null,"ðŸ–¨ï¸",-1),re=t("span",{class:"hidden sm:inline"},"Imprimir",-1),_e=[de,re],ue=t("span",null,"â¬…ï¸",-1),he=t("span",{class:"hidden sm:inline"},"Volver",-1),me={class:"py-12"},xe={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},pe={class:"print-store-header"},ye={class:"flex items-center justify-center gap-4 mb-6 pb-4 border-b-2 border-black"},be=["src"],ge={key:1,class:"text-3xl font-bold"},fe={key:0,class:"watermark-container"},ve={class:"watermark-text"},we={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg relative z-10"},ke={class:"p-6"},je={class:"mb-6"},De=t("h3",{class:"text-lg font-semibold mb-4"},"InformaciÃ³n de la Venta",-1),Pe={class:"grid grid-cols-2 gap-4"},Ce=t("p",{class:"text-sm text-gray-500"},"NÃºmero de Venta",-1),Fe={class:"font-medium"},Ve=t("p",{class:"text-sm text-gray-500"},"Fecha",-1),Ne={class:"font-medium"},Ie=t("p",{class:"text-sm text-gray-500"},"Vendedor",-1),$e={class:"font-medium"},Se=t("p",{class:"text-sm text-gray-500"},"MÃ©todo de Pago",-1),Oe={class:"font-medium capitalize"},Te={key:0,class:"mt-4"},Le=t("p",{class:"text-sm text-gray-500"},"Notas",-1),ze={class:"font-medium"},Be={class:"mb-6"},Ae=t("h3",{class:"text-lg font-semibold mb-4"},"Productos Vendidos",-1),Me={class:"overflow-x-auto"},Ee={class:"min-w-full divide-y divide-gray-200"},qe=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Producto"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Cantidad"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Precio Unit."),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Descuento"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Subtotal")])],-1),Ue={class:"bg-white divide-y divide-gray-200"},Ge={class:"px-4 py-3"},Re={class:"font-medium"},He={key:0,class:"text-sm text-gray-500"},We={class:"px-4 py-3"},Je={class:"px-4 py-3"},Ke={key:0},Qe={class:"text-sm text-gray-400 line-through"},Xe={class:"font-medium"},Ye={key:1},Ze={class:"px-4 py-3"},ts={key:0,class:"text-sm text-green-600 font-medium"},es={key:1,class:"text-sm text-gray-400"},ss={class:"px-4 py-3 font-medium"},os={class:"border-t pt-4"},as={class:"flex justify-end"},ns={class:"w-64 space-y-2"},is={class:"flex justify-between"},ls=t("span",null,"Subtotal:",-1),cs={key:0,class:"flex justify-between text-red-600"},ds=t("span",null,"Descuento manual:",-1),rs={class:"flex justify-between text-lg font-bold pt-2 border-t"},_s=t("span",null,"Total:",-1),us={id:"invoice-content-show",class:"fixed top-0 left-0 w-[80mm] bg-white z-[-100] opacity-0 pointer-events-none"},hs={class:"bg-white text-black p-2 font-mono text-[11px] leading-tight",style:{width:"80mm",margin:"0 auto","font-family":"'Courier New', Courier, monospace"}},ms={class:"text-center mb-4"},xs=["src"],ps={class:"font-bold text-base uppercase mb-1"},ys={class:"text-[10px] space-y-0.5",style:{"font-size":"10px"}},bs={key:0},gs={key:1,class:"whitespace-normal"},fs={key:2,class:"whitespace-normal"},vs={key:3,class:"whitespace-normal break-words"},ws={key:4,class:"whitespace-normal break-words"},ks=t("div",{class:"border-b-2 border-dashed border-black my-2"},null,-1),js={key:0},Ds={class:"mb-3 text-[10px] grid grid-cols-2 gap-x-2 gap-y-1"},Ps={class:"col-span-2 text-center mb-1"},Cs={class:"text-sm font-bold"},Fs={class:"text-[9px] text-gray-500"},Vs=t("span",{class:"font-bold block text-gray-600"},"Vendedor:",-1),Ns={class:"text-right"},Is=t("span",{class:"font-bold block text-gray-600"},"MÃ©todo de Pago:",-1),$s={class:"capitalize"},Ss={key:0,class:"col-span-2 mt-1 border-t border-dotted border-gray-300 pt-1"},Os=t("span",{class:"font-bold text-gray-600"},"Cliente:",-1),Ts={key:0},Ls=t("span",{class:"font-bold text-gray-600"},"NIT/CC:",-1),zs=t("div",{class:"border-b border-black my-2"},null,-1),Bs={class:"mb-4"},As=t("div",{class:"flex justify-between text-[9px] font-bold mb-2 uppercase text-gray-800"},[t("span",null,"DescripciÃ³n"),t("span",null,"Total")],-1),Ms={class:"font-bold text-[11px] leading-tight mb-0.5"},Es={key:0,class:"text-[9px] text-gray-500 italic mb-1"},qs={class:"flex justify-between items-start text-[10px] mt-1"},Us={class:"flex flex-col"},Gs={class:"text-gray-800"},Rs={key:0,class:"flex flex-col mt-0.5"},Hs={style:{"text-decoration":"line-through",color:"#9ca3af"},class:"text-[9px]"},Ws={class:"text-[9px] font-bold text-gray-800"},Js={class:"font-bold text-[11px] mt-0.5"},Ks=t("div",{class:"border-t border-black my-2 dashed"},null,-1),Qs={class:"text-right text-[11px] space-y-1"},Xs={key:0,class:"flex justify-between text-gray-600"},Ys=t("span",null,"Subtotal",-1),Zs={key:1,class:"flex justify-between text-gray-600"},to=t("span",null,"Descuento",-1),eo={class:"flex justify-between text-base font-black pt-1"},so=t("span",null,"TOTAL",-1),oo={class:"text-center mt-6 text-[10px] space-y-1 mb-4"},ao=t("p",{class:"font-medium"},"Â¡Gracias por su compra!",-1),no={key:0,class:"mt-2 pt-2 border-t border-dotted border-gray-300 text-left"},io=t("p",{class:"font-bold text-[9px] text-gray-500"},"Notas:",-1),lo={class:"italic"},mo={__name:"Show",props:{sale:Object,store:Object},setup(e){const c=l=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(l),r=e,D=V(),P=v(()=>(D.props.auth?.roles||[]).includes("physical-sales")),p=v(()=>!r.sale||!r.sale.items?[]:Array.isArray(r.sale.items)?r.sale.items:Object.values(r.sale.items)),d=N(!1),y=async()=>{if(r.sale){d.value=!0;try{const l=document.getElementById("invoice-content-show");l&&await T(l,`factura-${r.sale.sale_number}.pdf`)}catch(l){console.error(l),alert("Error al generar el PDF")}finally{d.value=!1}}},b=async()=>{if(r.sale){d.value=!0;try{const l=document.getElementById("invoice-content-show");l&&await L(l,`factura-${r.sale.sale_number}.pdf`,`Factura #${r.sale.sale_number}`)}catch(l){console.error(l)}finally{d.value=!1}}},C=()=>new URLSearchParams(window.location.search).get("print")==="true",g=()=>{window.print()};return I(()=>{C()&&setTimeout(()=>{window.print()},500)}),(l,f)=>(o(),a(_,null,[w(k(S),{title:"Detalle de Venta"}),P.value?(o(),a("div",z,[t("div",B,[t("div",A,[t("h2",M," Venta #"+s(e.sale.sale_number),1),t("div",E,[t("button",{onClick:y,class:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm flex items-center gap-1",disabled:d.value,title:"Descargar PDF"},[d.value?(o(),a("span",U,"â³")):(o(),a("span",G,"â¬‡ï¸")),R],8,q),t("button",{onClick:b,class:"px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm flex items-center gap-1",disabled:d.value,title:"Compartir Factura"},[d.value?(o(),a("span",W,"â³")):(o(),a("span",J,"ðŸ”—")),K],8,H),t("button",{onClick:g,class:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-1",title:"Imprimir"},Y),t("button",{onClick:f[0]||(f[0]=n=>l.$inertia.visit(l.route("admin.reports.index",{type:"physical"}))),class:"px-3 sm:px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 flex items-center gap-1",title:"Volver"},et)])])]),t("div",st,[t("div",ot,[t("div",at,[e.store?.name?(o(),a("h1",nt,s(e.store.name),1)):i("",!0)]),e.store?.name?(o(),a("div",it,[t("div",lt,s(e.store.name),1)])):i("",!0),t("div",ct,[t("div",dt,[t("div",rt,[_t,t("div",ut,[t("div",null,[ht,t("p",mt,"#"+s(e.sale.sale_number),1)]),t("div",null,[xt,t("p",pt,s(new Date(e.sale.created_at).toLocaleString()),1)]),t("div",null,[yt,t("p",bt,s(e.sale.user?.name||"Administrador"),1)]),t("div",null,[gt,t("p",ft,s(e.sale.payment_method),1)])]),e.sale.notes?(o(),a("div",vt,[wt,t("p",kt,s(e.sale.notes),1)])):i("",!0)]),t("div",jt,[Dt,t("div",Pt,[t("table",Ct,[Ft,t("tbody",Vt,[(o(!0),a(_,null,m(p.value,n=>(o(),a("tr",{key:n.id},[t("td",Nt,[t("p",It,s(n.product_name),1),n.variant_options?(o(),a("p",$t,s(Object.entries(n.variant_options).map(([u,h])=>`${u}: ${h}`).join(", ")),1)):i("",!0)]),t("td",St,s(n.quantity),1),t("td",Ot,[n.original_price&&n.original_price>n.unit_price?(o(),a("div",Tt,[t("p",Lt,s(c(n.original_price)),1),t("p",zt,s(c(n.unit_price)),1)])):(o(),a("p",Bt,s(c(n.unit_price)),1))]),t("td",At,[n.discount_percent>0?(o(),a("span",Mt," -"+s(n.discount_percent)+"% ",1)):(o(),a("span",Et,"-"))]),t("td",qt,s(c(n.subtotal)),1)]))),128))])])])]),t("div",Ut,[t("div",Gt,[t("div",Rt,[t("div",Ht,[Wt,t("span",null,"$"+s(parseFloat(e.sale.subtotal).toFixed(2)),1)]),e.sale.discount>0?(o(),a("div",Jt,[Kt,t("span",null,"-$"+s(parseFloat(e.sale.discount).toFixed(2)),1)])):i("",!0),t("div",Qt,[Xt,t("span",null,"$"+s(parseFloat(e.sale.total).toFixed(2)),1)])])])])])])])])])):(o(),$(F,{key:1},{header:x(()=>[t("div",Yt,[t("h2",Zt," Venta #"+s(e.sale.sale_number),1),t("div",te,[t("button",{onClick:y,class:"px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 text-sm flex items-center gap-1 no-print",disabled:d.value,title:"Descargar PDF"},[d.value?(o(),a("span",se,"â³")):(o(),a("span",oe,"â¬‡ï¸")),ae],8,ee),t("button",{onClick:b,class:"px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm flex items-center gap-1 no-print",disabled:d.value,title:"Compartir Factura"},[d.value?(o(),a("span",ie,"â³")):(o(),a("span",le,"ðŸ”—")),ce],8,ne),t("button",{onClick:g,class:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 no-print flex items-center gap-1",title:"Imprimir"},_e),w(k(O),{href:l.route("admin.reports.index",{type:"physical"}),class:"px-3 sm:px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 no-print flex items-center gap-1",title:"Volver"},{default:x(()=>[ue,he]),_:1},8,["href"])])])]),default:x(()=>[t("div",me,[t("div",xe,[t("div",pe,[t("div",ye,[e.store?.logo_url?(o(),a("img",{key:0,src:e.store.logo_url,alt:"Logo",class:"h-20 w-auto object-contain"},null,8,be)):i("",!0),e.store?.name?(o(),a("h1",ge,s(e.store.name),1)):i("",!0)])]),e.store?.name?(o(),a("div",fe,[t("div",ve,s(e.store.name),1)])):i("",!0),t("div",we,[t("div",ke,[t("div",je,[De,t("div",Pe,[t("div",null,[Ce,t("p",Fe,"#"+s(e.sale.sale_number),1)]),t("div",null,[Ve,t("p",Ne,s(new Date(e.sale.created_at).toLocaleString()),1)]),t("div",null,[Ie,t("p",$e,s(e.sale.user?.name||"N/A"),1)]),t("div",null,[Se,t("p",Oe,s(e.sale.payment_method),1)])]),e.sale.notes?(o(),a("div",Te,[Le,t("p",ze,s(e.sale.notes),1)])):i("",!0)]),t("div",Be,[Ae,t("div",Me,[t("table",Ee,[qe,t("tbody",Ue,[(o(!0),a(_,null,m(e.sale.items,n=>(o(),a("tr",{key:n.id},[t("td",Ge,[t("p",Re,s(n.product_name),1),n.variant_options?(o(),a("p",He,s(Object.entries(n.variant_options).map(([u,h])=>`${u}: ${h}`).join(", ")),1)):i("",!0)]),t("td",We,s(n.quantity),1),t("td",Je,[n.original_price&&n.original_price>n.unit_price?(o(),a("div",Ke,[t("p",Qe,s(c(n.original_price)),1),t("p",Xe,s(c(n.unit_price)),1)])):(o(),a("p",Ye,s(c(n.unit_price)),1))]),t("td",Ze,[n.discount_percent>0?(o(),a("span",ts," -"+s(n.discount_percent)+"% ",1)):(o(),a("span",es,"-"))]),t("td",ss,s(c(n.subtotal)),1)]))),128))])])])]),t("div",os,[t("div",as,[t("div",ns,[t("div",is,[ls,t("span",null,s(c(e.sale.subtotal)),1)]),e.sale.discount>0?(o(),a("div",cs,[ds,t("span",null,"-"+s(c(e.sale.discount)),1)])):i("",!0),t("div",rs,[_s,t("span",null,s(c(e.sale.total)),1)])])])])])])])])]),_:1})),t("div",us,[t("div",hs,[t("div",ms,[e.store?.logo_url?(o(),a("img",{key:0,src:e.store.logo_url,alt:"Logo",class:"h-12 w-auto object-contain mx-auto mb-2 grayscale",crossorigin:"anonymous"},null,8,xs)):i("",!0),t("h2",ps,s(e.store?.name),1),t("div",ys,[e.store?.nit?(o(),a("p",bs,"NIT: "+s(e.store.nit),1)):i("",!0),e.store?.address?(o(),a("p",gs,s(e.store.address),1)):i("",!0),e.store?.phone?(o(),a("p",fs,"Tel: "+s(e.store.phone?.startsWith("57")?e.store.phone.substring(2):e.store.phone),1)):i("",!0),e.store?.email?(o(),a("p",vs,s(e.store.email),1)):i("",!0),e.store?.custom_domain?(o(),a("p",ws,s(e.store.custom_domain),1)):i("",!0)])]),ks,e.sale?(o(),a("div",js,[t("div",Ds,[t("div",Ps,[t("p",Cs,"Venta #"+s(e.sale.sale_number),1),t("p",Fs,s(new Date(e.sale.created_at).toLocaleString("es-CO")),1)]),t("div",null,[Vs,t("span",null,s(e.sale.user?.name||l.$page.props.auth.user.name),1)]),t("div",Ns,[Is,t("span",$s,s(e.sale.payment_method),1)]),e.sale.customer_name?(o(),a("div",Ss,[t("p",null,[Os,j(" "+s(e.sale.customer_name),1)]),e.sale.customer_nit?(o(),a("p",Ts,[Ls,j(" "+s(e.sale.customer_nit),1)])):i("",!0)])):i("",!0)]),zs,t("div",Bs,[As,(o(!0),a(_,null,m(p.value,n=>(o(),a("div",{key:n.id,class:"mb-3 border-b border-gray-200 last:border-0 pb-2"},[t("div",Ms,s(n.product_name),1),n.variant_options?(o(),a("div",Es,s(Object.values(n.variant_options).join(" / ")),1)):i("",!0),t("div",qs,[t("div",Us,[t("span",Gs,s(n.quantity)+" x "+s(c(n.unit_price)),1),n.discount_percent>0||n.original_price&&n.original_price>n.unit_price?(o(),a("div",Rs,[t("span",Hs," Precio Normal: "+s(c(n.original_price||n.unit_price*100/(100-n.discount_percent))),1),t("span",Ws," Desc: "+s(n.discount_percent||Math.round((1-n.unit_price/n.original_price)*100))+"% ",1)])):i("",!0)]),t("div",Js,s(c(n.subtotal)),1)])]))),128))]),Ks,t("div",Qs,[e.sale.discount>0?(o(),a("div",Xs,[Ys,t("span",null,s(c(e.sale.subtotal)),1)])):i("",!0),e.sale.discount>0?(o(),a("div",Zs,[to,t("span",null,"-"+s(c(e.sale.discount)),1)])):i("",!0),t("div",eo,[so,t("span",null,s(c(e.sale.total)),1)])]),t("div",oo,[ao,e.sale.notes?(o(),a("div",no,[io,t("p",lo,s(e.sale.notes),1)])):i("",!0)])])):i("",!0)])])],64))}};export{mo as default};
