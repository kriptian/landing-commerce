const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B2rw9mKU.js","assets/app-CPrrGJQ0.js","assets/app-rw71YK5a.css"])))=>i.map(i=>d[i]);
import{H as _t,r as h,c as $,u as bt,w as ae,B as yt,D as wt,a as d,o as u,b as k,d as p,h as xt,e as O,f as a,g as C,i as y,j as _,q as w,p as P,m as H,k as kt,F as A,n as B,t as E,x as Ae,A as Ct,C as pe,_ as St}from"./app-CPrrGJQ0.js";import{_ as Pt}from"./AuthenticatedLayout-eGVzcISm.js";import{_ as oe}from"./AlertModal-CBpFEsOg.js";import{_ as ve}from"./Modal-BkOswT5G.js";import{_ as Vt}from"./PrimaryButton-D3t8Fx2S.js";import{_ as Ee}from"./SecondaryButton-CWlETvd7.js";import{D as jt}from"./DangerButton-ETOxBHjN.js";import At from"./VariantInventoryModal-CTE5rul8.js";const Et={class:"font-semibold text-xl text-gray-800 leading-tight"},Mt={class:"py-12"},$t={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ot={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Bt={class:"p-6 text-gray-900"},Tt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ut={class:"mb-4"},zt=a("label",{for:"name",class:"block font-medium text-sm text-gray-700"},"Nombre",-1),Dt={class:"mb-4"},qt=a("label",{for:"barcode",class:"block font-medium text-sm text-gray-700 mb-1"},"CÃ³digo de Barras (Opcional)",-1),Nt={class:"flex gap-2"},Ht=["disabled","title"],Lt=a("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1),Ft={class:"mb-4"},Gt=a("label",{for:"price",class:"block font-medium text-sm text-gray-700"},"Precio (Principal)",-1),Rt={class:"inline-flex items-center gap-2 mb-3 select-none"},Wt=a("span",{class:"font-semibold"},"Controlar inventario",-1),Qt={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Kt=a("label",{for:"quantity",class:"block font-medium text-sm text-gray-700"},"Inventario (Total)",-1),Jt=["disabled","required"],Xt=a("label",{for:"alert_general",class:"block font-medium text-sm text-gray-700"},"Alerta (Opcional)",-1),Yt=["disabled"],Zt=a("label",{for:"purchase_price",class:"block font-medium text-sm text-gray-700"},"Precio de compra",-1),It=["disabled"],es={class:"mb-2"},ts=a("label",{class:"block font-medium text-sm text-gray-700"},"CategorÃ­as",-1),ss={key:0,class:"mt-1 text-sm text-amber-600 font-medium"},as={class:"space-y-3"},os=["onUpdate:modelValue","onChange","required"],ns=a("option",{value:null},"Seleccione una categorÃ­a",-1),rs=["value"],ls={key:1,class:"mt-1 text-sm text-red-600"},is={class:"mb-4"},cs=a("label",{for:"short_description",class:"block font-medium text-sm text-gray-700"},"DescripciÃ³n Corta",-1),ds={class:"mb-4"},us=a("label",{for:"long_description",class:"block font-medium text-sm text-gray-700"},"DescripciÃ³n Larga",-1),ms={class:"mb-4"},ps=a("label",{for:"specifications",class:"block font-medium text-sm text-gray-700"},"Especificaciones (separadas por comas)",-1),vs={class:"mb-4"},gs=a("label",{for:"meta_keywords",class:"block font-medium text-sm text-gray-700"},"Palabras Clave SEO (separadas por comas)",-1),hs=a("p",{class:"mt-1 text-xs text-gray-500"},"Estas palabras clave ayudan a mejorar el SEO del producto. No son visibles para los clientes.",-1),fs={class:"md:col-span-2 mt-6 border-t pt-6"},_s={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},bs={class:"p-6 text-gray-900"},ys={class:"flex items-center justify-between"},ws=a("h3",{class:"text-lg font-medium"},"Variantes del Producto",-1),xs={class:"flex items-center gap-2"},ks={class:"mt-4 border rounded-lg divide-y"},Cs={key:0,class:"text-sm text-gray-500 p-3"},Ss={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2"},Ps={class:"flex-1 min-w-0"},Vs={class:"flex items-center gap-2"},js=["title","onClick"],As={key:0},Es={key:1},Ms=["onUpdate:modelValue"],$s={key:0,class:"flex-shrink-0 text-xs bg-gray-100 text-gray-700 rounded px-2 py-0.5 align-middle"},Os={class:"flex items-center gap-2 flex-shrink-0"},Bs=["title","onClick"],Ts=a("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),Us=[Ts],zs=["onClick"],Ds=a("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[a("rect",{x:"4",y:"3",width:"11",height:"15",rx:"2",ry:"2","stroke-width":"1.5"}),a("circle",{cx:"18",cy:"18",r:"3","stroke-width":"1.5"}),a("path",{"stroke-linecap":"round","stroke-width":"1.5",d:"M18 16.5v3M16.5 18h3"})],-1),qs=[Ds],Ns=["onClick"],Hs=a("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),Ls=[Hs],Fs={key:0,class:"mt-2 pl-2 bg-gray-50 rounded-md p-2"},Gs={class:"grid grid-cols-1 md:grid-cols-5 gap-3"},Rs={class:"md:col-span-2"},Ws=a("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Depende de",-1),Qs=["onUpdate:modelValue"],Ks=a("option",{value:""},"(sin dependencia)",-1),Js=["value","disabled"],Xs={key:0,class:"md:col-span-3"},Ys=a("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Permitir valores segÃºn el valor del padre",-1),Zs={class:"mt-2 space-y-2"},Is={class:"text-xs font-semibold text-gray-700 mb-1"},ea={class:"flex flex-wrap gap-2"},ta=["checked","onChange"],sa={key:1,class:"mt-2 pl-4 border-l"},aa={class:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-3"},oa=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Nombre",-1),na=["onUpdate:modelValue"],ra=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Precio (opcional)",-1),la=["onUpdate:modelValue","disabled","onInput"],ia={key:0,class:"mt-1 text-xs text-amber-600"},ca={class:"flex items-center gap-2"},da=["onChange","id","disabled"],ua={key:0,class:"relative"},ma=["src"],pa=["onClick"],va=["for","title"],ga=a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 h-5 text-gray-400",fill:"currentColor"},[a("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1),ha=[ga],fa={key:2,class:"mt-1 text-xs text-amber-600"},_a=a("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"CÃ³digo de Barras",-1),ba={class:"flex gap-1"},ya=["onUpdate:modelValue","disabled"],wa=["onClick","disabled"],xa=a("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})],-1),ka=[xa],Ca=["onClick","disabled"],Sa=a("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1),Pa=[Sa],Va={key:0,class:"mt-1 text-xs text-amber-600"},ja={key:1,class:"mt-1 text-xs text-amber-600"},Aa={class:"flex items-center gap-2 ml-2"},Ea=["onClick"],Ma=a("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),$a=[Ma],Oa=a("label",{class:"block font-medium text-sm text-gray-700"},"AÃ±adir Nueva Variante Principal",-1),Ba={class:"mt-2 flex items-center gap-2"},Ta=a("button",{type:"submit",class:"w-8 h-8 inline-flex items-center justify-center rounded bg-green-500 text-white hover:bg-green-600",title:"AÃ±adir"}," âœ” ",-1),Ua={class:"md:col-span-2 mt-6 border-t pt-6"},za=a("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"ImÃ¡genes Extra de la GalerÃ­a",-1),Da=a("p",{class:"text-sm text-gray-600 mb-4"}," Estas imÃ¡genes se agregarÃ¡n a la galerÃ­a general del producto. Las imÃ¡genes de las variantes se muestran cuando se selecciona esa opciÃ³n. ",-1),qa={class:"p-4 border rounded-md bg-gray-50 col-span-2"},Na={class:"flex items-center justify-between mb-2"},Ha=a("label",{class:"block font-medium text-sm text-gray-700"},"ImÃ¡genes actuales",-1),La={class:"text-xs text-gray-500"},Fa={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3"},Ga=["onClick"],Ra=["src"],Wa=["onClick"],Qa={key:1,class:"text-sm text-gray-500 mt-2"},Ka={class:"mt-4 col-span-2"},Ja=a("label",{for:"new_gallery_files",class:"block font-medium text-sm text-gray-700"},"AÃ±adir mÃ¡s imÃ¡genes",-1),Xa=a("p",{class:"mt-1 text-xs text-gray-500"},"Formatos de imagen y hasta 2 MB por archivo.",-1),Ya={class:"relative flex items-center justify-center bg-gray-50 border rounded-lg h-[60vh] min-h-[320px] mb-3 select-none"},Za=["src"],Ia={class:"flex items-center gap-2 overflow-x-auto py-2"},eo=["onClick"],to=["src"],so={class:"md:col-span-2 flex items-center justify-end mt-6 border-t pt-6"},ao=["disabled"],oo=a("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[a("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),a("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),no=a("span",null,"Guardar",-1),ro=[oo,no],lo={class:"p-6"},io=a("h2",{class:"text-lg font-medium text-gray-900"}," Â¿DeseÃ¡s guardar los cambios del producto? ",-1),co=a("p",{class:"mt-1 text-sm text-gray-600"}," Se actualizarÃ¡ la informaciÃ³n y variantes del producto. ",-1),uo={class:"mt-6 flex justify-end"},mo={class:"p-6"},po=a("h2",{class:"text-lg font-semibold mb-4"},"Escanear CÃ³digo de Barras",-1),vo=a("div",{class:"mb-4"},[a("p",{class:"text-sm text-gray-600 mb-4"}," Apunta la cÃ¡mara hacia el cÃ³digo de barras. El cÃ³digo se detectarÃ¡ automÃ¡ticamente. "),a("div",{id:"barcode-scanner-edit",class:"w-full rounded-lg overflow-hidden",style:{"min-height":"300px"}})],-1),go={class:"flex gap-3"},ho={class:"p-6"},fo=a("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"Â¡CÃ³digo de barras escaneado!",-1),_o={class:"mb-4"},bo=a("p",{class:"text-sm text-gray-600 mb-2"}," CÃ³digo escaneado: ",-1),yo={class:"text-lg font-semibold text-gray-900"},wo={class:"flex gap-3"},Me=2*1024*1024,Eo={__name:"Edit",props:{product:Object,categories:Array,selectedCategoryPath:Array},setup($e){const m=$e,ge=_t(),W=h(!!ge?.props?.flash?.success),Oe=h(ge?.props?.flash?.success||""),D=h(!1),T=h(!1),L=h([]),F=h(!1),U=h(null),Q=h(!1),he=h(""),K=h(null),Be=()=>{try{const s=new(window.AudioContext||window.webkitAudioContext),e=s.createOscillator(),t=s.createGain();e.connect(t),t.connect(s.destination),e.frequency.value=800,e.type="sine",t.gain.setValueAtTime(.3,s.currentTime),t.gain.exponentialRampToValueAtTime(.01,s.currentTime+.2),e.start(s.currentTime),e.stop(s.currentTime+.2)}catch{}},Te=s=>{const e=Array.from(s?.target?.files||[]),t=[],o=[];for(const n of e){if(!(n?.type||"").startsWith("image/")){t.push(`${n.name}: no es una imagen vÃ¡lida.`);continue}if(n.size>Me){t.push(`${n.name}: supera el lÃ­mite de 2 MB.`);continue}o.push(n)}if(t.length){L.value=["Problemas con las imÃ¡genes seleccionadas:",...t],T.value=!0,s?.target&&(s.target.value=""),r.new_gallery_files=[];return}r.new_gallery_files=o},f=h([{options:m.categories,selected:null}]),Ue=async()=>{if(!Array.isArray(m.selectedCategoryPath)||m.selectedCategoryPath.length===0)return;for(let e=0;e<m.selectedCategoryPath.length;e++){const t=m.selectedCategoryPath[e];if(f.value[e]||(f.value[e]={options:[],selected:null}),e>0&&f.value[e].options.length===0){const o=f.value[e-1].selected;if(o)try{const n=await window.axios.get(route("admin.categories.children",o));f.value[e].options=Array.isArray(n.data?.data)?n.data.data:[]}catch{f.value[e].options=[]}}f.value[e].selected=t.id,r.category_id=t.id,e<m.selectedCategoryPath.length-1&&(f.value[e+1]||(f.value[e+1]={options:[],selected:null}))}const s=r.category_id;if(s)try{const e=await window.axios.get(route("admin.categories.children",s)),t=Array.isArray(e.data?.data)?e.data.data:[];t.length>0&&f.value.push({options:t,selected:null})}catch{}},ze=s=>{f.value.splice(s+1)},De=async s=>{const e=f.value[s].selected;if(ze(s),r.category_id=e||null,!!e)try{const t=await window.axios.get(route("admin.categories.children",e)),o=Array.isArray(t.data?.data)?t.data.data:[];o.length>0&&(f.value.push({options:o,selected:null}),r.category_id=null)}catch{}},J=$(()=>{if(f.value.length>1){const s=f.value[f.value.length-1];if(s.options.length>0&&!s.selected)return!f.value.some(t=>t.selected===r.category_id)}return!1}),qe=s=>Object.entries(s).map(([e,t])=>`${e}:${t}`).join(", "),Ne=m.product.variants.map(s=>({id:s.id,options_text:qe(s.options),price:s.price??"",purchase_price:s.purchase_price??null,retail_price:s.retail_price??null,stock:s.stock,alert:s.alert??null})),r=bt({_method:"PUT",name:m.product.name,barcode:m.product.barcode??"",price:m.product.price,purchase_price:m.product.purchase_price??null,track_inventory:m.product.track_inventory??!0,quantity:m.product.quantity,alert:m.product.alert??null,category_id:m.product.category_id,short_description:m.product.short_description,long_description:m.product.long_description,specifications:m.product.specifications?JSON.parse(m.product.specifications).join(", "):"",meta_keywords:m.product.meta_keywords??"",new_gallery_files:[],images_to_delete:[],variants:Ne,variants_to_delete:[],variant_attributes:[],variant_options:[]}),i=h([]),G=h(""),V=h({}),He=s=>{V.value[s]=!V.value[s]},Le=()=>{if(!m.product.variant_options||!Array.isArray(m.product.variant_options))return;const s={};m.product.variant_attributes&&Array.isArray(m.product.variant_attributes)&&m.product.variant_attributes.forEach(e=>{e.name&&e.dependsOn&&(s[e.name]={dependsOn:e.dependsOn,rulesSelected:e.rulesSelected||{},rules:e.rules||{}})}),i.value=m.product.variant_options.map(e=>{const t=(e.children||[]).map(l=>{let c=l.image_path||null;c&&!c.startsWith("/storage/")&&!c.startsWith("http://")&&!c.startsWith("https://")&&(c="/storage/"+c.replace(/^\/+/,""));let v=Number(l.stock||0);if(m.product.variants&&m.product.variants.length>0){const g=m.product.variants.find(b=>(b.options||{})[e.name]===l.name);g&&(v=Number(g.stock))}return{id:l.id,name:l.name,barcode:l.barcode||"",price:l.price,image:null,imagePreview:c,imagePath:c,order:l.order||0,stock:v,alert:l.alert,purchase_price:l.purchase_price}}),o=s[e.name]||{},n=!!(o.dependsOn||Object.keys(o.rulesSelected||{}).length||Object.keys(o.rules||{}).length);return{id:e.id,name:e.name,children:t,order:e.order||0,dependsOn:o.dependsOn||"",rules:o.rules||{},rulesSelected:o.rulesSelected||{},__showDependency:n}}),i.value.forEach((e,t)=>{V.value[t]=!0})},M=$(()=>i.value.some(s=>s.children&&s.children.some(e=>(Number(e.stock)||0)>0||e.alert!==null&&e.alert!==""&&e.alert!==void 0||e.purchase_price!==null&&e.purchase_price!==""&&e.purchase_price!==void 0))),X=$(()=>i.value.some(s=>s.children&&s.children.some(e=>e.barcode&&e.barcode!=="")));ae(X,s=>{s&&(r.barcode="",r.clearErrors("barcode"))});const Fe=$(()=>{if(!M.value)return r.quantity;let s=0;return i.value.forEach(e=>{e.children&&e.children.forEach(t=>{s+=Number(t.stock)||0})}),s});ae(Fe,s=>{M.value&&(r.quantity=s)});const ne=h(!1),re=h(null),fe=h({pIndex:-1,cIndex:-1}),Ge=(s,e,t)=>{re.value={stock:s.stock||0,alert:s.alert,purchase_price:s.purchase_price,name:s.name},fe.value={pIndex:e,cIndex:t},ne.value=!0},Re=s=>{const{pIndex:e,cIndex:t}=fe.value;e!==-1&&t!==-1&&(i.value[e].children[t].stock=s.stock,i.value[e].children[t].alert=s.alert,i.value[e].children[t].purchase_price=s.purchase_price)},_e=()=>{const s=G.value.trim()||"",e=i.value.length;i.value.push({id:null,name:s,children:[],order:e,dependsOn:"",rules:{},rulesSelected:{},__showDependency:!1}),V.value[e]=!0,G.value=""},We=s=>{i.value.splice(s,1)},Qe=s=>{i.value[s].children||(i.value[s].children=[]),i.value[s].children.push({id:null,name:"",barcode:"",price:null,image:null,imagePreview:null,imagePath:null,order:i.value[s].children.length}),V.value[s]=!0},Ke=(s,e)=>{i.value[s].children.splice(e,1)},Je=(s,e,t)=>{const o=t?.target?.files?.[0];if(!o)return;if(!N(s)){t?.target&&(t.target.value=""),be.value||(I.value=!0,be.value=!0);return}const n=[];if((o?.type||"").startsWith("image/")||n.push(`${o.name}: no es una imagen vÃ¡lida.`),o.size>Me&&n.push(`${o.name}: supera el lÃ­mite de 2 MB.`),n.length){L.value=["Problemas con la imagen de la variante:",...n],T.value=!0,t?.target&&(t.target.value=""),i.value[s].children[e].image=null,i.value[s].children[e].imagePreview=null,i.value[s].children[e].imagePath=null;return}i.value[s].children[e].image=o,i.value[s].children[e].imagePath=null;const c=new FileReader;c.onload=v=>{i.value[s].children[e].imagePreview=v.target.result},c.readAsDataURL(o)},Xe=(s,e)=>{i.value[s].children[e].image=null,i.value[s].children[e].imagePreview=null,i.value[s].children[e].imagePath=null},Ye=()=>{const s=[];return i.value.forEach((e,t)=>{if(!e.name.trim())return;const o={id:e.id,name:e.name.trim(),parent_id:null,barcode:null,price:null,image_path:null,order:e.order??t,children:[]};e.children&&e.children.length>0&&e.children.forEach((n,l)=>{if(!n.name.trim())return;let c=null;if(!n.image&&n.imagePath){const v=String(n.imagePath||"").trim();v&&v!=="null"&&v!=="undefined"&&(c=v)}o.children.push({id:n.id,name:n.name.trim(),parent_id:null,barcode:n.barcode||null,stock:n.stock||0,alert:n.alert,purchase_price:n.purchase_price,price:n.price?parseFloat(n.price):null,image_file_key:n.image?`variant_option_${t}_${l}`:null,image_path:c,order:n.order??l})}),(o.children.length>0||o.name)&&s.push(o)}),s},Ze=()=>{const s=[];return i.value.forEach(e=>{if(!e.name.trim())return;const t=(e.children||[]).map(n=>n.name.trim()).filter(Boolean);if(t.length===0)return;const o={name:e.name.trim(),values:t,valuesText:t.join(", "),dependsOn:e.dependsOn||"",rules:e.rules||{},rulesSelected:e.rulesSelected||{}};s.push(o)}),s},Ie=$(()=>i.value.filter(e=>!e.children||e.children.length===0?!1:e.children.some(t=>t.price&&t.price!==""&&t.price!=null)).length>1),q=h(!1),Y=h(!1),et=["Has intentado agregar precios a una variante cuando ya existe otra variante principal con precios configurados.","","ðŸ“‹ Regla del Sistema:","Solo puedes asignar precios a las opciones hijas de UNA variante principal. Si ya asignaste precios a una variante (por ejemplo, Color), no podrÃ¡s agregar precios a otra variante (por ejemplo, Equipo).","","ðŸ’¡ CÃ³mo funciona:","Cuando un cliente seleccione una opciÃ³n de la variante que tiene precios, se mostrarÃ¡ el precio de esa opciÃ³n especÃ­fica. Si no selecciona ninguna opciÃ³n o selecciona una opciÃ³n sin precio, se usarÃ¡ el precio principal del producto.","","ðŸ’¡ Sugerencia:","Si necesitas diferentes precios segÃºn mÃºltiples caracterÃ­sticas, considera crear productos separados o usar una sola variante que combine ambas caracterÃ­sticas."],Z=s=>!i.value.find((t,o)=>o===s||!t.children||t.children.length===0?!1:t.children.some(n=>n.price&&n.price!==""&&n.price!=null)),N=s=>!i.value.find((t,o)=>o===s||!t.children||t.children.length===0?!1:t.children.some(n=>n.imagePreview||n.image||n.imagePath&&n.imagePath!=="")),R=s=>!i.value.find((t,o)=>o===s||!t.children||t.children.length===0?!1:t.children.some(n=>n.barcode&&n.barcode!=="")),le=s=>!i.value.find((t,o)=>o===s||!t.children||t.children.length===0?!1:t.children.some(n=>(Number(n.stock)||0)>0||n.alert!==null&&n.alert!==""&&n.alert!==void 0||n.purchase_price!==null&&n.purchase_price!==""&&n.purchase_price!==void 0)),tt=(s,e,t)=>{const o=t?.target?.value;!o||o===""||o==null||Z(s)||(t.target.value="",i.value[s].children[e].price=null,Y.value||(q.value=!0,Y.value=!0))},I=h(!1),be=h(!1),st=["Has intentado agregar imÃ¡genes a una variante cuando ya existe otra variante principal con imÃ¡genes configuradas.","","ðŸ“‹ Regla del Sistema:","Solo puedes asignar imÃ¡genes a las opciones hijas de UNA variante principal. Si ya asignaste imÃ¡genes a una variante (por ejemplo, Color), no podrÃ¡s agregar imÃ¡genes a otra variante (por ejemplo, Equipo).","","ðŸ’¡ CÃ³mo funciona:","Cuando un cliente seleccione una opciÃ³n de la variante que tiene imÃ¡genes, se mostrarÃ¡ la imagen de esa opciÃ³n especÃ­fica en la galerÃ­a. Si no selecciona ninguna opciÃ³n o selecciona una opciÃ³n sin imagen, se mostrarÃ¡n las imÃ¡genes regulares del producto.","","ðŸ’¡ Sugerencia:","Si necesitas diferentes imÃ¡genes segÃºn mÃºltiples caracterÃ­sticas, considera crear productos separados o usar una sola variante que combine ambas caracterÃ­sticas."];ae(()=>i.value,()=>{Y.value||setTimeout(()=>{Ie.value&&!q.value&&(q.value=!0,Y.value=!0)},1e3)},{deep:!0});const ee=h([{name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}}]),ie=s=>String(s||"").split(",").map(e=>e.trim()).filter(Boolean);function at(s,e,t){return(s.rulesSelected&&Array.isArray(s.rulesSelected[e])?s.rulesSelected[e]:[]).includes(t)}function ot(s,e,t,o){const n=!!o?.target?.checked;s.rulesSelected||(s.rulesSelected={});const l=Array.isArray(s.rulesSelected[e])?[...s.rulesSelected[e]]:[],c=l.indexOf(t);n&&c===-1&&l.push(t),!n&&c!==-1&&l.splice(c,1),s.rulesSelected[e]=l}function nt(s){s.__showDependency=!s.__showDependency,s.__showDependency||(s.dependsOn="",s.rulesSelected={},s.rules={})}const rt=()=>{try{const s=Array.isArray(m.product.variants)?m.product.variants:[];if(s.length===0)return;const e=new Set;s.forEach(o=>{Object.keys(o?.options||{}).forEach(n=>e.add(n))});const t=[];e.forEach(o=>{const n=new Set;s.forEach(c=>{const v=(c?.options||{})[o];v!=null&&String(v).trim()!==""&&n.add(String(v))});const l=Array.from(n).join(", ");t.push({name:o,valuesText:l,dependsOn:"",rules:{},rulesSelected:{}})}),t.length>0&&(ee.value=t)}catch{}},lt=()=>{try{const s=m.product?.variant_attributes,e=Array.isArray(s)?s:[];if(e.length===0)return!1;const t=e.map(o=>{const n=Array.isArray(o?.values)?o.values:ie(o?.valuesText||""),l=String(o?.dependsOn||"").trim(),c=typeof o?.rulesSelected=="object"&&o.rulesSelected?o.rulesSelected:{},v=typeof o?.rules=="object"&&o.rules?o.rules:{},g=!!(l||Object.keys(c).length||Object.keys(v).length);return{name:String(o?.name||""),valuesText:n.join(", "),dependsOn:l,rulesSelected:c,rules:v,__showDependency:g}}).filter(o=>o.name);if(t.length>0)return ee.value=t,!0}catch{}return!1},it=()=>{try{const s=m.product?.variant_attributes||[];if(!Array.isArray(s)||s.length===0)return;const e=Object.fromEntries(ee.value.map(t=>[t.name,t]));for(const t of s){const o=e[t.name];o&&(t.dependsOn&&(o.dependsOn=t.dependsOn,o.__showDependency=!0),t.rulesSelected&&typeof t.rulesSelected=="object"?(o.rulesSelected=t.rulesSelected,Object.keys(o.rulesSelected||{}).length>0&&(o.__showDependency=!0)):t.rules&&typeof t.rules=="object"&&(o.rules=t.rules,Object.keys(o.rules||{}).length>0&&(o.__showDependency=!0)))}}catch{}},S=h([...m.product.images]),ye=s=>{r.images_to_delete.push(s.id),S.value=S.value.filter(e=>e.id!==s.id)},ce=h(!1),j=h(0),we=h(!1);function de(){we.value=window.innerWidth<768}yt(async()=>{de(),window.addEventListener("resize",de),Ue(),Le(),lt()||(rt(),it())}),wt(()=>{window.removeEventListener("resize",de),te()});const xe=async s=>{Be();const e=s.replace(/\s+/g,"").trim();if(K.value){const{pIndex:t,cIndex:o}=K.value;i.value[t]&&i.value[t].children[o]&&(i.value[t].children[o].barcode=e),K.value=null}else r.barcode=e,await pe();he.value=e,te(),Q.value=!0},ct=(s,e)=>{K.value={pIndex:s,cIndex:e},ke()},ke=async()=>{try{F.value=!0,await pe();const{Html5Qrcode:s}=await St(async()=>{const{Html5Qrcode:o}=await import("./index-B2rw9mKU.js");return{Html5Qrcode:o}},__vite__mapDeps([0,1,2])),e=document.getElementById("barcode-scanner-edit");if(!e)return;U.value=new s(e.id);const t={fps:10,qrbox:{width:250,height:250}};try{await U.value.start({facingMode:"environment"},t,async o=>{await xe(o)},o=>{})}catch{try{await U.value.start({facingMode:"user"},t,async n=>{await xe(n)},n=>{})}catch{alert("No se pudo acceder a la cÃ¡mara. Por favor, permite el acceso a la cÃ¡mara en la configuraciÃ³n del navegador."),F.value=!1}}}catch{alert("Error al inicializar el escÃ¡ner. Por favor, intenta nuevamente."),F.value=!1}},te=async()=>{if(U.value){try{await U.value.stop(),await U.value.clear()}catch{}U.value=null}F.value=!1},ue=$(()=>we.value?1:4),dt=$(()=>S.value.slice(0,ue.value)),Ce=$(()=>S.value.slice(ue.value));function Se(s=0){j.value=s,ce.value=!0}function Pe(){ce.value=!1}function ut(){const s=S.value.length;s!==0&&(j.value=(j.value-1+s)%s)}function mt(){const s=S.value.length;s!==0&&(j.value=(j.value+1)%s)}function pt(s){s<0||s>=S.value.length||(j.value=s)}const vt=$(()=>{if(r.variants.length>0){let s=0;return r.variants.forEach(e=>{s+=Number(e.stock)||0}),s}return Number(r.quantity)||0});ae(vt,s=>{r.variants.length>0&&(r.quantity=s)});const gt=()=>{if(J.value){L.value=["DebÃ©s seleccionar una subcategorÃ­a. La categorÃ­a principal tiene subcategorÃ­as disponibles y es obligatorio elegir una de ellas."],T.value=!0,pe(()=>{const e=document.querySelector(".space-y-3 select");e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.focus())});return}r.variant_options=Ye();const s=Ze();if(s.length>0)r.variant_attributes=s.map(e=>({name:e.name,values:e.values,dependsOn:e.dependsOn||"",rulesSelected:e.rulesSelected||{},rules:e.rules||{}}));else try{const e=ee.value.map(t=>({name:String(t.name||"").trim(),values:ie(t.valuesText),dependsOn:String(t.dependsOn||"").trim(),rules:t.rules||{},rulesSelected:t.rulesSelected||{}})).filter(t=>t.name&&t.values.length>0);if(r.variant_attributes=e,e.length>0){let l=function(g){n.has(g.name)||(g.dependsOn&&t[g.dependsOn]&&l(t[g.dependsOn]),n.add(g.name),o.push(g))},v=function(g,b){if(g===o.length){c.push({...b});return}const x=o[g];let se=x.values;if(x.dependsOn){const z=b[x.dependsOn];if(z!=null){const me=x.rulesSelected?.[z]??x.rules?.[z]??[],je=Array.isArray(me)?me:ie(me);je.length>0&&(se=x.values.filter(ft=>je.includes(ft)))}}for(const z of se)b[x.name]=z,v(g+1,b);delete b[x.name]};const t=Object.fromEntries(e.map(g=>[g.name,g])),o=[],n=new Set;e.forEach(l);const c=[];v(0,{}),r.variants=c.map(g=>({id:null,options_text:o.map(b=>`${b.name}:${g[b.name]}`).join(", "),price:"",purchase_price:null,stock:0,alert:null}))}else r.variants=[]}catch{r.variant_attributes=[]}D.value=!0},Ve=()=>{D.value=!1},ht=()=>{const s=m.product.barcode??"",e=r.barcode!==void 0&&r.barcode!==null?String(r.barcode).trim():"";r.barcode=e,e!==s&&r.clearErrors("barcode"),r.transform(v=>(v.barcode=e,i.value.forEach((g,b)=>{g.children&&g.children.length>0&&g.children.forEach((x,se)=>{if(x.image instanceof File){const z=`variant_option_${b}_${se}`;v[z]=x.image}})}),v));const o=i.value.flatMap((v,g)=>(v.children||[]).map((b,x)=>b.image instanceof File?`variant_option_${g}_${x}`:null).filter(Boolean)),n=r.new_gallery_files&&r.new_gallery_files.length>0,l=o.length>0||n,c={preserveScroll:!0,onSuccess:()=>{W.value=!0,Oe.value="Producto actualizado exitosamente",D.value=!1},onError:async()=>{const v=[];for(const[g,b]of Object.entries(r.errors))g.startsWith("new_gallery_files.")&&String(b).toLowerCase().includes("image")?v.push("Una o mÃ¡s imÃ¡genes nuevas superan el tamaÃ±o mÃ¡ximo permitido (2 MB) o no son vÃ¡lidas."):v.push(String(b));L.value=v,T.value=v.length>0,D.value=!1},onFinish:()=>{D.value=!1}};l?r.post(route("admin.products.update",m.product.id),c):r.put(route("admin.products.update",m.product.id),c)};return(s,e)=>(u(),d(A,null,[k(p(xt),{title:"Editar Producto"}),k(Pt,null,{header:O(()=>[a("h2",Et,"Editar Producto: "+E(p(r).name),1)]),default:O(()=>[a("div",Mt,[a("div",$t,[a("div",Ot,[a("div",Bt,[a("form",{onSubmit:C(gt,["prevent"])},[a("div",Tt,[a("div",null,[a("div",Ut,[zt,_(a("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=t=>p(r).name=t),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,p(r).name]])]),a("div",Dt,[qt,a("div",Nt,[_(a("input",{id:"barcode","onUpdate:modelValue":e[1]||(e[1]=t=>p(r).barcode=t),type:"text",class:P(["flex-1 block mt-1 rounded-md shadow-sm border-gray-300",{"bg-gray-100 cursor-not-allowed":X.value}]),placeholder:"Ej: 1234567890123",disabled:X.value,title:X.value?"Deshabilitado porque hay variantes con cÃ³digo de barras propio":""},null,10,Ht),[[w,p(r).barcode]]),a("button",{type:"button",onClick:ke,class:"px-4 py-2 mt-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2 whitespace-nowrap",title:"Escanear cÃ³digo de barras"},[Lt,H(" Escanear ")])])]),a("div",Ft,[Gt,_(a("input",{id:"price","onUpdate:modelValue":e[2]||(e[2]=t=>p(r).price=t),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,p(r).price]])]),a("label",Rt,[_(a("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=t=>p(r).track_inventory=t),class:"rounded"},null,512),[[kt,p(r).track_inventory]]),Wt]),p(r).track_inventory?(u(),d("div",Qt,[a("div",null,[Kt,_(a("input",{id:"quantity","onUpdate:modelValue":e[4]||(e[4]=t=>p(r).quantity=t),type:"number",class:P(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":!p(r).track_inventory||M.value}]),disabled:!p(r).track_inventory||M.value,required:p(r).track_inventory&&!M.value,title:"Stock si no hay variantes. Con variantes, se suma automÃ¡ticamente."},null,10,Jt),[[w,p(r).quantity]])]),a("div",null,[Xt,_(a("input",{id:"alert_general","onUpdate:modelValue":e[5]||(e[5]=t=>p(r).alert=t),type:"number",class:P(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":!p(r).track_inventory||M.value}]),disabled:!p(r).track_inventory||M.value,title:"Se considera bajo stock cuando cantidad â‰¤ alerta."},null,10,Yt),[[w,p(r).alert]])]),a("div",null,[Zt,_(a("input",{id:"purchase_price","onUpdate:modelValue":e[6]||(e[6]=t=>p(r).purchase_price=t),type:"number",step:"0.01",class:P(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":!p(r).track_inventory||M.value}]),disabled:!p(r).track_inventory||M.value},null,10,It),[[w,p(r).purchase_price]])])])):y("",!0),a("div",es,[ts,J.value?(u(),d("p",ss," âš ï¸ Es obligatorio seleccionar una subcategorÃ­a ")):y("",!0)]),a("div",as,[(u(!0),d(A,null,B(f.value,(t,o)=>(u(),d("div",{key:o,class:"mb-1"},[_(a("select",{class:P(["block w-full rounded-md shadow-sm border-gray-300",{"border-red-500":J.value&&o===f.value.length-1&&!t.selected}]),"onUpdate:modelValue":n=>t.selected=n,onChange:n=>De(o),required:o===f.value.length-1&&t.options.length>0},[ns,(u(!0),d(A,null,B(t.options,n=>(u(),d("option",{key:n.id,value:n.id},E(n.name),9,rs))),128))],42,os),[[Ae,t.selected]])]))),128))]),J.value?(u(),d("p",ls," DebÃ©s seleccionar una subcategorÃ­a. La categorÃ­a principal tiene subcategorÃ­as disponibles. ")):y("",!0)]),a("div",null,[a("div",is,[cs,_(a("textarea",{id:"short_description","onUpdate:modelValue":e[7]||(e[7]=t=>p(r).short_description=t),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3"},null,512),[[w,p(r).short_description]])]),a("div",ds,[us,_(a("textarea",{id:"long_description","onUpdate:modelValue":e[8]||(e[8]=t=>p(r).long_description=t),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"5"},null,512),[[w,p(r).long_description]])]),a("div",ms,[ps,_(a("input",{id:"specifications","onUpdate:modelValue":e[9]||(e[9]=t=>p(r).specifications=t),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[w,p(r).specifications]])]),a("div",vs,[gs,_(a("input",{id:"meta_keywords","onUpdate:modelValue":e[10]||(e[10]=t=>p(r).meta_keywords=t),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",placeholder:"palabra1, palabra2, palabra3"},null,512),[[w,p(r).meta_keywords]]),hs])])]),a("div",fs,[a("div",_s,[a("div",bs,[a("div",ys,[ws,a("div",xs,[a("button",{type:"button",class:"w-7 h-7 inline-flex items-center justify-center rounded border border-gray-300 hover:bg-gray-100 text-gray-700",title:"Expandir todo",onClick:e[11]||(e[11]=()=>{i.value.forEach((t,o)=>V.value[o]=!0)})}," + "),a("button",{type:"button",class:"w-7 h-7 inline-flex items-center justify-center rounded border border-gray-300 hover:bg-gray-100 text-gray-700",title:"Colapsar todo",onClick:e[12]||(e[12]=()=>{i.value.forEach((t,o)=>V.value[o]=!1)})}," âˆ’ ")])]),a("div",ks,[i.value.length===0?(u(),d("p",Cs," AÃºn no hay variantes principales. AgregÃ¡ una usando el botÃ³n de abajo. ")):y("",!0),(u(!0),d(A,null,B(i.value,(t,o)=>(u(),d("div",{key:`parent-${o}`,class:"p-3 hover:bg-gray-50"},[a("div",Ss,[a("div",Ps,[a("div",Vs,[a("button",{type:"button",class:"w-6 h-6 flex-shrink-0 inline-flex items-center justify-center rounded-full border border-gray-300 text-gray-700 hover:bg-gray-100",title:V.value[o]??!1?"Colapsar opciones":"Expandir opciones",onClick:n=>He(o)},[V.value[o]??!1?(u(),d("span",Es,"v")):(u(),d("span",As,">"))],8,js),_(a("input",{"onUpdate:modelValue":n=>t.name=n,type:"text",placeholder:"Ej: Color, Talla, Material",class:"flex-1 min-w-0 font-medium border-0 bg-transparent focus:bg-white focus:border focus:border-gray-300 rounded px-2 py-1 focus:outline-none"},null,8,Ms),[[w,t.name]]),t.children&&t.children.length>0?(u(),d("span",$s," ("+E(t.children.length)+") ",1)):y("",!0)])]),a("div",Os,[a("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:t.__showDependency?"Ocultar dependencia":"Configurar dependencia",onClick:n=>nt(t)},Us,8,Bs),a("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded border border-green-500 text-green-600 hover:bg-green-50",title:"AÃ±adir opciÃ³n",onClick:n=>Qe(o)},qs,8,zs),a("button",{type:"button",onClick:n=>We(o),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},Ls,8,Ns)])]),t.__showDependency?(u(),d("div",Fs,[a("div",Gs,[a("div",Rs,[Ws,_(a("select",{"onUpdate:modelValue":n=>t.dependsOn=n,class:"block w-full text-sm border-gray-300 rounded-md shadow-sm"},[Ks,(u(!0),d(A,null,B(i.value,(n,l)=>(u(),d("option",{key:`dep-${o}-${l}`,value:n.name,disabled:n===t||!n.name},E(n.name||"(sin nombre)"),9,Js))),128))],8,Qs),[[Ae,t.dependsOn]])]),t.dependsOn?(u(),d("div",Xs,[Ys,a("div",Zs,[(u(!0),d(A,null,B((i.value.find(n=>n.name===t.dependsOn)?.children||[]).map(n=>n.name),n=>(u(),d("div",{key:`pv-${o}-${n}`,class:"border rounded p-2 bg-white"},[a("div",Is,[H(E(t.dependsOn)+" = ",1),a("strong",null,E(n),1)]),a("div",ea,[(u(!0),d(A,null,B((t.children||[]).map(l=>l.name),l=>(u(),d("label",{key:`cv-${o}-${n}-${l}`,class:"inline-flex items-center gap-1 text-xs"},[a("input",{type:"checkbox",checked:at(t,n,l),onChange:c=>ot(t,n,l,c),class:"rounded"},null,40,ta),a("span",null,E(l),1)]))),128))])]))),128))])])):y("",!0)])])):y("",!0),V.value[o]??!1?(u(),d("div",sa,[(u(!0),d(A,null,B(t.children,(n,l)=>(u(),d("div",{key:`child-${o}-${l}`,class:"py-2 flex justify-between items-start"},[a("div",aa,[a("div",null,[oa,_(a("input",{"onUpdate:modelValue":c=>n.name=c,type:"text",placeholder:"Ej: Rojo, Verde",class:"block w-full text-sm border-gray-300 rounded-md shadow-sm"},null,8,na),[[w,n.name]])]),a("div",null,[ra,_(a("input",{"onUpdate:modelValue":c=>n.price=c,type:"number",step:"0.01",placeholder:"Usa precio principal",class:P(["block w-full text-sm border-gray-300 rounded-md shadow-sm",{"bg-gray-100 cursor-not-allowed":!Z(o)}]),disabled:!Z(o),onInput:c=>tt(o,l,c)},null,42,la),[[w,n.price]]),Z(o)?y("",!0):(u(),d("p",ia," Solo puedes agregar precios a una variante principal "))]),a("div",ca,[a("input",{type:"file",accept:"image/*",onChange:c=>Je(o,l,c),class:"hidden",id:`variant-image-input-${o}-${l}`,disabled:!N(o)},null,40,da),n.imagePreview?(u(),d("div",ua,[a("img",{src:n.imagePreview,alt:"Preview",class:"w-10 h-10 object-cover rounded border"},null,8,ma),a("button",{type:"button",onClick:C(c=>Xe(o,l),["stop"]),class:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs hover:bg-red-600"}," Ã— ",8,pa)])):(u(),d("label",{key:1,for:`variant-image-input-${o}-${l}`,class:P(["inline-flex items-center justify-center w-10 h-10 border-2 border-dashed border-gray-300 rounded hover:border-blue-400 hover:bg-blue-50 transition",{"cursor-pointer":N(o),"cursor-not-allowed opacity-50":!N(o)}]),title:N(o)?"Agregar foto":"Solo puedes agregar imÃ¡genes a una variante principal"},ha,10,va)),N(o)?y("",!0):(u(),d("p",fa," Solo puedes agregar imÃ¡genes a una variante principal "))]),a("div",null,[_a,a("div",ba,[_(a("input",{"onUpdate:modelValue":c=>n.barcode=c,type:"text",placeholder:"Ej: 770...",class:P(["block w-full text-sm border-gray-300 rounded-md shadow-sm",{"bg-gray-100 cursor-not-allowed":!R(o)}]),disabled:!R(o)},null,10,ya),[[w,n.barcode]]),a("button",{type:"button",onClick:c=>ct(o,l),class:P(["p-2 bg-blue-100 text-blue-600 rounded hover:bg-blue-200",{"opacity-50 cursor-not-allowed":!R(o)}]),title:"Escanear",disabled:!R(o)},ka,10,wa),a("button",{type:"button",onClick:c=>Ge(n,o,l),class:P(["p-2 bg-purple-100 text-purple-600 rounded hover:bg-purple-200",{"opacity-50 cursor-not-allowed":!p(r).track_inventory||!le(o)}]),title:"Inventario",disabled:!p(r).track_inventory||!le(o)},Pa,10,Ca)]),R(o)?y("",!0):(u(),d("p",Va," Solo una variante principal puede tener cÃ³digos ")),p(r).track_inventory&&!le(o)?(u(),d("p",ja," Solo una variante principal puede tener inventario ")):y("",!0)])]),a("div",Aa,[a("button",{type:"button",onClick:c=>Ke(o,l),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},$a,8,Ea)])]))),128))])):y("",!0)]))),128))]),i.value.length<1?(u(),d("form",{key:0,onSubmit:C(_e,["prevent"]),class:"mt-6 border-t pt-4"},[Oa,a("div",Ba,[_(a("input",{type:"text","onUpdate:modelValue":e[13]||(e[13]=t=>G.value=t),class:"block w-full rounded-md shadow-sm border-gray-300",placeholder:"Nombre de la nueva variante principal",onKeyup:Ct(_e,["enter"])},null,544),[[w,G.value]]),Ta,a("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded bg-gray-200 text-gray-800 hover:bg-gray-300",onClick:e[14]||(e[14]=t=>G.value=""),title:"Cancelar"}," âœ– ")])],32)):y("",!0)])])]),a("div",Ua,[za,Da,a("div",qa,[a("div",Na,[Ha,a("span",La,E(S.value.length)+" imagen(es)",1)]),S.value.length>0?(u(),d("div",Fa,[(u(!0),d(A,null,B(dt.value,(t,o)=>(u(),d("div",{key:t.id,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer",onClick:n=>Se(o)},[a("img",{src:t.path,class:"w-full h-full aspect-[4/3] object-cover",alt:"Imagen del producto"},null,8,Ra),a("button",{onClick:C(n=>ye(t),["stop","prevent"]),type:"button",class:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center shadow-md hover:bg-red-700"}," Ã— ",8,Wa)],8,Ga))),128)),Ce.value.length>0?(u(),d("div",{key:0,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer flex items-center justify-center text-gray-800 font-bold text-base h-full min-h-[90px]",onClick:e[15]||(e[15]=t=>Se(ue.value))}," +"+E(Ce.value.length),1)):y("",!0)])):(u(),d("p",Qa,"Este producto no tiene imÃ¡genes."))]),a("div",Ka,[Ja,a("input",{id:"new_gallery_files",onInput:e[16]||(e[16]=t=>Te(t)),type:"file",multiple:"",class:"block mt-1 w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),Xa])]),ce.value?(u(),d("div",{key:0,class:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",style:{"pointer-events":"auto"},onClick:C(Pe,["self"])},[a("div",{class:"bg-white rounded-lg p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden relative",onClick:e[22]||(e[22]=C(()=>{},["stop"]))},[a("button",{type:"button",class:"absolute top-3 right-3 bg-gray-900 text-white rounded-full w-8 h-8 flex items-center justify-center z-30",onClick:C(Pe,["stop","prevent"]),onMousedown:e[17]||(e[17]=C(()=>{},["stop","prevent"]))},"Ã—",32),a("div",Ya,[a("button",{class:"absolute left-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:C(ut,["stop","prevent"]),onMousedown:e[18]||(e[18]=C(()=>{},["stop","prevent"]))},"â€¹",32),a("img",{src:S.value[j.value]?.path,class:"max-w-full max-h-full object-contain",alt:"Imagen"},null,8,Za),a("button",{class:"absolute right-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:C(mt,["stop","prevent"]),onMousedown:e[19]||(e[19]=C(()=>{},["stop","prevent"]))},"â€º",32),S.value[j.value]?(u(),d("button",{key:0,class:"absolute top-2 right-12 bg-red-600 text-white rounded px-2 py-1 text-xs z-20",type:"button",onClick:e[20]||(e[20]=C(t=>ye(S.value[j.value]),["stop","prevent"])),onMousedown:e[21]||(e[21]=C(()=>{},["stop","prevent"]))},"Eliminar",32)):y("",!0)]),a("div",Ia,[(u(!0),d(A,null,B(S.value,(t,o)=>(u(),d("div",{key:t.id,class:P(["border rounded p-1 cursor-pointer flex-shrink-0",{"ring-2 ring-blue-500":o===j.value}]),onClick:n=>pt(o)},[a("img",{src:t.path,class:"w-20 h-20 object-cover rounded",alt:"thumb"},null,8,to)],10,eo))),128))])])])):y("",!0),a("div",so,[a("button",{type:"submit",disabled:p(r).processing,class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},ro,8,ao)])],32)])])])])]),_:1}),k(ve,{show:D.value,onClose:Ve},{default:O(()=>[a("div",lo,[io,co,a("div",uo,[k(Ee,{onClick:Ve},{default:O(()=>[H("Cancelar")]),_:1}),k(jt,{class:"ms-3",onClick:ht,disabled:p(r).processing},{default:O(()=>[H(" Guardar cambios ")]),_:1},8,["disabled"])])])]),_:1},8,["show"]),k(oe,{show:W.value,type:"success",title:"Producto actualizado","primary-text":"Entendido",onPrimary:e[23]||(e[23]=t=>W.value=!1),onClose:e[24]||(e[24]=t=>W.value=!1)},null,8,["show"]),k(oe,{show:T.value,type:"error",title:"No pudimos actualizar el producto",message:"RevisÃ¡ los siguientes puntos:",messages:L.value,"primary-text":"Entendido",onPrimary:e[25]||(e[25]=t=>T.value=!1),onClose:e[26]||(e[26]=t=>T.value=!1)},null,8,["show","messages"]),k(oe,{show:q.value,type:"warning",title:"Solo una Variante Puede Tener Precios",messages:et,"primary-text":"Entendido",onPrimary:e[27]||(e[27]=t=>q.value=!1),onClose:e[28]||(e[28]=t=>q.value=!1)},null,8,["show"]),k(oe,{show:I.value,type:"warning",title:"Solo una Variante Puede Tener ImÃ¡genes",messages:st,"primary-text":"Entendido",onPrimary:e[29]||(e[29]=t=>I.value=!1),onClose:e[30]||(e[30]=t=>I.value=!1)},null,8,["show"]),k(ve,{show:F.value,onClose:te},{default:O(()=>[a("div",mo,[po,vo,a("div",go,[k(Ee,{onClick:te},{default:O(()=>[H("Cerrar")]),_:1})])])]),_:1},8,["show"]),k(ve,{show:Q.value,onClose:e[32]||(e[32]=t=>Q.value=!1)},{default:O(()=>[a("div",ho,[fo,a("div",_o,[bo,a("p",yo,E(he.value),1)]),a("div",wo,[k(Vt,{onClick:e[31]||(e[31]=t=>Q.value=!1)},{default:O(()=>[H("Aceptar")]),_:1})])])]),_:1},8,["show"]),k(At,{show:ne.value,"variant-name":re.value?.name,"initial-data":re.value,onClose:e[33]||(e[33]=t=>ne.value=!1),onSave:Re},null,8,["show","variant-name","initial-data"])],64))}};export{Eo as default};
