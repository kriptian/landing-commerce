import{B as Q,r as l,q as fe,s as _e,x as xe,c as Z,a as i,o as n,b as r,d as c,h as we,e as a,f as e,i as g,n as E,j as C,y as L,m as S,p as f,g as ee,F as j,k as te,t as z,z as k,G as se,A as oe}from"./app-SsEMnYrU.js";import{_ as ye}from"./AuthenticatedLayout-C52cI_5r.js";import{u as be}from"./index-BlWUs0gQ.js";import{_ as le}from"./Modal-CSpKFLf1.js";import{_ as re}from"./SecondaryButton-B5UMDAvl.js";import{D as ae}from"./DangerButton-VbnccI26.js";import{_ as Ee}from"./AlertModal-Csg112t6.js";import{u as Ce,S as Le}from"./useSectionTour-BxTMRDxs.js";const Se={class:"flex justify-between items-center"},ze=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestionar Usuarios y Roles",-1),ke=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),Re=e("span",null,"Crear",-1),Me=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),Te=e("span",null,"Crear",-1),Ae={class:"py-12"},Ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Be={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Fe={class:"p-6 text-gray-900"},Ne={class:"mb-4 border-b border-gray-200"},Ve={class:"-mb-px flex space-x-8","aria-label":"Tabs"},He={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},je={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},De={class:"min-w-[720px] w-full divide-y divide-gray-200 table-auto"},$e={class:"sticky top-0 z-10 bg-gray-50"},Ie=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),We=[Ie],Xe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Email",-1),qe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Rol",-1),Ge=e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")],-1),Oe={class:"bg-white divide-y divide-gray-200"},Ke=["title"],Pe={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Ye={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Je={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},Qe={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-right text-sm font-medium"},Ze={class:"flex justify-end items-center gap-2"},et=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),tt=["onClick"],st=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),ot=[st],lt={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},rt={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},at={class:"min-w-[520px] w-full divide-y divide-gray-200 table-auto"},nt={class:"sticky top-0 z-10 bg-gray-50"},it=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),ct=[it],dt=e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")],-1),ut={class:"bg-white divide-y divide-gray-200"},ht=["title"],mt={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-right text-sm font-medium"},vt={class:"flex justify-end items-center gap-2"},pt=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),gt=["onClick"],ft=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),_t=[ft],xt={class:"p-6"},wt=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que quieres eliminar este usuario? ",-1),yt=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. ",-1),bt={class:"mt-6 flex justify-end"},Et={class:"p-6"},Ct=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que quieres eliminar este rol? ",-1),Lt=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. No podrás eliminar un rol si hay usuarios que lo tengan asignado. ",-1),St={class:"mt-6 flex justify-end"},ne="users_firstcol_w_px",ie="roles_firstcol_w_px",zt=60,kt=320,Vt={__name:"Index",props:{users:Array,roles:Array},setup(D){const ce=Q().props.auth.user,R=Q(),d=l(R?.props?.ziggy?.query?.tab==="roles"?"roles":"users"),_=l(!!R.props.flash?.success),M=l(R.props.flash?.success||""),{showTour:de,steps:ue,handleTourComplete:he}=Ce("users"),T=l(!1),A=l(null),me=t=>{A.value=t,T.value=!0},x=()=>{T.value=!1,A.value=null},ve=()=>{oe.delete(route("admin.users.destroy",A.value),{preserveScroll:!0,onSuccess:()=>{x(),M.value="¡Usuario eliminado con éxito!",_.value=!0},onError:()=>{x(),M.value="Hubo un error al eliminar el usuario.",_.value=!0}})},U=l(!1),B=l(null),$=be(),pe=t=>{B.value=t,U.value=!0},w=()=>{U.value=!1,B.value=null},ge=()=>{oe.delete(route("admin.roles.destroy",B.value),{preserveScroll:!0,onSuccess:()=>{w(),$.success("¡Rol eliminado con éxito!")},onError:()=>{w(),$.error("No se puede eliminar un rol que está en uso.")}})},y=l(null),b=l(null),I=l(!1),W=l(!1),X=l(!1),q=l(!1),G=(t,o,s)=>{const u=t.value;if(!u)return;const H=u.scrollWidth-u.clientWidth,J=u.scrollLeft||0;o.value=J>0,s.value=J<H-1};fe(()=>{const t=()=>G(y,I,W),o=()=>G(b,X,q);_e(()=>{t(),o()}),y.value?.addEventListener("scroll",t,{passive:!0}),b.value?.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",t),window.addEventListener("resize",o)}),xe(()=>{y.value?.removeEventListener("scroll",()=>{}),b.value?.removeEventListener("scroll",()=>{}),window.removeEventListener("resize",()=>{})});const h=l(Number(localStorage.getItem(ne))||180),m=l(Number(localStorage.getItem(ie))||200),O=Z(()=>({width:h.value+"px",minWidth:h.value+"px",maxWidth:h.value+"px"})),K=Z(()=>({width:m.value+"px",minWidth:m.value+"px",maxWidth:m.value+"px"}));let F=0,N=0,V="users";const v=t=>{const o=t.touches?t.touches[0].clientX:t.clientX,s=Math.max(zt,Math.min(kt,N+(o-F)));V==="users"?h.value=s:m.value=s},p=()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p),document.removeEventListener("touchmove",v),document.removeEventListener("touchend",p);try{localStorage.setItem(ne,String(h.value)),localStorage.setItem(ie,String(m.value))}catch{}},P=t=>{V="users",F=t.touches?t.touches[0].clientX:t.clientX,N=h.value,document.addEventListener("mousemove",v,{passive:!1}),document.addEventListener("mouseup",p),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",p)},Y=t=>{V="roles",F=t.touches?t.touches[0].clientX:t.clientX,N=m.value,document.addEventListener("mousemove",v,{passive:!1}),document.addEventListener("mouseup",p),document.addEventListener("touchmove",v,{passive:!1}),document.addEventListener("touchend",p)};return(t,o)=>(n(),i(j,null,[r(c(we),{title:"Gestionar Usuarios y Roles"}),r(ye,null,{header:a(()=>[e("div",Se,[ze,e("div",null,[d.value==="roles"?(n(),se(c(k),{key:0,href:t.route("admin.roles.create"),class:"inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow ml-4"},{default:a(()=>[ke,Re]),_:1},8,["href"])):g("",!0),d.value==="users"?(n(),se(c(k),{key:1,href:t.route("admin.users.create"),class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},{default:a(()=>[Me,Te]),_:1},8,["href"])):g("",!0)])])]),default:a(()=>[e("div",Ae,[e("div",Ue,[e("div",Be,[e("div",Fe,[e("div",Ne,[e("nav",Ve,[e("button",{onClick:o[0]||(o[0]=s=>d.value="users"),class:E([d.value==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Usuarios ",2),e("button",{onClick:o[1]||(o[1]=s=>d.value="roles"),class:E([d.value==="roles"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Roles ",2)])]),d.value==="users"?(n(),i("div",{key:0,ref_key:"usersScrollRef",ref:y,class:"relative overflow-x-auto"},[C(e("div",He,null,512),[[L,I.value]]),C(e("div",je,null,512),[[L,W.value]]),e("table",De,[e("thead",$e,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:S(O.value)},[f(" Nombre "),e("div",{onMousedown:P,onTouchstart:ee(P,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},We,32)],4),Xe,qe,Ge])]),e("tbody",Oe,[(n(!0),i(j,null,te(D.users,(s,u)=>(n(),i("tr",{key:s.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:E(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r truncate",u%2===1?"bg-gray-100":"bg-white"]),style:S(O.value),title:s.name},z(s.name),15,Ke),e("td",Pe,z(s.email),1),e("td",Ye,[s.roles.length>0?(n(),i("span",Je,z(s.roles[0].name),1)):g("",!0)]),e("td",Qe,[e("div",Ze,[r(c(k),{href:t.route("admin.users.edit",s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:a(()=>[et]),_:2},1032,["href"]),s.id!==c(ce).id?(n(),i("button",{key:0,onClick:H=>me(s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},ot,8,tt)):g("",!0)])])]))),128))])])],512)):g("",!0),d.value==="roles"?(n(),i("div",{key:1,ref_key:"rolesScrollRef",ref:b,class:"relative overflow-x-auto"},[C(e("div",lt,null,512),[[L,X.value]]),C(e("div",rt,null,512),[[L,q.value]]),e("table",at,[e("thead",nt,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:S(K.value)},[f(" Nombre del Rol "),e("div",{onMousedown:Y,onTouchstart:ee(Y,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},ct,32)],4),dt])]),e("tbody",ut,[(n(!0),i(j,null,te(D.roles,(s,u)=>(n(),i("tr",{key:s.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:E(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r truncate",u%2===1?"bg-gray-100":"bg-white"]),style:S(K.value),title:s.name},z(s.name),15,ht),e("td",mt,[e("div",vt,[r(c(k),{href:t.route("admin.roles.edit",s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:a(()=>[pt]),_:2},1032,["href"]),e("button",{onClick:H=>pe(s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},_t,8,gt)])])]))),128))])])],512)):g("",!0)])])])])]),_:1}),r(le,{show:T.value,onClose:x},{default:a(()=>[e("div",xt,[wt,yt,e("div",bt,[r(re,{onClick:x},{default:a(()=>[f(" Cancelar ")]),_:1}),r(ae,{class:"ms-3",onClick:ve},{default:a(()=>[f(" Sí, Eliminar Usuario ")]),_:1})])])]),_:1},8,["show"]),r(le,{show:U.value,onClose:w},{default:a(()=>[e("div",Et,[Ct,Lt,e("div",St,[r(re,{onClick:w},{default:a(()=>[f(" Cancelar ")]),_:1}),r(ae,{class:"ms-3",onClick:ge},{default:a(()=>[f(" Sí, Eliminar Rol ")]),_:1})])])]),_:1},8,["show"]),r(Ee,{show:_.value,type:"info",title:"Notificación",message:M.value,"primary-text":"Entendido",onPrimary:o[2]||(o[2]=s=>_.value=!1),onClose:o[3]||(o[3]=s=>_.value=!1)},null,8,["show","message"]),r(Le,{show:c(de),section:"users",steps:c(ue),onComplete:c(he)},null,8,["show","steps","onComplete"])],64))}};export{Vt as default};
