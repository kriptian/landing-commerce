import{r,c as q,w as oe,o as ae,n as P,a as ne,b as a,d as n,e as u,u as h,h as re,f as x,g as e,T as W,i as k,j as M,v as le,k as G,t as l,F as S,l as D,m as v,p as U,q as K,s as ie,x as ce,y as ue}from"./app-Bhrzmz1I.js";import{_ as de}from"./AuthenticatedLayout-Fn25hYIa.js";import{_ as pe}from"./Pagination-CMbsv9QQ.js";import{u as me,S as he}from"./useSectionTour-DdKNX0wO.js";import"./AlertModal-BV2jmJtC.js";import"./Modal-D0oh2LX8.js";const xe=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestión de Inventario",-1),ve={class:"py-12"},fe={class:"max-w-screen-2xl mx-auto sm:px-6 lg:px-8"},_e={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ye={class:"p-6 text-gray-900"},we={class:"mb-4 flex items-center justify-between"},ge={class:"flex items-center gap-3"},be=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})],-1),ke=[be],Se={key:0,class:"relative"},Le={class:"flex items-center gap-2"},Ce=["href"],Ee=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{d:"M7 10a1 1 0 011-1h2V4a1 1 0 112 0v5h2a1 1 0 01.7 1.714l-3 3a1 1 0 01-1.4 0l-3-3A1 1 0 017 10z"}),e("path",{d:"M5 15a1 1 0 011 1v2a2 2 0 002 2h8a2 2 0 002-2v-2a1 1 0 112 0v2a4 4 0 01-4 4H8a4 4 0 01-4-4v-2a1 1 0 011-1z"})],-1),Ne={class:"relative z-30"},ze=e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"})],-1),Te={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded-md shadow-lg z-50"},Me=["onClick"],Be={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},Ie={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},Fe={class:"min-w-[920px] sm:min-w-full divide-y divide-gray-200"},Re={class:"sticky top-0 z-10 bg-gray-50"},Ae=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),Ve=[Ae],Oe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"STOCK ACTUAL",-1),Xe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ COMPRA",-1),$e=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ VENTA",-1),je=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"% Gan.",-1),qe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ Gan.",-1),Pe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Estado",-1),We=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap w-12"},[e("span",{class:"sr-only"},"Acciones")],-1),Ge={class:"bg-white divide-y divide-gray-200"},De={key:0,class:"odd:bg-white even:bg-gray-100"},Ue=["title"],Ke={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-800 font-bold"},He={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},Ye={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},Je={key:0},Qe={key:1},Ze={key:0},et={key:1},tt={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},st={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap w-12"},ot=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),at={key:0},nt=e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," No hay productos para mostrar. ",-1),rt=[nt],H="inv_firstcol_w_px",lt=90,it=320,xt={__name:"Index",props:{products:Object,filters:Object},setup(f){const L=f,{showTour:Y,steps:J,handleTourComplete:Q}=me("inventory"),_=r(!!L.filters?.search),p=r(L.filters?.search||""),c=r(L.filters?.status||""),B=r(null),y=r(!1),C=[{value:"",label:"Todos"},{value:"out_of_stock",label:"Agotados"},{value:"low_stock",label:"¡Pocas unidades!"}],Z=q(()=>(C.find(s=>s.value===c.value)||C[0]).label),ee=async()=>{_.value=!_.value,_.value?(await P(),B.value?.focus()):(p.value="",E())},E=()=>{ue.get(route("admin.inventory.index"),{search:p.value||void 0,status:c.value||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})};let I;oe(p,()=>{clearTimeout(I),I=setTimeout(()=>E(),350)});const te=s=>{c.value=s,y.value=!1,E()},se=s=>{if(!c.value)return!0;const o=Number(s.quantity)||0,t=Number(s.alert)||0;return c.value==="out_of_stock"?o<=0:c.value==="low_stock"?t>0&&o>0&&o<=t:!0},F=s=>{const o=Number(s.stock)||0,t=Number(s.alert)||0;return o<=0?{text:"Agotado",class:"bg-red-100 text-red-800"}:t>0&&o<=t?{text:"¡Pocas unidades!",class:"bg-yellow-100 text-yellow-800"}:{text:"En Stock",class:"bg-green-100 text-green-800"}},N=s=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(Number(s||0)),z=(s,o)=>{const t=Number(s||0),i=Number(o||0);return!t||!i||t<=0?null:Number(((i-t)/t*100).toFixed(2))},T=(s,o)=>{const t=Number(s||0),i=Number(o||0);if(!t||!i||t<=0)return null;const j=i-t;return j>=0?j:null},w=r(null),R=r(!1),A=r(!1),m=()=>{const s=w.value;if(!s)return;const o=s.scrollWidth-s.clientWidth,t=s.scrollLeft||0;R.value=t>0,A.value=t<o-1};ae(()=>{P(()=>m()),w.value?.addEventListener("scroll",m,{passive:!0}),window.addEventListener("resize",m)}),ne(()=>{w.value?.removeEventListener("scroll",m),window.removeEventListener("resize",m)});const d=r(Number(localStorage.getItem(H))||180),V=q(()=>({width:d.value+"px",minWidth:d.value+"px",maxWidth:d.value+"px"}));let O=0,X=0;const g=s=>{const o=s.touches?s.touches[0].clientX:s.clientX,t=Math.max(lt,Math.min(it,X+(o-O)));d.value=t},b=()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",b),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",b);try{localStorage.setItem(H,String(d.value))}catch{}},$=s=>{O=s.touches?s.touches[0].clientX:s.clientX,X=d.value,document.addEventListener("mousemove",g,{passive:!1}),document.addEventListener("mouseup",b),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",b)};return(s,o)=>(n(),a(S,null,[u(h(re),{title:"Gestión de Inventario"}),u(de,null,{header:x(()=>[xe]),default:x(()=>[e("div",ve,[e("div",fe,[e("div",_e,[e("div",ye,[e("div",we,[e("div",ge,[e("button",{type:"button",onClick:ee,class:"p-2 rounded hover:bg-gray-100 transition"},ke),u(W,{name:"fade-slide"},{default:x(()=>[_.value?(n(),a("div",Se,[M(e("input",{ref_key:"searchInputRef",ref:B,"onUpdate:modelValue":o[0]||(o[0]=t=>p.value=t),type:"text",placeholder:"Buscar producto...",class:"w-64 md:w-80 border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[le,p.value]])])):k("",!0)]),_:1})]),e("div",Le,[e("a",{href:s.route("admin.inventory.export"),class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150"},[Ee,G(" Exportar a Excel ")],8,Ce),e("div",Ne,[e("button",{type:"button",onClick:o[1]||(o[1]=t=>y.value=!y.value),class:"inline-flex items-center gap-2 px-3 py-2 border rounded-md shadow-sm hover:bg-gray-50"},[e("span",null,l(Z.value),1),ze]),u(W,{name:"fade-slide"},{default:x(()=>[y.value?(n(),a("ul",Te,[(n(),a(S,null,D(C,t=>e("li",{key:t.value},[e("button",{type:"button",onClick:i=>te(t.value),class:v(["w-full text-left px-3 py-2 hover:bg-gray-100",{"font-semibold text-indigo-600":t.value===c.value}])},l(t.label),11,Me)])),64))])):k("",!0)]),_:1})])])]),e("div",{ref_key:"scrollBoxRef",ref:w,class:"relative overflow-x-auto w-full z-0"},[M(e("div",Be,null,512),[[U,R.value]]),M(e("div",Ie,null,512),[[U,A.value]]),e("table",Fe,[e("thead",Re,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:K(V.value)},[G(" Producto "),e("div",{onMousedown:$,onTouchstart:ie($,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},Ve,32)],4),Oe,Xe,$e,je,qe,Pe,We])]),e("tbody",Ge,[(n(!0),a(S,null,D(f.products.data,(t,i)=>(n(),a(S,{key:t.id},[se(t)?(n(),a("tr",De,[e("td",{class:v(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r truncate",i%2===1?"bg-gray-100":"bg-white"]),style:K(V.value),title:t.name},l(t.name),15,Ue),e("td",Ke,l(t.quantity),1),e("td",He,l(N(t.purchase_price)),1),e("td",Ye,l(N(t.price)),1),e("td",{class:v(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":z(t.purchase_price,t.price)===null}])},[z(t.purchase_price,t.price)!==null?(n(),a("span",Je,l(z(t.purchase_price,t.price))+"%",1)):(n(),a("span",Qe,"—"))],2),e("td",{class:v(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":T(t.purchase_price,t.price)===null}])},[T(t.purchase_price,t.price)!==null?(n(),a("span",Ze,l(N(T(t.purchase_price,t.price))),1)):(n(),a("span",et,"—"))],2),e("td",tt,[e("span",{class:v(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",F({stock:t.quantity,alert:t.alert}).class])},l(F({stock:t.quantity,alert:t.alert}).text),3)]),e("td",st,[u(h(ce),{href:s.route("admin.products.edit",t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:x(()=>[ot]),_:2},1032,["href"])])])):k("",!0)],64))),128)),f.products.data.length===0?(n(),a("tr",at,rt)):k("",!0)])])],512),u(pe,{class:"mt-6",links:f.products.links},null,8,["links"])])])])]),u(he,{show:h(Y),section:"inventory",steps:h(J),onComplete:h(Q)},null,8,["show","steps","onComplete"])]),_:1})],64))}};export{xt as default};
