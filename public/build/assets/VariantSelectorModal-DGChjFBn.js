import{_ as j}from"./Modal-BkOswT5G.js";import{_ as A}from"./SecondaryButton-CWlETvd7.js";import{_ as P}from"./PrimaryButton-D3t8Fx2S.js";import{r as M,c as l,w as T,y as E,o as n,e as _,f as o,a as i,i as w,t as c,p as h,F as C,n as V,b as D,m as O}from"./app-CPrrGJQ0.js";const z={class:"p-6"},I={class:"text-lg font-medium text-gray-900 mb-4"},L={key:0,class:"mb-4 p-3 bg-blue-50 rounded-lg flex justify-between items-center text-blue-800"},q={class:"flex flex-col"},G=o("span",{class:"font-medium text-sm"},"Precio:",-1),H={class:"flex items-center gap-2"},J={key:0,class:"text-sm text-gray-500 line-through"},K={class:"flex flex-col text-right"},Q=o("span",{class:"font-medium text-sm"},"Stock Disponible:",-1),R={class:"text-xl font-bold"},U={key:1,class:"space-y-6"},W={class:"text-sm font-semibold text-gray-700 mb-2"},X={class:"flex flex-wrap gap-2"},Y=["onClick"],Z={key:2,class:"py-4 text-center text-gray-500"},ee={class:"mt-6 flex justify-end gap-3"},ne={__name:"VariantSelectorModal",props:{show:Boolean,product:Object},emits:["close","add-to-cart"],setup(v,{emit:S}){const r=v,g=S,u=M({}),x=l(()=>r.product?.variants||[]),m=l(()=>r.product?.variant_options||[]);T(()=>r.show,e=>{e&&(u.value={})});const $=(e,s)=>u.value[e]===s,F=(e,s)=>{u.value[e]=s},b=l(()=>m.value.length?m.value.every(e=>!!u.value[e.name]):!0),y=()=>x.value.length?x.value.find(e=>{const s=e.options;return s?Object.entries(u.value).every(([a,t])=>{const f=s[a];return f==null||t==null?f==t:String(f).trim()===String(t).trim()}):!1}):null,d=l(()=>y()),N=l(()=>d.value?d.value.stock:null),p=l(()=>{let e=r.product?.price;if(d.value){const t=d.value.price;t!==null&&t!==""&&t!==void 0&&(e=t)}e=parseFloat(e||0);let s=e,a=!1;if(r.product?.promo_active&&r.product?.promo_discount_percent>0){const t=parseFloat(r.product.promo_discount_percent);s=Math.round(e*(1-t/100)),a=!0}return{original:e,final:s,hasDiscount:a}}),k=e=>e==null?"":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),B=()=>{const e=y();e?(g("add-to-cart",r.product,e),g("close")):alert("Esta combinación de variantes no está disponible.")};return(e,s)=>(n(),E(j,{show:v.show,onClose:s[1]||(s[1]=a=>e.$emit("close"))},{default:_(()=>[o("div",z,[o("h2",I," Seleccionar Variante: "+c(v.product?.name),1),d.value?(n(),i("div",L,[o("div",q,[G,o("div",H,[p.value.hasDiscount?(n(),i("span",J,c(k(p.value.original)),1)):w("",!0),o("span",{class:h(["text-xl font-bold",p.value.hasDiscount?"text-blue-600":"text-gray-900"])},c(k(p.value.final)),3)])]),o("div",K,[Q,o("span",R,c(N.value??"N/A"),1)])])):w("",!0),m.value.length>0?(n(),i("div",U,[(n(!0),i(C,null,V(m.value,a=>(n(),i("div",{key:a.id},[o("h3",W,c(a.name),1),o("div",X,[(n(!0),i(C,null,V(a.children,t=>(n(),i("button",{key:t.id,onClick:f=>F(a.name,t.name),class:h(["px-4 py-2 text-sm rounded-md border transition-colors",[$(a.name,t.name)?"bg-indigo-600 text-white border-indigo-600 shadow-sm":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"]])},c(t.name),11,Y))),128))])]))),128))])):(n(),i("div",Z," No hay opciones disponibles para este producto. ")),o("div",ee,[D(A,{onClick:s[0]||(s[0]=a=>e.$emit("close"))},{default:_(()=>[O(" Cancelar ")]),_:1}),D(P,{onClick:B,disabled:!b.value,class:h({"opacity-50 cursor-not-allowed":!b.value})},{default:_(()=>[O(" Agregar al Carrito ")]),_:1},8,["disabled","class"])])])]),_:1},8,["show"]))}};export{ne as default};
