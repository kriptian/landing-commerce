import{B as $e,r as _,c as N,u as Ae,w as z,C as je,a as c,o as d,b,d as i,h as Ee,e as Y,f as t,g as R,i as v,j as g,l as f,v as Me,p as L,n as O,t as C,F as S,k as P,D as J,P as Oe,s as Z}from"./app-BNnuO4OS.js";import{_ as Ue}from"./AuthenticatedLayout-CT9Cmmv_.js";import{_ as F}from"./AlertModal-Bgv_gQox.js";import{u as Te,S as qe}from"./useSectionTour-VF9pJZmF.js";import"./Modal-C7fW6V1J.js";const Be=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Crear producto",-1),De={class:"py-12"},Ne={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ze={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Le={class:"p-6 text-gray-900"},Fe={class:"mb-4"},He=t("label",{for:"name",class:"block font-medium text-sm text-gray-700"},"Nombre",-1),Re={class:"mb-4"},We=t("label",{for:"price",class:"block font-medium text-sm text-gray-700"},"Precio (Principal)",-1),Ge={class:"p-4 border rounded-md bg-gray-50"},Ke={class:"inline-flex items-center gap-2 mb-3 select-none"},Qe=t("span",{class:"font-semibold"},"Controlar inventario",-1),Xe={key:0,class:"font-semibold text-gray-800 mb-2"},Ye={key:1,class:"text-xs text-gray-500 mb-4"},Je={key:2,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ze={for:"quantity",class:"block font-medium text-sm text-gray-700 flex items-center"},Ie=["disabled"],et={key:0,class:"mt-1 text-sm text-red-600"},tt={for:"alert",class:"block font-medium text-sm text-gray-700 flex items-center"},st=["disabled"],ot={for:"purchase_price",class:"block font-medium text-sm text-gray-700 flex items-center"},at={class:"mt-4 mb-2"},nt=t("label",{class:"block font-medium text-sm text-gray-700"},"CategorÃ­as",-1),lt={key:0,class:"mt-1 text-sm text-amber-600 font-medium"},rt={class:"space-y-3"},it=["onUpdate:modelValue","onChange","required"],ct=t("option",{value:null},"Seleccione una categorÃ­a",-1),dt=["value"],ut={key:0,class:"mt-1 text-sm text-red-600"},mt={key:1,class:"mt-1 text-sm text-red-600"},pt={class:"mb-4"},gt=t("label",{for:"short_description",class:"block font-medium text-sm text-gray-700"},"DescripciÃ³n Corta",-1),ht={class:"mb-4"},vt=t("label",{for:"long_description",class:"block font-medium text-sm text-gray-700"},"DescripciÃ³n Larga",-1),ft={class:"mb-4"},_t=t("label",{for:"specifications",class:"block font-medium text-sm text-gray-700"},"Especificaciones (separadas por comas)",-1),bt={class:"mb-4"},yt=t("label",{for:"meta_keywords",class:"block font-medium text-sm text-gray-700"},"Palabras Clave SEO (separadas por comas)",-1),wt=t("p",{class:"mt-1 text-xs text-gray-500"},"Estas palabras clave ayudan a mejorar el SEO del producto. No son visibles para los clientes.",-1),xt={class:"md:col-span-2 mt-6 border-t pt-6"},kt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ct={class:"p-6 text-gray-900"},St={class:"flex items-center justify-between"},Vt=t("h3",{class:"text-lg font-medium"},"Variantes del Producto",-1),Pt={class:"flex items-center gap-2"},$t={class:"mt-4 border rounded-lg divide-y"},At={key:0,class:"text-sm text-gray-500 p-3"},jt={class:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2"},Et={class:"flex-1 min-w-0"},Mt={class:"flex items-center gap-2"},Ot=["title","onClick"],Ut={key:0},Tt={key:1},qt=["onUpdate:modelValue"],Bt={key:0,class:"flex-shrink-0 text-xs bg-gray-100 text-gray-700 rounded px-2 py-0.5 align-middle"},Dt={class:"flex items-center gap-2 flex-shrink-0"},Nt=["title","onClick"],zt=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),t("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})],-1),Lt=[zt],Ft=["onClick"],Ht=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("rect",{x:"4",y:"3",width:"11",height:"15",rx:"2",ry:"2","stroke-width":"1.5"}),t("circle",{cx:"18",cy:"18",r:"3","stroke-width":"1.5"}),t("path",{"stroke-linecap":"round","stroke-width":"1.5",d:"M18 16.5v3M16.5 18h3"})],-1),Rt=[Ht],Wt=["onClick"],Gt=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),Kt=[Gt],Qt={key:0,class:"mt-2 pl-2 bg-gray-50 rounded-md p-2"},Xt={class:"grid grid-cols-1 md:grid-cols-5 gap-3"},Yt={class:"md:col-span-2"},Jt=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Depende de",-1),Zt=["onUpdate:modelValue"],It=t("option",{value:""},"(sin dependencia)",-1),es=["value","disabled"],ts={key:0,class:"md:col-span-3"},ss=t("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"Permitir valores segÃºn el valor del padre",-1),os={class:"mt-2 space-y-2"},as={class:"text-xs font-semibold text-gray-700 mb-1"},ns={class:"flex flex-wrap gap-2"},ls=["checked","onChange"],rs={key:1,class:"mt-2 pl-4 border-l"},is={class:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-3"},cs=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Nombre",-1),ds=["onUpdate:modelValue"],us=t("label",{class:"block text-xs font-medium text-gray-600 mb-1"},"Precio (opcional)",-1),ms=["onUpdate:modelValue","disabled","onInput"],ps={key:0,class:"mt-1 text-xs text-amber-600"},gs={class:"flex items-center gap-2"},hs=["onChange","id","disabled"],vs={key:0,class:"relative"},fs=["src"],_s=["onClick"],bs=["for","title"],ys=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-5 h-5 text-gray-400",fill:"currentColor"},[t("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1),ws=[ys],xs={key:2,class:"mt-1 text-xs text-amber-600"},ks={class:"flex items-center gap-2 ml-2"},Cs=["onClick"],Ss=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),Vs=[Ss],Ps=t("label",{class:"block font-medium text-sm text-gray-700"},"AÃ±adir Nueva Variante Principal",-1),$s={class:"mt-2 flex items-center gap-2"},As=t("button",{type:"submit",class:"w-8 h-8 inline-flex items-center justify-center rounded bg-green-500 text-white hover:bg-green-600",title:"AÃ±adir"}," âœ” ",-1),js={class:"md:col-span-2 mt-6 border-t pt-6"},Es=t("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"ImÃ¡genes Extra de la GalerÃ­a",-1),Ms=t("p",{class:"text-sm text-gray-600 mb-4"}," Estas imÃ¡genes se agregarÃ¡n a la galerÃ­a general del producto. Las imÃ¡genes de las variantes se muestran cuando se selecciona esa opciÃ³n. ",-1),Os={class:"mb-4"},Us=t("label",{for:"gallery_files",class:"block font-medium text-sm text-gray-700"},"ImÃ¡genes de la GalerÃ­a",-1),Ts=t("p",{class:"mt-1 text-xs text-gray-500"},"Formatos de imagen y hasta 2 MB por archivo.",-1),qs={class:"md:col-span-2 flex items-center justify-end mt-6 border-t pt-6"},Bs=["disabled"],Ds=t("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),t("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),Ns=t("span",null,"Crear",-1),zs=[Ds,Ns],Ls={key:0,class:"ml-3 text-sm text-red-600"},I=2*1024*1024,Ks={__name:"Create",props:{categories:Array},setup(ee){const te=ee,se=$e(),U=_(!!se?.props?.flash?.success),V=_(!1),j=_([]),{showTour:oe,steps:ae,handleTourComplete:ne}=Te("products-create"),le=o=>{const e=Array.from(o?.target?.files||[]),l=[],s=[];for(const a of e){if(!(a?.type||"").startsWith("image/")){l.push(`${a.name}: no es una imagen vÃ¡lida.`);continue}if(a.size>I){l.push(`${a.name}: supera el lÃ­mite de 2 MB.`);continue}s.push(a)}if(l.length){j.value=["Problemas con las imÃ¡genes seleccionadas:",...l],V.value=!0,o?.target&&(o.target.value=""),n.gallery_files=[];return}n.gallery_files=s},y=_([{options:te.categories,selected:null}]),re=o=>{y.value.splice(o+1)},ie=async o=>{const e=y.value[o].selected;if(re(o),n.category_id=e,!e)return;const l=await fetch(route("admin.categories.children",e));if(!l.ok)return;const s=await l.json(),a=Array.isArray(s.data)?s.data:[];a.length>0&&(y.value.push({options:a,selected:null}),n.category_id=null)},T=N(()=>{if(y.value.length>1){const o=y.value[y.value.length-1];return o.options.length>0&&!o.selected}return!1}),n=Ae({name:"",price:"",purchase_price:null,retail_price:null,track_inventory:!0,quantity:0,alert:null,category_id:null,short_description:"",long_description:"",specifications:"",meta_keywords:"",gallery_files:[],variant_options:[],variants:[],variant_attributes:[]}),u=_([]),E=_(""),w=_({}),ce=o=>{w.value[o]=!(w.value[o]??!1)},W=()=>{const o=E.value.trim()||"",e=u.value.length;u.value.push({id:null,name:o,children:[],order:e,dependsOn:"",rules:{},rulesSelected:{},__showDependency:!1}),w.value[e]=!0,E.value=""},de=o=>{u.value.splice(o,1)},ue=o=>{u.value[o].children||(u.value[o].children=[]),u.value[o].children.push({id:null,name:"",price:null,image:null,imagePreview:null,imagePath:null,order:u.value[o].children.length}),w.value[o]=!0},me=(o,e)=>{u.value[o].children.splice(e,1)},pe=(o,e,l)=>{const s=l?.target?.files?.[0];if(!s)return;if(!A(o)){l?.target&&(l.target.value=""),G.value||(D.value=!0,G.value=!0);return}const a=[];if((s?.type||"").startsWith("image/")||a.push(`${s.name}: no es una imagen vÃ¡lida.`),s.size>I&&a.push(`${s.name}: supera el lÃ­mite de 2 MB.`),a.length){j.value=["Problemas con la imagen de la variante:",...a],V.value=!0,l?.target&&(l.target.value=""),u.value[o].children[e].image=null,u.value[o].children[e].imagePreview=null;return}u.value[o].children[e].image=s;const m=new FileReader;m.onload=p=>{u.value[o].children[e].imagePreview=p.target.result},m.readAsDataURL(s)},ge=(o,e)=>{u.value[o].children[e].image=null,u.value[o].children[e].imagePreview=null},he=()=>{const o=[];return u.value.forEach((e,l)=>{if(!e.name.trim())return;const s={name:e.name.trim(),parent_id:null,price:null,image_path:null,order:l,children:[]};e.children&&e.children.length>0&&e.children.forEach((a,r)=>{a.name.trim()&&s.children.push({name:a.name.trim(),parent_id:null,price:a.price?parseFloat(a.price):null,image_file_key:a.image?`variant_option_${l}_${r}`:null,order:r})}),(s.children.length>0||s.name)&&o.push(s)}),o},ve=()=>{const o=[];return u.value.forEach(e=>{if(!e.name.trim())return;const l=(e.children||[]).map(a=>a.name.trim()).filter(Boolean);if(l.length===0)return;const s={name:e.name.trim(),values:l,valuesText:l.join(", "),dependsOn:e.dependsOn||"",rules:e.rules||{},rulesSelected:e.rulesSelected||{}};o.push(s)}),o},fe=N(()=>u.value.filter(e=>!e.children||e.children.length===0?!1:e.children.some(l=>l.price&&l.price!==""&&l.price!=null)).length>1);N(()=>u.value.find(o=>!o.children||o.children.length===0?!1:o.children.some(e=>e.price&&e.price!==""&&e.price!=null)));const $=_(!1),q=_(!1),_e=["Has intentado agregar precios a una variante cuando ya existe otra variante principal con precios configurados.","","ðŸ“‹ Regla del Sistema:","Solo puedes asignar precios a las opciones hijas de UNA variante principal. Si ya asignaste precios a una variante (por ejemplo, Color), no podrÃ¡s agregar precios a otra variante (por ejemplo, Equipo).","","ðŸ’¡ CÃ³mo funciona:","Cuando un cliente seleccione una opciÃ³n de la variante que tiene precios, se mostrarÃ¡ el precio de esa opciÃ³n especÃ­fica. Si no selecciona ninguna opciÃ³n o selecciona una opciÃ³n sin precio, se usarÃ¡ el precio principal del producto.","","ðŸ’¡ Sugerencia:","Si necesitas diferentes precios segÃºn mÃºltiples caracterÃ­sticas, considera crear productos separados o usar una sola variante que combine ambas caracterÃ­sticas."],B=o=>!u.value.find((l,s)=>s===o||!l.children||l.children.length===0?!1:l.children.some(a=>a.price&&a.price!==""&&a.price!=null)),A=o=>!u.value.find((l,s)=>s===o||!l.children||l.children.length===0?!1:l.children.some(a=>a.imagePreview||a.image||a.imagePath&&a.imagePath!=="")),be=(o,e,l)=>{const s=l?.target?.value;!s||s===""||s==null||B(o)||(l.target.value="",u.value[o].children[e].price=null,q.value||($.value=!0,q.value=!0))},D=_(!1),G=_(!1),ye=["Has intentado agregar imÃ¡genes a una variante cuando ya existe otra variante principal con imÃ¡genes configuradas.","","ðŸ“‹ Regla del Sistema:","Solo puedes asignar imÃ¡genes a las opciones hijas de UNA variante principal. Si ya asignaste imÃ¡genes a una variante (por ejemplo, Color), no podrÃ¡s agregar imÃ¡genes a otra variante (por ejemplo, Equipo).","","ðŸ’¡ CÃ³mo funciona:","Cuando un cliente seleccione una opciÃ³n de la variante que tiene imÃ¡genes, se mostrarÃ¡ la imagen de esa opciÃ³n especÃ­fica en la galerÃ­a. Si no selecciona ninguna opciÃ³n o selecciona una opciÃ³n sin imagen, se mostrarÃ¡n las imÃ¡genes regulares del producto.","","ðŸ’¡ Sugerencia:","Si necesitas diferentes imÃ¡genes segÃºn mÃºltiples caracterÃ­sticas, considera crear productos separados o usar una sola variante que combine ambas caracterÃ­sticas."];z(()=>u.value,()=>{q.value||setTimeout(()=>{fe.value&&!$.value&&($.value=!0,q.value=!0)},1e3)},{deep:!0}),z(()=>n.track_inventory,o=>{o&&(n.retail_price=n.price)}),z(()=>n.price,o=>{n.track_inventory&&(n.retail_price=o)});const we=_([{name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}}]),K=o=>String(o||"").split(",").map(e=>e.trim()).filter(Boolean);function xe(o,e,l){return(o.rulesSelected&&Array.isArray(o.rulesSelected[e])?o.rulesSelected[e]:[]).includes(l)}function ke(o,e,l,s){const a=!!s?.target?.checked;o.rulesSelected||(o.rulesSelected={});const r=Array.isArray(o.rulesSelected[e])?[...o.rulesSelected[e]]:[],m=r.indexOf(l);a&&m===-1&&r.push(l),!a&&m!==-1&&r.splice(m,1),o.rulesSelected[e]=r}function Ce(o){o.__showDependency=!o.__showDependency,o.__showDependency||(o.dependsOn="",o.rulesSelected={},o.rules={})}const Se=N(()=>n.variants.length===0?Number(n.quantity)||0:n.variants.reduce((o,e)=>o+(Number(e.stock)||0),0));z(Se,o=>{n.variants.length>0&&(n.quantity=o)});const Ve=()=>{if(T.value){j.value=["DebÃ©s seleccionar una subcategorÃ­a. La categorÃ­a principal tiene subcategorÃ­as disponibles y es obligatorio elegir una de ellas."],V.value=!0,Z(()=>{const e=document.querySelector(".space-y-3 select");e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.focus())});return}n.variant_options=he();const o=ve();if(o.length>0)n.variant_attributes=o.map(e=>({name:e.name,values:e.values,dependsOn:e.dependsOn||"",rulesSelected:e.rulesSelected||{},rules:e.rules||{}}));else try{const e=we.value.map(l=>({name:String(l.name||"").trim(),values:K(l.valuesText),dependsOn:String(l.dependsOn||"").trim(),rules:l.rules||{},rulesSelected:l.rulesSelected||{}})).filter(l=>l.name&&l.values.length>0);if(n.variant_attributes=e,e.length>0){let r=function(h){a.has(h.name)||(h.dependsOn&&l[h.dependsOn]&&r(l[h.dependsOn]),a.add(h.name),s.push(h))},p=function(h,x){if(h===s.length){m.push({...x});return}const k=s[h];let Q=k.values;if(k.dependsOn){const M=x[k.dependsOn];if(M!=null){const H=k.rulesSelected?.[M]??k.rules?.[M]??[],X=Array.isArray(H)?H:K(H);X.length>0&&(Q=k.values.filter(Pe=>X.includes(Pe)))}}for(const M of Q)x[k.name]=M,p(h+1,x);delete x[k.name]};const l=Object.fromEntries(e.map(h=>[h.name,h])),s=[],a=new Set;e.forEach(r);const m=[];p(0,{}),n.variants=m.map(h=>({options_text:s.map(x=>`${x.name}:${h[x.name]}`).join(", "),price:"",purchase_price:null,stock:0,alert:null}))}}catch{n.variant_attributes=[]}n.transform(e=>(u.value.forEach((l,s)=>{l.children&&l.children.length>0&&l.children.forEach((a,r)=>{if(a.image instanceof File){const m=`variant_option_${s}_${r}`;e[m]=a.image}})}),e)),console.log("ðŸ” CREATE - Enviando formulario",{hasVariantOptions:n.variant_options?.length>0,variantOptionsCount:n.variant_options?.length||0,hasVariantAttributes:n.variant_attributes?.length>0,variantAttributesCount:n.variant_attributes?.length||0,hasGalleryFiles:n.gallery_files?.length>0,formKeys:Object.keys(n.data())}),n.post(route("admin.products.store"),{preserveScroll:!0,onError:async()=>{await Z();const e=[];for(const[a,r]of Object.entries(n.errors))a.startsWith("gallery_files.")&&String(r).includes("The gallery files.")?e.push("Una o mÃ¡s imÃ¡genes superan el tamaÃ±o mÃ¡ximo permitido (2 MB) o no son vÃ¡lidas."):a.startsWith("new_gallery_files.")?e.push("Una o mÃ¡s imÃ¡genes nuevas superan el tamaÃ±o mÃ¡ximo permitido (2 MB) o no son vÃ¡lidas."):e.push(String(r));j.value=e,V.value=e.length>0;const l=Object.keys(n.errors)[0],s=document.getElementById(l);s&&typeof s.scrollIntoView=="function"&&(s.scrollIntoView({behavior:"smooth",block:"center"}),s.focus?.())},onSuccess:()=>{U.value=!0,n.reset()}})};return(o,e)=>{const l=je("InfoTip");return d(),c(S,null,[b(i(Ee),{title:"Crear Producto"}),b(Ue,null,{header:Y(()=>[Be]),default:Y(()=>[t("div",De,[t("div",Ne,[t("div",ze,[t("div",Le,[t("form",{onSubmit:R(Ve,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 gap-6"},[t("div",null,[t("div",Fe,[He,g(t("input",{id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>i(n).name=s),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[f,i(n).name]])]),t("div",Re,[We,g(t("input",{id:"price","onUpdate:modelValue":e[1]||(e[1]=s=>i(n).price=s),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[f,i(n).price]])]),t("div",Ge,[t("label",Ke,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>i(n).track_inventory=s),class:"rounded"},null,512),[[Me,i(n).track_inventory]]),Qe]),i(n).track_inventory?(d(),c("h4",Xe,"Inventario y Precios")):v("",!0),i(n).track_inventory?(d(),c("p",Ye," Si creas variantes, estos totales se calcularÃ¡n solos. ")):v("",!0),i(n).track_inventory?(d(),c("div",Je,[t("div",null,[t("label",Ze,[L("Inventario (Total) "),b(l,{class:"ml-1 md:hidden",text:"Stock si no hay variantes. Con variantes, se suma automÃ¡ticamente."})]),g(t("input",{id:"quantity","onUpdate:modelValue":e[3]||(e[3]=s=>i(n).quantity=s),type:"number",class:O(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":i(n).variants.length>0}]),disabled:i(n).track_inventory===!1||i(n).variants.length>0,title:"Stock si no hay variantes. Con variantes, se suma automÃ¡ticamente."},null,10,Ie),[[f,i(n).quantity]]),i(n).errors.quantity?(d(),c("p",et,C(i(n).errors.quantity),1)):v("",!0)]),t("div",null,[t("label",tt,[L("Alerta (Opcional) "),b(l,{class:"ml-1 md:hidden",text:"Se considera bajo stock cuando cantidad â‰¤ alerta."})]),g(t("input",{id:"alert","onUpdate:modelValue":e[4]||(e[4]=s=>i(n).alert=s),type:"number",class:O(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":i(n).variants.length>0&&i(n).track_inventory}]),disabled:i(n).variants.length>0&&i(n).track_inventory,title:"Se considera bajo stock cuando cantidad â‰¤ alerta."},null,10,st),[[f,i(n).alert]])]),t("div",null,[t("label",ot,[L("Precio de compra "),b(l,{class:"ml-1 md:hidden",text:"Costo de adquisiciÃ³n del producto."})]),g(t("input",{id:"purchase_price","onUpdate:modelValue":e[5]||(e[5]=s=>i(n).purchase_price=s),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[f,i(n).purchase_price]])])])):v("",!0)]),t("div",at,[nt,T.value?(d(),c("p",lt," âš ï¸ Es obligatorio seleccionar una subcategorÃ­a ")):v("",!0)]),t("div",rt,[(d(!0),c(S,null,P(y.value,(s,a)=>(d(),c("div",{key:a,class:"mb-1"},[g(t("select",{class:O(["block w-full rounded-md shadow-sm border-gray-300",{"border-red-500":T.value&&a===y.value.length-1&&!s.selected}]),"onUpdate:modelValue":r=>s.selected=r,onChange:r=>ie(a),required:a===y.value.length-1&&s.options.length>0},[ct,(d(!0),c(S,null,P(s.options,r=>(d(),c("option",{key:r.id,value:r.id},C(r.name),9,dt))),128))],42,it),[[J,s.selected]])]))),128))]),i(n).errors.category_id?(d(),c("p",ut,C(i(n).errors.category_id),1)):v("",!0),T.value&&!i(n).errors.category_id?(d(),c("p",mt," DebÃ©s seleccionar una subcategorÃ­a. La categorÃ­a principal tiene subcategorÃ­as disponibles. ")):v("",!0)]),t("div",null,[t("div",pt,[gt,g(t("textarea",{id:"short_description","onUpdate:modelValue":e[6]||(e[6]=s=>i(n).short_description=s),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3"},null,512),[[f,i(n).short_description]])]),t("div",ht,[vt,g(t("textarea",{id:"long_description","onUpdate:modelValue":e[7]||(e[7]=s=>i(n).long_description=s),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"5"},null,512),[[f,i(n).long_description]])]),t("div",ft,[_t,g(t("input",{id:"specifications","onUpdate:modelValue":e[8]||(e[8]=s=>i(n).specifications=s),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",placeholder:"Alto: 2.30m,Ancho: 1.20m,..."},null,512),[[f,i(n).specifications]])]),t("div",bt,[yt,g(t("input",{id:"meta_keywords","onUpdate:modelValue":e[9]||(e[9]=s=>i(n).meta_keywords=s),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",placeholder:"palabra1, palabra2, palabra3"},null,512),[[f,i(n).meta_keywords]]),wt])]),t("div",xt,[t("div",kt,[t("div",Ct,[t("div",St,[Vt,t("div",Pt,[t("button",{type:"button",class:"w-7 h-7 inline-flex items-center justify-center rounded border border-gray-300 hover:bg-gray-100 text-gray-700",title:"Expandir todo",onClick:e[10]||(e[10]=()=>{u.value.forEach((s,a)=>w.value[a]=!0)})}," + "),t("button",{type:"button",class:"w-7 h-7 inline-flex items-center justify-center rounded border border-gray-300 hover:bg-gray-100 text-gray-700",title:"Colapsar todo",onClick:e[11]||(e[11]=()=>{u.value.forEach((s,a)=>w.value[a]=!1)})}," âˆ’ ")])]),t("div",$t,[u.value.length===0?(d(),c("p",At," AÃºn no hay variantes principales. AgregÃ¡ una usando el botÃ³n de abajo. ")):v("",!0),(d(!0),c(S,null,P(u.value,(s,a)=>(d(),c("div",{key:`parent-${a}`,class:"p-3 hover:bg-gray-50"},[t("div",jt,[t("div",Et,[t("div",Mt,[t("button",{type:"button",class:"w-6 h-6 flex-shrink-0 inline-flex items-center justify-center rounded-full border border-gray-300 text-gray-700 hover:bg-gray-100",title:w.value[a]??!1?"Colapsar opciones":"Expandir opciones",onClick:r=>ce(a)},[w.value[a]??!1?(d(),c("span",Tt,"v")):(d(),c("span",Ut,">"))],8,Ot),g(t("input",{"onUpdate:modelValue":r=>s.name=r,type:"text",placeholder:"Ej: Color, Talla, Material",class:"flex-1 min-w-0 font-medium border-0 bg-transparent focus:bg-white focus:border focus:border-gray-300 rounded px-2 py-1 focus:outline-none"},null,8,qt),[[f,s.name]]),s.children&&s.children.length>0?(d(),c("span",Bt," ("+C(s.children.length)+") ",1)):v("",!0)])]),t("div",Dt,[t("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:s.__showDependency?"Ocultar dependencia":"Configurar dependencia",onClick:r=>Ce(s)},Lt,8,Nt),t("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded border border-green-500 text-green-600 hover:bg-green-50",title:"AÃ±adir opciÃ³n",onClick:r=>ue(a)},Rt,8,Ft),t("button",{type:"button",onClick:r=>de(a),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},Kt,8,Wt)])]),s.__showDependency?(d(),c("div",Qt,[t("div",Xt,[t("div",Yt,[Jt,g(t("select",{"onUpdate:modelValue":r=>s.dependsOn=r,class:"block w-full text-sm border-gray-300 rounded-md shadow-sm"},[It,(d(!0),c(S,null,P(u.value,(r,m)=>(d(),c("option",{key:`dep-${a}-${m}`,value:r.name,disabled:r===s||!r.name},C(r.name||"(sin nombre)"),9,es))),128))],8,Zt),[[J,s.dependsOn]])]),s.dependsOn?(d(),c("div",ts,[ss,t("div",os,[(d(!0),c(S,null,P((u.value.find(r=>r.name===s.dependsOn)?.children||[]).map(r=>r.name),r=>(d(),c("div",{key:`pv-${a}-${r}`,class:"border rounded p-2 bg-white"},[t("div",as,[L(C(s.dependsOn)+" = ",1),t("strong",null,C(r),1)]),t("div",ns,[(d(!0),c(S,null,P((s.children||[]).map(m=>m.name),m=>(d(),c("label",{key:`cv-${a}-${r}-${m}`,class:"inline-flex items-center gap-1 text-xs"},[t("input",{type:"checkbox",checked:xe(s,r,m),onChange:p=>ke(s,r,m,p),class:"rounded"},null,40,ls),t("span",null,C(m),1)]))),128))])]))),128))])])):v("",!0)])])):v("",!0),w.value[a]??!1?(d(),c("div",rs,[(d(!0),c(S,null,P(s.children,(r,m)=>(d(),c("div",{key:`child-${a}-${m}`,class:"py-2 flex justify-between items-start"},[t("div",is,[t("div",null,[cs,g(t("input",{"onUpdate:modelValue":p=>r.name=p,type:"text",placeholder:"Ej: Rojo, Verde",class:"block w-full text-sm border-gray-300 rounded-md shadow-sm"},null,8,ds),[[f,r.name]])]),t("div",null,[us,g(t("input",{"onUpdate:modelValue":p=>r.price=p,type:"number",step:"0.01",placeholder:"Usa precio principal",class:O(["block w-full text-sm border-gray-300 rounded-md shadow-sm",{"bg-gray-100 cursor-not-allowed":!B(a)}]),disabled:!B(a),onInput:p=>be(a,m,p)},null,42,ms),[[f,r.price]]),B(a)?v("",!0):(d(),c("p",ps," Solo puedes agregar precios a una variante principal "))]),t("div",gs,[t("input",{type:"file",accept:"image/*",onChange:p=>pe(a,m,p),class:"hidden",id:`variant-image-input-${a}-${m}`,disabled:!A(a)},null,40,hs),r.imagePreview?(d(),c("div",vs,[t("img",{src:r.imagePreview,alt:"Preview",class:"w-10 h-10 object-cover rounded border"},null,8,fs),t("button",{type:"button",onClick:R(p=>ge(a,m),["stop"]),class:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-4 h-4 flex items-center justify-center text-xs hover:bg-red-600"}," Ã— ",8,_s)])):(d(),c("label",{key:1,for:`variant-image-input-${a}-${m}`,class:O(["inline-flex items-center justify-center w-10 h-10 border-2 border-dashed border-gray-300 rounded hover:border-blue-400 hover:bg-blue-50 transition",{"cursor-pointer":A(a),"cursor-not-allowed opacity-50":!A(a)}]),title:A(a)?"Agregar foto":"Solo puedes agregar imÃ¡genes a una variante principal"},ws,10,bs)),A(a)?v("",!0):(d(),c("p",xs," Solo puedes agregar imÃ¡genes a una variante principal "))])]),t("div",ks,[t("button",{type:"button",onClick:p=>me(a,m),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},Vs,8,Cs)])]))),128))])):v("",!0)]))),128))]),t("form",{onSubmit:R(W,["prevent"]),class:"mt-6 border-t pt-4"},[Ps,t("div",$s,[g(t("input",{type:"text","onUpdate:modelValue":e[12]||(e[12]=s=>E.value=s),class:"block w-full rounded-md shadow-sm border-gray-300",placeholder:"Nombre de la nueva variante principal",onKeyup:Oe(W,["enter"])},null,544),[[f,E.value]]),As,t("button",{type:"button",class:"w-8 h-8 inline-flex items-center justify-center rounded bg-gray-200 text-gray-800 hover:bg-gray-300",onClick:e[13]||(e[13]=s=>E.value=""),title:"Cancelar"}," âœ– ")])],32)])])]),t("div",js,[Es,Ms,t("div",Os,[Us,t("input",{id:"gallery_files",onInput:e[14]||(e[14]=s=>le(s)),type:"file",multiple:"",class:"block mt-1 w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),Ts])]),t("div",qs,[t("button",{type:"submit",disabled:i(n).processing,class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},zs,8,Bs),Object.keys(i(n).errors).length?(d(),c("span",Ls,"Por favor corrige los campos marcados.")):v("",!0)])],32)])])])])]),_:1}),b(F,{show:U.value,type:"success",title:"Â¡Producto creado con Ã©xito!","primary-text":"Entendido",onPrimary:e[15]||(e[15]=s=>U.value=!1),onClose:e[16]||(e[16]=s=>U.value=!1)},null,8,["show"]),b(F,{show:V.value,type:"error",title:"No pudimos guardar el producto",message:"RevisÃ¡ los siguientes puntos:",messages:j.value,"primary-text":"Entendido",onPrimary:e[17]||(e[17]=s=>V.value=!1),onClose:e[18]||(e[18]=s=>V.value=!1)},null,8,["show","messages"]),b(F,{show:$.value,type:"warning",title:"Solo una Variante Puede Tener Precios",messages:_e,"primary-text":"Entendido",onPrimary:e[19]||(e[19]=s=>$.value=!1),onClose:e[20]||(e[20]=s=>$.value=!1)},null,8,["show"]),b(F,{show:D.value,type:"warning",title:"Solo una Variante Puede Tener ImÃ¡genes",messages:ye,"primary-text":"Entendido",onPrimary:e[21]||(e[21]=s=>D.value=!1),onClose:e[22]||(e[22]=s=>D.value=!1)},null,8,["show"]),b(qe,{show:i(oe),section:"products-create",steps:i(ae),onComplete:i(ne)},null,8,["show","steps","onComplete"])],64)}}};export{Ks as default};
