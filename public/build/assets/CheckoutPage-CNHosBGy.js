import{c as F,z as D,r as g,b as l,d as i,e as y,g as e,f as V,i as x,u as a,h as q,t as n,s as E,j as m,v as p,F as _,l as v,k as O}from"./app-Bhrzmz1I.js";import{_ as U}from"./AlertModal-BV2jmJtC.js";import"./Modal-D0oh2LX8.js";const j=["href"],I={class:"bg-white shadow-sm sticky top-0"},B={class:"container mx-auto px-6 py-4"},M={class:"text-2xl font-bold text-gray-900"},T={class:"container mx-auto px-6 py-12"},z={class:"grid grid-cols-1 md:grid-cols-2 gap-12"},A=e("h1",{class:"text-3xl font-bold mb-8"},"Datos de Envío",-1),S=e("label",{for:"customer_name",class:"block font-medium text-sm text-gray-700"},"Nombre Completo",-1),$=e("label",{for:"customer_phone",class:"block font-medium text-sm text-gray-700"},"Teléfono (WhatsApp)",-1),R=e("label",{for:"customer_email",class:"block font-medium text-sm text-gray-700"},"Correo Electrónico",-1),W=e("label",{for:"customer_address",class:"block font-medium text-sm text-gray-700"},"Dirección Completa (con ciudad y detalles)",-1),H=["disabled"],L={class:"bg-gray-50 p-8 rounded-lg"},G=e("h2",{class:"text-2xl font-bold mb-6"},"Resumen de tu Pedido",-1),J={class:"space-y-4"},K={class:"flex items-start gap-3 flex-1 min-w-0"},Q=["src"],X={class:"min-w-0"},Y={class:"font-semibold break-words"},Z={key:0,class:"text-sm text-gray-500 break-words"},ee={class:"text-sm text-gray-600"},te={class:"font-semibold whitespace-nowrap shrink-0 sm:text-right mt-2 sm:mt-0"},se={class:"border-t mt-6 pt-6"},oe={class:"flex justify-between font-bold text-xl"},re=e("span",null,"Total",-1),ie={__name:"CheckoutPage",props:{cartItems:Array,store:Object},setup(c){const d=c,w=o=>{const t=o?.variant||null,s=o?.product||null;return t&&t.retail_price!=null&&t.retail_price!==""?Number(t.retail_price):t&&t.price!=null&&t.price!==""?Number(t.price):s&&s.retail_price!=null&&s.retail_price!==""?Number(s.retail_price):Number(s?.price??0)},k=o=>{try{return d.store?.promo_active&&Number(d.store?.promo_discount_percent||0)>0?Number(d.store.promo_discount_percent):o?.product?.promo_active&&Number(o?.product?.promo_discount_percent||0)>0?Number(o.product.promo_discount_percent):0}catch{return 0}},b=o=>{const t=w(o),s=k(o);return s>0?Math.round(t*(100-s)/100):t},N=F(()=>d.cartItems.reduce((o,t)=>o+b(t)*t.quantity,0)),r=D({customer_name:"",customer_phone:"",customer_email:"",customer_address:""}),u=g(!1),f=g(""),C=()=>{r.post(route("checkout.store",{store:d.store.slug}),{onSuccess:()=>{},onError:o=>{f.value="Hubo un error al procesar tu pedido. Por favor verificá tus datos.",u.value=!0}})};return(o,t)=>(i(),l(_,null,[y(a(q),{title:"Finalizar Compra"},{default:V(()=>[c.store?.logo_url?(i(),l("link",{key:0,rel:"icon",type:"image/png",href:c.store.logo_url},null,8,j)):x("",!0)]),_:1}),e("header",I,[e("nav",B,[e("h1",M,n(c.store.name),1)])]),e("main",T,[e("div",z,[e("div",null,[A,e("form",{onSubmit:E(C,["prevent"]),class:"space-y-6 bg-white p-8 shadow rounded-lg"},[e("div",null,[S,m(e("input",{id:"customer_name","onUpdate:modelValue":t[0]||(t[0]=s=>a(r).customer_name=s),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[p,a(r).customer_name]])]),e("div",null,[$,m(e("input",{id:"customer_phone","onUpdate:modelValue":t[1]||(t[1]=s=>a(r).customer_phone=s),type:"tel",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[p,a(r).customer_phone]])]),e("div",null,[R,m(e("input",{id:"customer_email","onUpdate:modelValue":t[2]||(t[2]=s=>a(r).customer_email=s),type:"email",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[p,a(r).customer_email]])]),e("div",null,[W,m(e("textarea",{id:"customer_address","onUpdate:modelValue":t[3]||(t[3]=s=>a(r).customer_address=s),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3",required:""},null,512),[[p,a(r).customer_address]])]),e("button",{type:"submit",disabled:a(r).processing,class:"w-full bg-green-600 text-white font-bold py-3 px-6 rounded-lg text-center hover:bg-green-700 disabled:opacity-50"},n(a(r).processing?"Procesando...":"Realizar Pedido por WhatsApp"),9,H)],32)]),e("div",L,[G,e("div",J,[(i(!0),l(_,null,v(c.cartItems,s=>(i(),l("div",{key:s.id,class:"flex flex-col sm:flex-row sm:items-start sm:justify-between sm:gap-4"},[e("div",K,[e("img",{src:s.product.main_image_url,class:"w-16 h-16 object-cover rounded"},null,8,Q),e("div",X,[e("p",Y,n(s.product.name),1),s.variant?(i(),l("div",Z,[(i(!0),l(_,null,v(s.variant.options,(P,h)=>(i(),l("span",{key:h,class:"mr-2 inline-block"},[e("strong",null,n(h)+":",1),O(" "+n(P),1)]))),128))])):x("",!0),e("p",ee,"Cantidad: "+n(s.quantity),1)])]),e("p",te,n(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(b(s)*s.quantity)),1)]))),128))]),e("div",se,[e("div",oe,[re,e("span",null,n(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(N.value)),1)])])])])]),y(U,{show:u.value,type:"error",title:"No pudimos procesar tu pedido",message:f.value,"primary-text":"Entendido",onPrimary:t[4]||(t[4]=s=>u.value=!1),onClose:t[5]||(t[5]=s=>u.value=!1)},null,8,["show","message"])],64))}};export{ie as default};
