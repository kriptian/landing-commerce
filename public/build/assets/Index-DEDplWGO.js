import{H as ee,r as a,B as te,C as se,D as oe,c as ae,a as l,o as i,b as n,d as b,h as ne,e as d,f as e,i as z,j as v,q as re,F as N,n as j,t as m,x as F,m as h,l as X,E as H,s as O,g as le,p as ie,z as p}from"./app-BWfncV94.js";import{_ as ce}from"./AuthenticatedLayout-J7uuA0aO.js";import{_ as de}from"./Modal-BKig7U95.js";import{_ as pe}from"./SecondaryButton-IaEv-UOU.js";import{D as ue}from"./DangerButton-CJQg7b55.js";import{_ as me}from"./AlertModal-CyuLGaFw.js";import{_ as he}from"./Pagination-CmuQO-1Y.js";const _e=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestionar Productos",-1),ve={class:"py-12"},xe={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ge={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},fe={class:"p-6 text-gray-900"},ye={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4"},we={class:"flex flex-wrap items-center gap-3"},be=e("option",{value:""},"Todas las categorías",-1),ke=["value"],Ce=e("option",{value:""},"Todos",-1),Se=e("option",{value:"active"},"Activos",-1),Le=e("option",{value:"inactive"},"Inactivos",-1),Me=[Ce,Se,Le],Ee=e("div",{class:"hidden md:block h-6 w-px bg-gray-200"},null,-1),Pe={class:"flex items-center gap-2 border rounded-lg px-3 py-2"},ze=e("span",{class:"text-sm text-gray-600"},"Promo Global:",-1),Ne={class:"inline-flex items-center gap-1 text-sm"},Be=["checked"],Ie=["value"],Ae=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),Ve=e("span",null,"Crear",-1),$e={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},De={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},Re={class:"min-w-[900px] w-full divide-y divide-gray-200 table-auto"},Te={class:"sticky top-0 z-10 bg-gray-50"},je=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),Fe=[je],Xe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Precio",-1),He=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Cantidad",-1),Oe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Categoría",-1),We=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Activo",-1),qe=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Promoción",-1),Ue=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Acciones",-1),Ge={class:"bg-white divide-y divide-gray-200"},Ke={key:0},Ye=e("td",{colspan:"7",class:"px-3 py-3 sm:px-6 sm:py-4 text-center text-gray-500"},"No hay productos creados.",-1),Je=[Ye],Qe=["title"],Ze={key:0,class:"ml-2 inline-flex items-center rounded bg-gray-200 text-gray-700 text-xs font-semibold px-2 py-0.5"},et={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},tt={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},st={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},ot={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},at={class:"inline-flex items-center gap-1 text-sm"},nt=["checked","onChange"],rt={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},lt={class:"flex items-center gap-2"},it={class:"inline-flex items-center gap-1 text-sm"},ct=["checked","onChange"],dt=["value","onInput"],pt={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm font-medium"},ut={class:"flex items-center gap-2"},mt=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),ht=["onClick"],_t=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),vt=[_t],xt={key:0,class:"mt-6"},gt={class:"p-6"},ft=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que querés eliminar este producto? ",-1),yt=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. Se borrará el producto con todas sus variantes e imágenes. ",-1),wt={class:"mt-6 flex justify-end"},W="prod_firstcol_w_px",bt=60,kt=320,Nt={__name:"Index",props:{products:Object,categories:Array,store:Object,filters:Object},setup(c){const r=c,B=ee(),k=a(r.filters?.search||""),C=a(r.filters?.category||""),S=a(r.filters?.status||""),L=a(!1),M=a(null),x=a(!!B?.props?.flash?.success),I=a(B?.props?.flash?.success||""),q=s=>{M.value=s,L.value=!0},E=()=>{L.value=!1,M.value=null},U=()=>{p.delete(route("admin.products.destroy",M.value),{onSuccess:()=>{E(),I.value="¡Producto eliminado con éxito!",x.value=!0}})},G=s=>{p.put(route("admin.products.update",s.id),{promo_active:!s.promo_active,promo_discount_percent:s.promo_discount_percent},{preserveScroll:!0})},K=(s,o)=>{const t=Math.max(1,Math.min(90,Number(o)||0));p.put(route("admin.products.update",s.id),{promo_discount_percent:t,promo_active:!0},{preserveScroll:!0})},Y=()=>{p.put(route("admin.products.store_promo"),{promo_active:!r.store.promo_active,promo_discount_percent:r.store.promo_discount_percent},{preserveScroll:!0})},J=s=>{const o=Math.max(1,Math.min(90,Number(s)||0));p.put(route("admin.products.store_promo"),{promo_active:!0,promo_discount_percent:o},{preserveScroll:!0})},P=()=>{p.get(route("admin.products.index"),{search:k.value,category:C.value,status:S.value},{preserveState:!0,replace:!0,preserveScroll:!0})},g=a(null),A=a(!1),V=a(!1),_=()=>{const s=g.value;if(!s)return;const o=s.scrollWidth-s.clientWidth,t=s.scrollLeft||0;A.value=t>0,V.value=t<o-1};te(()=>{se(()=>_()),g.value?.addEventListener("scroll",_,{passive:!0}),window.addEventListener("resize",_)}),oe(()=>{g.value?.removeEventListener("scroll",_),window.removeEventListener("resize",_)});const u=a(Number(localStorage.getItem(W))||180),$=ae(()=>({width:u.value+"px",minWidth:u.value+"px",maxWidth:u.value+"px"}));let D=0,R=0;const f=s=>{const o=s.touches?s.touches[0].clientX:s.clientX,t=Math.max(bt,Math.min(kt,R+(o-D)));u.value=t},y=()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",f),document.removeEventListener("touchend",y);try{localStorage.setItem(W,String(u.value))}catch{}},T=s=>{D=s.touches?s.touches[0].clientX:s.clientX,R=u.value,document.addEventListener("mousemove",f,{passive:!1}),document.addEventListener("mouseup",y),document.addEventListener("touchmove",f,{passive:!1}),document.addEventListener("touchend",y)},Q=s=>s.variant_options&&s.variant_options.length>0?s.variants_sum_stock??0:s.quantity;return(s,o)=>(i(),l(N,null,[n(b(ne),{title:"Gestionar Productos"}),n(ce,null,{header:d(()=>[_e]),default:d(()=>[e("div",ve,[e("div",xe,[e("div",ge,[e("div",fe,[e("div",ye,[e("div",we,[v(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),onInput:P,placeholder:"Buscar productos...",class:"border rounded px-3 py-2 text-sm h-10"},null,544),[[re,k.value]]),v(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>C.value=t),onChange:P,class:"border rounded px-2 py-2 text-sm h-10 min-w-[170px] max-w-[220px]"},[be,(i(!0),l(N,null,j(r.categories,t=>(i(),l("option",{key:t.id,value:t.id},m(t.name),9,ke))),128))],544),[[F,C.value]]),v(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>S.value=t),onChange:P,class:"border rounded px-2 py-2 text-sm h-10 min-w-[150px]"},Me,544),[[F,S.value]]),Ee,e("div",Pe,[ze,e("label",Ne,[e("input",{type:"checkbox",checked:r.store.promo_active,onChange:Y,class:"rounded border-gray-300"},null,40,Be),h(" Activa ")]),e("input",{type:"number",min:"1",max:"90",value:r.store.promo_discount_percent??"",onInput:o[3]||(o[3]=t=>J(t.target.value)),placeholder:"%",class:"w-16 text-sm border rounded px-1 py-0.5"},null,40,Ie)]),n(b(X),{href:s.route("admin.products.create"),class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},{default:d(()=>[Ae,Ve]),_:1},8,["href"])])]),e("div",{ref_key:"scrollBoxRef",ref:g,class:"relative overflow-x-auto"},[v(e("div",$e,null,512),[[H,A.value]]),v(e("div",De,null,512),[[H,V.value]]),e("table",Re,[e("thead",Te,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:O($.value)},[h(" Nombre "),e("div",{onMousedown:T,onTouchstart:le(T,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},Fe,32)],4),Xe,He,Oe,We,qe,Ue])]),e("tbody",Ge,[!c.products.data||c.products.data.length===0?(i(),l("tr",Ke,Je)):z("",!0),(i(!0),l(N,null,j(c.products.data,(t,Z)=>(i(),l("tr",{key:t.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:ie(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r truncate",Z%2===1?"bg-gray-100":"bg-white"]),style:O($.value),title:t.name},[e("span",null,m(t.name),1),t.is_active?z("",!0):(i(),l("span",Ze,"Inactivo"))],14,Qe),e("td",et,"$ "+m(Number(t.price).toLocaleString("es-CO")),1),e("td",tt,m(Q(t)),1),e("td",st,m(t.category?t.category.name:"Sin Categoría"),1),e("td",ot,[e("label",at,[e("input",{type:"checkbox",checked:t.is_active,onChange:w=>b(p).put(s.route("admin.products.update",t.id),{is_active:!t.is_active},{preserveScroll:!0}),class:"rounded border-gray-300"},null,40,nt),h(" "+m(t.is_active?"Sí":"No"),1)])]),e("td",rt,[e("div",lt,[e("label",it,[e("input",{type:"checkbox",checked:t.promo_active,onChange:w=>G(t),class:"rounded border-gray-300"},null,40,ct),h(" Activa ")]),e("input",{type:"number",min:"1",max:"90",value:t.promo_discount_percent??"",onInput:w=>K(t,w.target.value),placeholder:"%",class:"w-16 text-sm border rounded px-1 py-0.5"},null,40,dt)])]),e("td",pt,[e("div",ut,[n(b(X),{href:s.route("admin.products.edit",t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:d(()=>[mt]),_:2},1032,["href"]),e("button",{onClick:w=>q(t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},vt,8,ht)])])]))),128))])])],512),c.products&&c.products.links?(i(),l("div",xt,[n(he,{links:c.products.links},null,8,["links"])])):z("",!0)])])])])]),_:1}),n(de,{show:L.value,onClose:E},{default:d(()=>[e("div",gt,[ft,yt,e("div",wt,[n(pe,{onClick:E},{default:d(()=>[h(" Cancelar ")]),_:1}),n(ue,{class:"ms-3",onClick:U},{default:d(()=>[h(" Sí, Eliminar Producto ")]),_:1})])])]),_:1},8,["show"]),n(me,{show:x.value,type:"success",title:"Producto",message:I.value,"primary-text":"Entendido",onPrimary:o[4]||(o[4]=t=>x.value=!1),onClose:o[5]||(o[5]=t=>x.value=!1)},null,8,["show","message"])],64))}};export{Nt as default};
