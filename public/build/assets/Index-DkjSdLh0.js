const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BXq_XnCs.js","assets/app-CKmRzW96.js","assets/app-CCGVc7RG.css"])))=>i.map(i=>d[i]);
import{r as c,u as ge,c as z,D as ve,w as xe,a as l,o as n,b as _,d as h,h as ye,e as m,f as e,i as u,p as se,j as y,A as fe,q as C,F as V,n as N,t as r,g as ae,z as U,l as H,m as g,y as oe,x as be,C as we,_ as ke}from"./app-CKmRzW96.js";import{_ as Ce}from"./AuthenticatedLayout-DkZUiWl8.js";import{_ as R}from"./Modal-Cxq9Hw5h.js";import{_ as Q}from"./SecondaryButton-AKDep2uB.js";import{_ as ne}from"./PrimaryButton-CP2BjKK9.js";import{_ as $e}from"./Pagination-q8vujau3.js";import"./AlertModal-CikiHFbj.js";const De=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Ventas FÃ­sicas",-1),Me={class:"py-12"},Ve={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Fe={class:"mb-6 border-b border-gray-200"},Te={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Se={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Pe={class:"lg:col-span-2 space-y-6"},je={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ee={class:"p-6"},Be=e("h3",{class:"text-lg font-semibold mb-4"},"Buscar Productos",-1),Ne={class:"flex gap-2 mb-4"},qe={key:0,class:"mt-4 space-y-2 max-h-64 overflow-y-auto"},Ae=["onClick"],Le={class:"flex justify-between items-center"},Ie={class:"font-medium"},Oe={class:"text-sm text-gray-500"},ze={key:0,class:"text-xs text-gray-400"},Ue=["onClick"],He={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Re={class:"p-6"},Qe=e("h3",{class:"text-lg font-semibold mb-4"},"Carrito de Venta",-1),Ye={key:0,class:"text-center py-8 text-gray-500"},Ke={key:1,class:"space-y-3"},Ge={class:"flex-1"},We={class:"font-medium"},Je={key:0,class:"text-sm text-gray-500"},Xe={class:"flex items-center gap-2"},Ze={key:0,class:"text-sm text-gray-400 line-through"},et={class:"text-sm text-gray-600 font-medium"},tt={key:0,class:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded font-medium"},st={class:"flex items-center gap-2"},at=["onClick"],ot={class:"w-12 text-center"},nt=["onClick"],rt={class:"w-20 text-right font-medium"},lt=["onClick"],it={key:2,class:"mt-6 pt-4 border-t space-y-2"},dt={class:"flex justify-between"},ct=e("span",null,"Subtotal:",-1),ut={class:"flex justify-between"},pt=e("span",null,"Descuento:",-1),mt=["max"],_t={class:"flex justify-between text-lg font-bold pt-2 border-t"},ht=e("span",null,"Total:",-1),gt={class:"lg:col-span-1"},vt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},xt={class:"p-6"},yt={class:"flex items-center justify-between mb-4"},ft=e("h3",{class:"text-lg font-semibold"},"Ventas Recientes",-1),bt=["title"],wt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-600"},kt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),Ct=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),$t=[kt,Ct],Dt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-600"},Mt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228L3 3m6.772 6.772L21 21m-3.228-3.228L21 21m-6.772-6.772L3 3"},null,-1),Vt=[Mt],Ft={class:"mb-4"},Tt={key:0,class:"text-center py-8 text-gray-500"},St={key:1,class:"text-center py-8 text-gray-500"},Pt={key:2,class:"space-y-3 max-h-96 overflow-y-auto"},jt=["onClick"],Et={class:"flex justify-between items-start"},Bt={class:"font-medium text-sm"},Nt={class:"text-xs text-gray-500"},qt={class:"font-semibold text-green-600"},At={key:1},Lt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},It={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ot={class:"p-6"},zt=e("h3",{class:"text-sm font-medium text-gray-500 uppercase tracking-wider"},"Ventas Totales",-1),Ut={class:"mt-1 text-3xl font-semibold text-gray-900"},Ht={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Rt={class:"p-6"},Qt=e("h3",{class:"text-sm font-medium text-gray-500 uppercase tracking-wider"},"Total de Ventas",-1),Yt={class:"mt-1 text-3xl font-semibold text-gray-900"},Kt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},Gt={class:"p-6"},Wt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end"},Jt=e("label",{for:"search_sale",class:"block text-sm font-medium text-gray-700"},"Buscar por nÃºmero",-1),Xt=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Desde",-1),Zt=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"Hasta",-1),es={class:"flex space-x-2"},ts=["disabled"],ss={class:"mt-4 flex flex-wrap gap-2"},as=e("span",{class:"text-sm text-gray-500 mr-2 self-center"},"Rangos rÃ¡pidos:",-1),os={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ns={class:"p-6"},rs={class:"flex justify-between items-center mb-4"},ls=e("h3",{class:"text-lg font-semibold"},"Historial de Ventas",-1),is=["href"],ds=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{d:"M7 10a1 1 0 011-1h2V4a1 1 0 112 0v5h2a1 1 0 01.7 1.714l-3 3a1 1 0 01-1.4 0l-3-3A1 1 0 017 10z"}),e("path",{d:"M5 15a1 1 0 011 1v2a2 2 0 002 2h8a2 2 0 002-2v-2a1 1 0 112 0v2a4 4 0 01-4 4H8a4 4 0 01-4-4v-2a1 1 0 011-1z"})],-1),cs={class:"overflow-x-auto"},us={class:"min-w-full divide-y divide-gray-200"},ps=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"NÃºmero"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Vendedor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Fecha"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"MÃ©todo de Pago"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Subtotal"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Descuento"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones")])],-1),ms={class:"bg-white divide-y divide-gray-200"},_s={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600"},hs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},gs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},vs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize"},xs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ys={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},fs={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},bs={class:"px-6 py-4 whitespace-nowrap text-sm"},ws={key:0},ks=e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," No hay ventas para mostrar en este perÃ­odo. ",-1),Cs=[ks],$s={class:"p-6"},Ds=e("h2",{class:"text-lg font-semibold mb-4"},"Confirmar Venta",-1),Ms={class:"mb-4"},Vs=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"MÃ©todo de Pago",-1),Fs=e("option",{value:"efectivo"},"Efectivo",-1),Ts=e("option",{value:"tarjeta"},"Tarjeta",-1),Ss=e("option",{value:"transferencia"},"Transferencia",-1),Ps=e("option",{value:"mixto"},"Mixto",-1),js=[Fs,Ts,Ss,Ps],Es={class:"mb-4"},Bs=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas (Opcional)",-1),Ns={key:0,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded"},qs=e("h4",{class:"text-sm font-semibold text-green-800 mb-2"},"Descuentos por Producto:",-1),As={class:"space-y-1"},Ls={class:"text-green-700"},Is={class:"text-green-700 font-medium"},Os={class:"mb-4 p-3 bg-gray-50 rounded"},zs={class:"flex justify-between mb-2"},Us=e("span",null,"Subtotal:",-1),Hs={key:0,class:"flex justify-between mb-2 text-red-600"},Rs=e("span",null,"Descuento manual:",-1),Qs={class:"flex justify-between font-bold text-lg pt-2 border-t"},Ys=e("span",null,"Total:",-1),Ks={class:"flex gap-3"},Gs={class:"p-6"},Ws=e("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"Â¡Venta registrada exitosamente!",-1),Js={key:0,class:"mb-4"},Xs={class:"text-sm text-gray-600 mb-2"},Zs={class:"font-semibold"},ea={class:"text-sm text-gray-600 mb-2"},ta={class:"font-semibold"},sa={class:"flex gap-3"},aa={class:"p-6"},oa=e("h2",{class:"text-lg font-semibold mb-4"},"Escanear CÃ³digo de Barras",-1),na=e("p",{class:"text-sm text-gray-600 mb-4"}," Apunta la cÃ¡mara hacia el cÃ³digo de barras. El producto se agregarÃ¡ automÃ¡ticamente al carrito. ",-1),ra=e("div",{id:"barcode-scanner-sales",class:"w-full rounded-lg overflow-hidden",style:{"min-height":"300px"}},null,-1),_a={__name:"Index",props:{sales:Object,stats:Object,filters:Object},setup(f){const i=f,$=c("sales"),v=ge({start_date:i.filters?.start_date||"",end_date:i.filters?.end_date||"",search:i.filters?.search||""}),F=c(""),T=c(!1),D=c(null),q=c(!1),Y=()=>{v.get(route("admin.physical-sales.index"),{preserveState:!0,preserveScroll:!0})},K=a=>{const s=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0");return`${s}-${t}-${o}`},re=()=>{const a=new Date;return new Date(a.getFullYear(),a.getMonth(),a.getDate())},S=a=>{const s=re();let t,o;switch(a){case"today":t=s,o=s;break;case"last7":t=new Date(s),t.setDate(t.getDate()-6),o=s;break;case"last30":t=new Date(s),t.setDate(t.getDate()-29),o=s;break;case"thisMonth":t=new Date(s.getFullYear(),s.getMonth(),1),o=new Date(s.getFullYear(),s.getMonth()+1,0);break;case"lastMonth":t=new Date(s.getFullYear(),s.getMonth()-1,1),o=new Date(s.getFullYear(),s.getMonth(),0);break;default:return}v.start_date=K(t),v.end_date=K(o),Y()},M=a=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(a),le=a=>new Date(a).toLocaleString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ie=a=>{a&&U.visit(route("admin.physical-sales.show",a.id)+"?print=true")},G=z(()=>{if(!i.sales||!i.sales.data)return[];const a=new Date;a.setHours(0,0,0,0);const s=new Date(a);s.setHours(23,59,59,999);let t=i.sales.data.filter(o=>{const d=new Date(o.created_at);return d>=a&&d<=s});if(F.value.trim()){const o=F.value.toLowerCase();t=t.filter(d=>d.sale_number.toLowerCase().includes(o))}return t}),de=a=>T.value?"***":`$${parseFloat(a).toFixed(2)}`,p=c([]),x=c(""),b=c([]),W=c(!1),P=c(!1),ce=c(""),j=c(!1),A=c("efectivo"),L=c(""),w=c(0),k=c(null),J=()=>{try{const a=new(window.AudioContext||window.webkitAudioContext),s=a.createOscillator(),t=a.createGain();s.connect(t),t.connect(a.destination),s.frequency.value=800,s.type="sine",t.gain.setValueAtTime(.3,a.currentTime),t.gain.exponentialRampToValueAtTime(.01,a.currentTime+.2),s.start(a.currentTime),s.stop(a.currentTime+.2)}catch{}},E=z(()=>p.value.reduce((a,s)=>a+s.quantity*s.unit_price,0)),I=z(()=>E.value-w.value),X=async()=>{if(!x.value.trim()){b.value=[];return}W.value=!0;try{const a=await window.axios.get(route("admin.physical-sales.search-products"),{params:{q:x.value}});b.value=a.data?.products||[]}catch{b.value=[]}finally{W.value=!1}},Z=async a=>{const s=a.replace(/\s+/g,"").trim();if(s)try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});t.data?.product?(O(t.data.product),ce.value=""):alert("Producto no encontrado con ese cÃ³digo de barras")}catch{alert("Error al buscar producto")}},ue=(a,s=null)=>{const t=s?.price??a.price;let o=parseFloat(t),d=0;return a.promo_active&&a.promo_discount_percent>0&&(d=parseFloat(a.promo_discount_percent),o=Math.round(o*(100-d)/100)),{originalPrice:parseFloat(t),finalPrice:o,discountPercent:d}},O=(a,s=null)=>{const t=p.value.find(o=>o.product_id===a.id&&o.variant_id===(s?.id||null));if(t)t.quantity+=1;else{const o=ue(a,s);p.value.push({product_id:a.id,product_name:a.name,variant_id:s?.id||null,variant_options:s?.options||null,quantity:1,unit_price:o.finalPrice,original_price:o.originalPrice,discount_percent:o.discountPercent,product:a,variant:s})}x.value="",b.value=[]},pe=a=>{p.value.splice(a,1)},ee=(a,s)=>{const t=p.value[a],o=t.quantity+s;o>0&&(t.quantity=o)},me=async()=>{try{P.value=!0,await we();const{Html5Qrcode:a}=await ke(async()=>{const{Html5Qrcode:o}=await import("./index-BXq_XnCs.js");return{Html5Qrcode:o}},__vite__mapDeps([0,1,2])),s=document.getElementById("barcode-scanner-sales");if(!s)return;k.value=new a(s.id);const t={fps:10,qrbox:{width:250,height:250}};try{await k.value.start({facingMode:"environment"},t,async o=>{J(),await Z(o),B()},o=>{})}catch{try{await k.value.start({facingMode:"user"},t,async d=>{J(),await Z(d),B()},d=>{})}catch{alert("No se pudo acceder a la cÃ¡mara. Por favor, permite el acceso a la cÃ¡mara en la configuraciÃ³n del navegador."),P.value=!1}}}catch{alert("Error al inicializar el escÃ¡ner. Por favor, intenta nuevamente."),P.value=!1}},B=async()=>{if(k.value){try{await k.value.stop(),await k.value.clear()}catch{}k.value=null}P.value=!1},_e=async()=>{if(p.value.length===0){alert("El carrito estÃ¡ vacÃ­o");return}const a={items:p.value.map(s=>({product_id:s.product_id,variant_id:s.variant_id,quantity:s.quantity,unit_price:s.unit_price})),subtotal:E.value,tax:0,discount:w.value,total:I.value,payment_method:A.value,notes:L.value};try{if(!window.axios){alert("Error: No se pudo inicializar la conexiÃ³n. Por favor, recarga la pÃ¡gina.");return}const s=await window.axios.post(route("admin.physical-sales.store"),a);s.data&&s.data.success?(D.value=s.data.sale,j.value=!1,p.value=[],x.value="",w.value=0,L.value="",A.value="efectivo",q.value=!0,U.reload()):alert("Error: "+(s.data?.message||"No se pudo procesar la venta"))}catch(s){let t="Error al procesar la venta";s.response?s.response.status===419?t="La sesiÃ³n ha expirado. Por favor, recarga la pÃ¡gina e intenta nuevamente.":s.response.status===422?t=s.response.data?.message||"Error de validaciÃ³n. Verifica los datos e intenta nuevamente.":s.response.data?.message&&(t=s.response.data.message):s.request&&(t="No se pudo conectar con el servidor. Verifica tu conexiÃ³n."),alert(t)}};ve(()=>{B()});let te;return xe(x,()=>{clearTimeout(te),te=setTimeout(()=>{x.value.trim().length>=2?X():b.value=[]},300)}),(a,s)=>(n(),l(V,null,[_(h(ye),{title:"Ventas FÃ­sicas"}),_(Ce,null,{header:m(()=>[De]),default:m(()=>[e("div",Me,[e("div",Ve,[e("div",Fe,[e("nav",Te,[e("button",{onClick:s[0]||(s[0]=t=>$.value="sales"),class:se([$.value==="sales"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Ventas ",2),e("button",{onClick:s[1]||(s[1]=t=>$.value="reports"),class:se([$.value==="reports"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Reportes ",2)])]),$.value==="sales"?(n(),l("div",Se,[e("div",Pe,[e("div",je,[e("div",Ee,[Be,e("div",Ne,[y(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>x.value=t),type:"text",placeholder:"Buscar por nombre, ID o cÃ³digo de barras...",class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onKeyup:fe(X,["enter"])},null,544),[[C,x.value]]),e("button",{onClick:me,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," ðŸ“· Escanear ")]),b.value.length>0?(n(),l("div",qe,[(n(!0),l(V,null,N(b.value,t=>(n(),l("div",{key:t.id,class:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer",onClick:o=>O(t)},[e("div",Le,[e("div",null,[e("p",Ie,r(t.name),1),e("p",Oe,"$"+r(t.price),1),t.barcode?(n(),l("p",ze,"CÃ³digo: "+r(t.barcode),1)):u("",!0)]),e("button",{onClick:ae(o=>O(t),["stop"]),class:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700"}," Agregar ",8,Ue)])],8,Ae))),128))])):u("",!0)])]),e("div",He,[e("div",Re,[Qe,p.value.length===0?(n(),l("div",Ye," El carrito estÃ¡ vacÃ­o ")):(n(),l("div",Ke,[(n(!0),l(V,null,N(p.value,(t,o)=>(n(),l("div",{key:o,class:"flex items-center justify-between p-3 border rounded-md"},[e("div",Ge,[e("p",We,r(t.product_name),1),t.variant_options?(n(),l("p",Je,r(Object.entries(t.variant_options).map(([d,he])=>`${d}: ${he}`).join(", ")),1)):u("",!0),e("div",Xe,[e("div",null,[t.original_price&&t.original_price>t.unit_price?(n(),l("p",Ze," $"+r(t.original_price.toFixed(2)),1)):u("",!0),e("p",et," $"+r(t.unit_price.toFixed(2))+" c/u ",1)]),t.discount_percent>0?(n(),l("span",tt," -"+r(t.discount_percent)+"% ",1)):u("",!0)])]),e("div",st,[e("button",{onClick:d=>ee(o,-1),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"}," - ",8,at),e("span",ot,r(t.quantity),1),e("button",{onClick:d=>ee(o,1),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"}," + ",8,nt),e("span",rt," $"+r((t.quantity*t.unit_price).toFixed(2)),1),e("button",{onClick:d=>pe(o),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700"}," Ã— ",8,lt)])]))),128))])),p.value.length>0?(n(),l("div",it,[e("div",dt,[ct,e("span",null,"$"+r(E.value.toFixed(2)),1)]),e("div",ut,[pt,y(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>w.value=t),type:"number",step:"0.01",min:"0",max:E.value,class:"w-24 text-right border rounded px-2"},null,8,mt),[[C,w.value,void 0,{number:!0}]])]),e("div",_t,[ht,e("span",null,"$"+r(I.value.toFixed(2)),1)]),e("button",{onClick:s[4]||(s[4]=t=>j.value=!0),class:"w-full mt-4 px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-semibold"}," Procesar Venta ")])):u("",!0)])])]),e("div",gt,[e("div",vt,[e("div",xt,[e("div",yt,[ft,e("button",{onClick:s[5]||(s[5]=t=>T.value=!T.value),class:"p-2 rounded-md hover:bg-gray-100 transition-colors",title:T.value?"Mostrar valores":"Ocultar valores"},[T.value?(n(),l("svg",Dt,Vt)):(n(),l("svg",wt,$t))],8,bt)]),e("div",Ft,[y(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>F.value=t),type:"text",placeholder:"Buscar por nÃºmero de venta...",class:"w-full rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[C,F.value]])]),!i.sales||!i.sales.data||i.sales.data.length===0?(n(),l("div",Tt," No hay ventas registradas ")):G.value.length===0?(n(),l("div",St,r(F.value.trim()?"No se encontraron ventas con ese nÃºmero":"No hay ventas del dÃ­a de hoy"),1)):(n(),l("div",Pt,[(n(!0),l(V,null,N(G.value,t=>(n(),l("div",{key:t.id,class:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer",onClick:o=>h(U).get(a.route("admin.physical-sales.show",t.id))},[e("div",Et,[e("div",null,[e("p",Bt,"#"+r(t.sale_number),1),e("p",Nt,r(new Date(t.created_at).toLocaleString()),1)]),e("p",qt,r(de(t.total)),1)])],8,jt))),128))]))])])])])):u("",!0),$.value==="reports"?(n(),l("div",At,[e("div",Lt,[e("div",It,[e("div",Ot,[zt,e("p",Ut,r(f.stats?M(f.stats.totalSales||0):"$0"),1)])]),e("div",Ht,[e("div",Rt,[Qt,e("p",Yt,r(f.stats&&f.stats.totalCount||0),1)])])]),e("div",Kt,[e("div",Gt,[e("form",{onSubmit:ae(Y,["prevent"])},[e("div",Wt,[e("div",null,[Jt,y(e("input",{type:"text",id:"search_sale","onUpdate:modelValue":s[7]||(s[7]=t=>h(v).search=t),placeholder:"Ej: V-000001",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[C,h(v).search]])]),e("div",null,[Xt,y(e("input",{type:"date",id:"start_date","onUpdate:modelValue":s[8]||(s[8]=t=>h(v).start_date=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[C,h(v).start_date]])]),e("div",null,[Zt,y(e("input",{type:"date",id:"end_date","onUpdate:modelValue":s[9]||(s[9]=t=>h(v).end_date=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[C,h(v).end_date]])]),e("div",es,[e("button",{type:"submit",disabled:h(v).processing,class:"w-full bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Filtrar ",8,ts),_(h(H),{href:a.route("admin.physical-sales.index"),class:"w-full bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400 text-center"},{default:m(()=>[g(" Limpiar ")]),_:1},8,["href"])])]),e("div",ss,[as,e("button",{type:"button",onClick:s[10]||(s[10]=t=>S("today")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Hoy"),e("button",{type:"button",onClick:s[11]||(s[11]=t=>S("last7")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Ãšltimos 7 dÃ­as"),e("button",{type:"button",onClick:s[12]||(s[12]=t=>S("last30")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Ãšltimos 30 dÃ­as"),e("button",{type:"button",onClick:s[13]||(s[13]=t=>S("thisMonth")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Este mes"),e("button",{type:"button",onClick:s[14]||(s[14]=t=>S("lastMonth")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Mes pasado")])],32)])]),e("div",os,[e("div",ns,[e("div",rs,[ls,i.sales&&i.sales.data&&i.sales.data.length>0?(n(),l("a",{key:0,href:a.route("admin.physical-sales.export",{start_date:f.filters?.start_date,end_date:f.filters?.end_date}),class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition"},[ds,g(" Exportar a Excel ")],8,is)):u("",!0)]),e("div",cs,[e("table",us,[ps,e("tbody",ms,[(n(!0),l(V,null,N(i.sales.data,t=>(n(),l("tr",{key:t.id},[e("td",_s,[_(h(H),{href:a.route("admin.physical-sales.show",t.id),class:"hover:underline"},{default:m(()=>[g(r(t.sale_number),1)]),_:2},1032,["href"])]),e("td",hs,r(t.user?.name||"N/A"),1),e("td",gs,r(le(t.created_at)),1),e("td",vs,r(t.payment_method),1),e("td",xs,r(M(t.subtotal)),1),e("td",ys,r(M(t.discount)),1),e("td",fs,r(M(t.total)),1),e("td",bs,[_(h(H),{href:a.route("admin.physical-sales.show",t.id),class:"text-blue-600 hover:text-blue-900"},{default:m(()=>[g(" Ver ")]),_:2},1032,["href"])])]))),128)),!i.sales||!i.sales.data||i.sales.data.length===0?(n(),l("tr",ws,Cs)):u("",!0)])])]),i.sales&&i.sales.links?(n(),oe($e,{key:0,class:"mt-6",links:i.sales.links},null,8,["links"])):u("",!0)])])])):u("",!0)])]),_(R,{show:j.value,onClose:s[18]||(s[18]=t=>j.value=!1)},{default:m(()=>[e("div",$s,[Ds,e("div",Ms,[Vs,y(e("select",{"onUpdate:modelValue":s[15]||(s[15]=t=>A.value=t),class:"w-full rounded-md border-gray-300"},js,512),[[be,A.value]])]),e("div",Es,[Bs,y(e("textarea",{"onUpdate:modelValue":s[16]||(s[16]=t=>L.value=t),class:"w-full rounded-md border-gray-300",rows:"3",placeholder:"Notas adicionales sobre la venta..."},null,512),[[C,L.value]])]),p.value.some(t=>t.discount_percent>0)?(n(),l("div",Ns,[qs,e("div",As,[(n(!0),l(V,null,N(p.value.filter(t=>t.discount_percent>0),(t,o)=>(n(),l("div",{key:o,class:"flex justify-between text-sm"},[e("span",Ls,r(t.product_name)+":",1),e("span",Is,"-"+r(t.discount_percent)+"% ("+r(M((t.original_price-t.unit_price)*t.quantity))+")",1)]))),128))])])):u("",!0),e("div",Os,[e("div",zs,[Us,e("span",null,"$"+r(E.value.toFixed(2)),1)]),w.value>0?(n(),l("div",Hs,[Rs,e("span",null,"-$"+r((w.value||0).toFixed(2)),1)])):u("",!0),e("div",Qs,[Ys,e("span",null,"$"+r(I.value.toFixed(2)),1)])]),e("div",Ks,[_(Q,{onClick:s[17]||(s[17]=t=>j.value=!1)},{default:m(()=>[g("Cancelar")]),_:1}),_(ne,{onClick:_e},{default:m(()=>[g("Confirmar Venta")]),_:1})])])]),_:1},8,["show"]),_(R,{show:q.value,onClose:s[21]||(s[21]=t=>q.value=!1)},{default:m(()=>[e("div",Gs,[Ws,D.value?(n(),l("div",Js,[e("p",Xs,[g(" NÃºmero de venta: "),e("span",Zs,"#"+r(D.value.sale_number),1)]),e("p",ea,[g(" Total: "),e("span",ta,r(M(D.value.total)),1)])])):u("",!0),e("div",sa,[_(Q,{onClick:s[19]||(s[19]=t=>q.value=!1)},{default:m(()=>[g("Cerrar")]),_:1}),D.value?(n(),oe(ne,{key:0,onClick:s[20]||(s[20]=t=>ie(D.value))},{default:m(()=>[g(" ðŸ–¨ï¸ Imprimir Factura ")]),_:1})):u("",!0)])])]),_:1},8,["show"]),_(R,{show:P.value,onClose:B},{default:m(()=>[e("div",aa,[oa,na,ra,_(Q,{onClick:B,class:"mt-4"},{default:m(()=>[g("Cerrar")]),_:1})])]),_:1},8,["show"])]),_:1})],64))}};export{_a as default};
