import{r as v,c as V,p as $,q as x,a as d,o as i,b as l,u as p,h as B,d as u,e,F as y,i as w,f as M,t as s,m as f,n as j,s as P,g as q,x as z,l as L,j as F}from"./app-DdN1dnwv.js";import{_ as T}from"./AuthenticatedLayout-0XqtQlBh.js";import{_ as I}from"./AlertModal-CWL83k3D.js";import"./DropdownLink-DQGx_2Xf.js";import"./Modal-uE4VJq8H.js";const A={class:"flex items-center space-x-4"},R={class:"font-semibold text-xl text-gray-800 leading-tight"},U={class:"py-12"},G={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-8"},H={class:"lg:col-span-2 space-y-8"},J={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},K={class:"p-6"},Q={class:"divide-y divide-gray-200"},W={class:"flex-grow"},X={class:"font-bold text-gray-900"},Y={key:0,class:"text-sm text-gray-600 mt-1"},Z={class:"font-semibold"},ee={class:"text-sm text-gray-500 mt-2"},te={class:"font-semibold text-gray-800 shrink-0 ml-4"},se={class:"border-t border-gray-200 pt-4 mt-4 text-right"},oe={class:"text-2xl font-bold"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},re={class:"p-6"},le={class:"mt-4 space-y-4 text-gray-700"},ne={class:"space-y-8"},de={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ie={class:"p-6"},ue={class:"text-center mb-4"},ce={class:"text-sm text-center text-gray-500"},me={class:"mt-6 border-t pt-6"},pe=["disabled"],ge={class:"p-6"},be={class:"mt-6 flex justify-end"},_e={__name:"Show",props:{order:Object},setup(a){const n=v(!1),g=v(""),b=v(""),c=a,C=o=>{const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(o).toLocaleDateString("es-CO",t)},h=V(()=>({recibido:{text:"Recibido",class:"bg-yellow-100 text-yellow-800"},en_preparacion:{text:"En Preparación",class:"bg-blue-100 text-blue-800"},despachado:{text:"Despachado",class:"bg-purple-100 text-purple-800"},entregado:{text:"Entregado",class:"bg-green-100 text-green-800"},cancelado:{text:"Cancelado",class:"bg-red-100 text-red-800"}})[c.order.status]||{text:c.order.status,class:"bg-gray-100 text-gray-800"}),m=$({status:c.order.status}),S=()=>{const o=m.status;m.put(route("admin.orders.update",c.order.id),{preserveScroll:!0,onSuccess:()=>{g.value="Estado actualizado",b.value="El estado de la orden se guardó correctamente.",n.value=!0,(o==="despachado"||o==="entregado")&&E()}})},E=()=>{F.post(route("admin.orders.confirm",c.order.id),{},{preserveScroll:!0,onSuccess:()=>{g.value="Venta confirmada",b.value="Inventario actualizado correctamente.",n.value=!0},onError:o=>{g.value="Error al confirmar",b.value=Object.values(o).join(`
`),n.value=!0}})};return(o,t)=>{const k=x("SecondaryButton"),D=x("DangerButton"),O=x("Modal");return i(),d(y,null,[l(p(B),{title:`Orden #${a.order.sequence_number??a.order.id}`},null,8,["title"]),l(T,null,{header:u(()=>[e("div",A,[l(p(L),{href:o.route("admin.orders.index"),class:"text-blue-600 hover:text-blue-800"},{default:u(()=>[...t[3]||(t[3]=[f(" ← Volver a Órdenes ",-1)])]),_:1},8,["href"]),e("h2",R," Detalle de la Orden #"+s(a.order.sequence_number??a.order.id),1)])]),default:u(()=>[e("div",U,[e("div",G,[e("div",H,[e("div",J,[e("div",K,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Productos en la Orden",-1)),e("div",Q,[(i(!0),d(y,null,w(a.order.items,r=>(i(),d("div",{key:r.id,class:"py-4 flex justify-between items-start"},[e("div",W,[e("p",X,s(r.product_name),1),r.variant_options?(i(),d("div",Y,[(i(!0),d(y,null,w(r.variant_options,(N,_)=>(i(),d("span",{key:_,class:"mr-2 bg-gray-100 px-2 py-1 rounded"},[e("span",Z,s(_)+":",1),f(" "+s(N),1)]))),128))])):M("",!0),e("p",ee,s(r.quantity)+" x $ "+s(Number(r.unit_price).toLocaleString("es-CO")),1)]),e("p",te,"$ "+s(Number(r.unit_price*r.quantity).toLocaleString("es-CO")),1)]))),128))]),e("div",se,[e("p",oe,"Total: $ "+s(Number(a.order.total_price).toLocaleString("es-CO")),1)])])]),e("div",ae,[e("div",re,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Datos del Cliente",-1)),e("div",le,[e("div",null,[t[5]||(t[5]=e("p",{class:"font-semibold text-sm text-gray-500"},"Nombre:",-1)),e("p",null,s(a.order.customer_name),1)]),e("div",null,[t[6]||(t[6]=e("p",{class:"font-semibold text-sm text-gray-500"},"Teléfono:",-1)),e("p",null,s(a.order.customer_phone),1)]),e("div",null,[t[7]||(t[7]=e("p",{class:"font-semibold text-sm text-gray-500"},"Correo:",-1)),e("p",null,s(a.order.customer_email),1)]),e("div",null,[t[8]||(t[8]=e("p",{class:"font-semibold text-sm text-gray-500"},"Dirección:",-1)),e("p",null,s(a.order.customer_address),1)])])])])]),e("div",ne,[e("div",de,[e("div",ie,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold mb-4"},"Estado del Pedido",-1)),e("div",ue,[e("span",{class:j(["px-4 py-2 inline-flex text-lg leading-5 font-semibold rounded-full",h.value.class])},s(h.value.text),3)]),e("p",ce," Pedido realizado el: "+s(C(a.order.created_at)),1),e("form",{onSubmit:P(S,["prevent"])},[e("div",me,[t[11]||(t[11]=e("label",{for:"status",class:"block font-medium text-sm text-gray-700 mb-2"},"Cambiar Estado",-1)),q(e("select",{id:"status","onUpdate:modelValue":t[0]||(t[0]=r=>p(m).status=r),class:"block w-full rounded-md shadow-sm border-gray-300"},[...t[10]||(t[10]=[e("option",{value:"recibido"},"Recibido",-1),e("option",{value:"en_preparacion"},"En Preparación",-1),e("option",{value:"despachado"},"Despachado",-1),e("option",{value:"entregado"},"Entregado",-1),e("option",{value:"cancelado"},"Cancelado",-1)])],512),[[z,p(m).status]]),e("button",{type:"submit",disabled:p(m).processing,class:"mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Actualizar Estado ",8,pe)])],32)])])])])])]),_:1}),l(O,{show:o.confirmingSale,onClose:o.closeSaleModal},{default:u(()=>[e("div",ge,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Confirmar venta y descontar inventario? ",-1)),t[16]||(t[16]=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. El stock de los productos en esta orden será reducido. ",-1)),e("div",be,[l(k,{onClick:o.closeSaleModal},{default:u(()=>[...t[13]||(t[13]=[f(" Cancelar ",-1)])]),_:1},8,["onClick"]),l(D,{class:"ms-3",onClick:o.confirmOrder},{default:u(()=>[...t[14]||(t[14]=[f(" Sí, Confirmar Venta ",-1)])]),_:1},8,["onClick"])])])]),_:1},8,["show","onClose"]),l(I,{show:n.value,type:"success",title:g.value,message:b.value,"primary-text":"Entendido",onPrimary:t[1]||(t[1]=r=>n.value=!1),onClose:t[2]||(t[2]=r=>n.value=!1)},null,8,["show","title","message"])],64)}}};export{_e as default};
