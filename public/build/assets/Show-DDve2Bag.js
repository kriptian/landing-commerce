import{r as v,c as O,p as k,q as N,a as d,o as n,b as c,u as m,h as $,d as b,e,F as x,i as h,f as V,t as s,m as _,n as j,s as M,g as P,x as q,l as z,j as L}from"./app-BRVkAi0d.js";import{_ as F}from"./AuthenticatedLayout-BpCRplDY.js";import{_ as T}from"./AlertModal-Kba0pXFQ.js";import"./Modal-BqEUkn8w.js";const B={class:"flex items-center space-x-4"},I={class:"font-semibold text-xl text-gray-800 leading-tight"},A={class:"py-12"},R={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-8"},U={class:"lg:col-span-2 space-y-8"},G={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},H={class:"p-6"},J={class:"divide-y divide-gray-200"},K={class:"flex-grow"},Q={class:"font-bold text-gray-900"},W={key:0,class:"text-sm text-gray-600 mt-1"},X={class:"font-semibold"},Y={class:"text-sm text-gray-500 mt-2"},Z={class:"font-semibold text-gray-800 shrink-0 ml-4"},ee={class:"border-t border-gray-200 pt-4 mt-4 text-right"},te={class:"text-2xl font-bold"},se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},oe={class:"p-6"},ae={class:"mt-4 space-y-4 text-gray-700"},le={class:"space-y-8"},re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},de={class:"p-6"},ne={class:"text-center mb-4"},ie={class:"text-sm text-center text-gray-500"},ue={class:"mt-6 border-t pt-6"},ce=["disabled"],ve={__name:"Show",props:{order:Object},setup(o){const r=v(!1),p=v(""),g=v(""),i=o,w=l=>{const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(l).toLocaleDateString("es-CO",t)},f=O(()=>({recibido:{text:"Recibido",class:"bg-yellow-100 text-yellow-800"},en_preparacion:{text:"En Preparación",class:"bg-blue-100 text-blue-800"},despachado:{text:"Despachado",class:"bg-purple-100 text-purple-800"},entregado:{text:"Entregado",class:"bg-green-100 text-green-800"},cancelado:{text:"Cancelado",class:"bg-red-100 text-red-800"}})[i.order.status]||{text:i.order.status,class:"bg-gray-100 text-gray-800"}),u=k({status:i.order.status}),C=()=>{const l=u.status;u.put(route("admin.orders.update",i.order.id),{preserveScroll:!0,onSuccess:()=>{p.value="Estado actualizado",g.value="El estado de la orden se guardó correctamente.",r.value=!0,(l==="despachado"||l==="entregado")&&S()}})},S=()=>{L.post(route("admin.orders.confirm",i.order.id),{},{preserveScroll:!0,onSuccess:()=>{p.value="Venta confirmada",g.value="Inventario actualizado correctamente.",r.value=!0},onError:l=>{p.value="Error al confirmar",g.value=Object.values(l).join(`
`),r.value=!0}})};return(l,t)=>{const E=N("Modal");return n(),d(x,null,[c(m($),{title:`Orden #${o.order.sequence_number??o.order.id}`},null,8,["title"]),c(F,null,{header:b(()=>[e("div",B,[c(m(z),{href:l.route("admin.orders.index"),class:"text-blue-600 hover:text-blue-800"},{default:b(()=>[...t[3]||(t[3]=[_(" ← Volver a Órdenes ",-1)])]),_:1},8,["href"]),e("h2",I," Detalle de la Orden #"+s(o.order.sequence_number??o.order.id),1)])]),default:b(()=>[e("div",A,[e("div",R,[e("div",U,[e("div",G,[e("div",H,[t[4]||(t[4]=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Productos en la Orden",-1)),e("div",J,[(n(!0),d(x,null,h(o.order.items,a=>(n(),d("div",{key:a.id,class:"py-4 flex justify-between items-start"},[e("div",K,[e("p",Q,s(a.product_name),1),a.variant_options?(n(),d("div",W,[(n(!0),d(x,null,h(a.variant_options,(D,y)=>(n(),d("span",{key:y,class:"mr-2 bg-gray-100 px-2 py-1 rounded"},[e("span",X,s(y)+":",1),_(" "+s(D),1)]))),128))])):V("",!0),e("p",Y,s(a.quantity)+" x $ "+s(Number(a.unit_price).toLocaleString("es-CO")),1)]),e("p",Z,"$ "+s(Number(a.unit_price*a.quantity).toLocaleString("es-CO")),1)]))),128))]),e("div",ee,[e("p",te,"Total: $ "+s(Number(o.order.total_price).toLocaleString("es-CO")),1)])])]),e("div",se,[e("div",oe,[t[9]||(t[9]=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Datos del Cliente",-1)),e("div",ae,[e("div",null,[t[5]||(t[5]=e("p",{class:"font-semibold text-sm text-gray-500"},"Nombre:",-1)),e("p",null,s(o.order.customer_name),1)]),e("div",null,[t[6]||(t[6]=e("p",{class:"font-semibold text-sm text-gray-500"},"Teléfono:",-1)),e("p",null,s(o.order.customer_phone),1)]),e("div",null,[t[7]||(t[7]=e("p",{class:"font-semibold text-sm text-gray-500"},"Correo:",-1)),e("p",null,s(o.order.customer_email),1)]),e("div",null,[t[8]||(t[8]=e("p",{class:"font-semibold text-sm text-gray-500"},"Dirección:",-1)),e("p",null,s(o.order.customer_address),1)])])])])]),e("div",le,[e("div",re,[e("div",de,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold mb-4"},"Estado del Pedido",-1)),e("div",ne,[e("span",{class:j(["px-4 py-2 inline-flex text-lg leading-5 font-semibold rounded-full",f.value.class])},s(f.value.text),3)]),e("p",ie," Pedido realizado el: "+s(w(o.order.created_at)),1),e("form",{onSubmit:M(C,["prevent"])},[e("div",ue,[t[11]||(t[11]=e("label",{for:"status",class:"block font-medium text-sm text-gray-700 mb-2"},"Cambiar Estado",-1)),P(e("select",{id:"status","onUpdate:modelValue":t[0]||(t[0]=a=>m(u).status=a),class:"block w-full rounded-md shadow-sm border-gray-300"},[...t[10]||(t[10]=[e("option",{value:"recibido"},"Recibido",-1),e("option",{value:"en_preparacion"},"En Preparación",-1),e("option",{value:"despachado"},"Despachado",-1),e("option",{value:"entregado"},"Entregado",-1),e("option",{value:"cancelado"},"Cancelado",-1)])],512),[[q,m(u).status]]),e("button",{type:"submit",disabled:m(u).processing,class:"mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Actualizar Estado ",8,ce)])],32)])])])])])]),_:1}),c(E,{show:l.confirmingSale,onClose:l.closeSaleModal},{default:b(()=>[...t[13]||(t[13]=[e("div",{class:"p-6"},[e("div",{class:"mt-6 flex justify-end"})],-1)])]),_:1},8,["show","onClose"]),c(T,{show:r.value,type:"success",title:p.value,message:g.value,"primary-text":"Entendido",onPrimary:t[1]||(t[1]=a=>r.value=!1),onClose:t[2]||(t[2]=a=>r.value=!1)},null,8,["show","title","message"])],64)}}};export{ve as default};
