const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Cx66glhu.js","assets/app-C7g-682V.js","assets/app-CA4S4Tw8.css"])))=>i.map(i=>d[i]);
import{H as je,c as H,r as u,u as mt,w as Se,B as ft,z as he,D as gt,a as l,o as a,b as g,d as $e,h as xt,e as y,i as h,f as e,s as bt,m as b,j as O,A as Pe,q as ne,p as J,F as j,n as V,t as r,g as yt,x as Ee,y as wt,C as We,_ as kt}from"./app-C7g-682V.js";import{_ as Ct}from"./AuthenticatedLayout-B8JLnoFT.js";import{d as Mt,s as Tt}from"./pdfUtils-BTHx2ArP.js";import{_ as jt}from"./AlertModal-D8VaOmQ5.js";import{_ as Y}from"./Modal-BJKt3I0d.js";import{_ as ve}from"./SecondaryButton-D1GZJkrX.js";import{_ as pe}from"./PrimaryButton-CWEd2y61.js";import St from"./ExpenseModal-trSrgcC3.js";import $t from"./VariantSelectorModal-D4erMY1V.js";import"./InputError-B08qquMY.js";const Pt={key:0,class:"font-semibold text-xl text-gray-800 leading-tight"},Et={key:0,class:"hidden lg:flex fixed inset-0 bg-white flex-row",style:{"margin-top":"0","z-index":"10"}},Dt={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},Nt={class:"flex items-center gap-3 mb-3"},Ft=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),qt=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Lt={class:"flex-1 relative"},Bt=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),Ot=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),Vt=[Ot],Rt={class:"flex items-center gap-2 overflow-x-auto"},At=["onClick"],zt={class:"flex-1 overflow-y-auto p-4"},It={key:0,class:"text-center py-12 text-gray-500"},Xt=e("p",null,"No se encontraron productos",-1),Ht=[Xt],Kt={key:1,class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Ut=["onClick"],Gt={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},Wt=["src","alt"],Qt={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Jt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),Yt=[Jt],Zt={class:"p-2 flex-1 flex flex-col"},es={class:"mb-1"},ts={class:"text-xs line-through text-red-600"},ss={class:"text-sm font-bold text-green-600"},os={key:1,class:"text-sm font-bold text-gray-900"},ns=["title"],as=e("div",{class:"h-8 w-1 bg-gray-400 rounded-full group-hover:bg-white"},null,-1),ls=[as],rs={class:"flex-1 h-full flex flex-col bg-white overflow-hidden",style:{"min-width":"300px"}},is={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},cs={class:"flex items-center gap-3"},ds=e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),us={class:"text-blue-700 font-semibold"},hs=e("span",{class:"text-blue-400"},"|",-1),vs=["src","alt"],ps={key:1,class:"text-blue-700 font-medium text-sm"},_s={class:"flex-1 overflow-y-auto px-3 py-2"},ms={key:0,class:"text-center py-12 text-gray-500"},fs=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),gs=e("p",null,"El carrito está vacío",-1),xs=[fs,gs],bs={key:1,class:"overflow-x-auto"},ys={class:"w-full text-sm"},ws=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-3 py-3 text-left text-xs font-semibold text-gray-700"},"Producto"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"},"Stock"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-20"},"Cant"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-40"},"Valor"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-32"},"Desc"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-36"},"SubTotal"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"})])],-1),ks={class:"divide-y divide-gray-200 bg-white"},Cs=["title"],Ms={class:"min-w-0",style:{"max-width":"140px"}},Ts={class:"font-medium text-gray-900"},js={key:0,class:"text-xs text-gray-500 ml-1"},Ss=["title"],$s=["title"],Ps=["value","onChange"],Es=["title"],Ds=["value","onInput"],Ns=["title"],Fs=["onClick"],qs={key:1,class:"relative"},Ls=["value","onChange","onClick"],Bs=e("span",{class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm font-medium pointer-events-none"},"%",-1),Os=["title"],Vs={class:"font-semibold text-gray-900 text-sm"},Rs={class:"px-3 py-3 text-center align-middle w-16"},As=["onClick"],zs=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Is=[zs],Xs={key:0,class:"border-t border-gray-200 px-4 py-3 bg-gray-50 space-y-3 flex-shrink-0"},Hs={class:"flex justify-between text-sm"},Ks=e("span",{class:"text-gray-700"},"Total Bruto:",-1),Us={class:"font-medium"},Gs={class:"flex justify-between text-sm items-center"},Ws=e("span",{class:"text-gray-700"},"Descuento:",-1),Qs=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),Js={class:"pt-2 border-t border-gray-300"},Ys={class:"flex justify-between items-center mb-3"},Zs=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),eo={class:"text-base font-bold text-green-600"},to={class:"flex gap-3"},so={key:1,class:"lg:hidden fixed inset-0 bg-white flex flex-col",style:{"margin-top":"0","z-index":"10"}},oo={class:"bg-blue-500 px-4 py-3 flex-shrink-0"},no={class:"flex items-center justify-between"},ao={class:"flex items-center gap-2"},lo=e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),ro={class:"text-white font-semibold"},io=e("span",{class:"text-white"},"|",-1),co=["src","alt"],uo={key:1,class:"text-white font-medium text-sm"},ho={class:"bg-gray-100 px-4 py-3 flex-shrink-0 border-b border-gray-200"},vo={class:"flex items-center gap-2"},po=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),_o=[po],mo=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),fo=[mo],go={class:"flex-1 relative"},xo=e("svg",{class:"absolute left-3 top-3 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),bo=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),yo=[bo],wo={key:0,class:"mt-3 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto"},ko=["onClick"],Co={class:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center flex-shrink-0"},Mo=["src","alt"],To={key:1,class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},jo=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),So=[jo],$o={class:"flex-1 min-w-0"},Po={class:"font-medium text-sm text-gray-900 truncate"},Eo={class:"text-xs line-through text-red-600"},Do={class:"text-xs text-green-600 font-semibold"},No={key:1,class:"text-xs text-gray-500"},Fo=e("svg",{class:"w-5 h-5 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),qo=e("div",{class:"bg-gray-200 px-4 py-2 flex-shrink-0"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-8 h-8 bg-blue-400 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})])]),e("h3",{class:"text-gray-700 font-semibold text-sm"},"INFORMACION DE LA VENTA")])],-1),Lo={class:"flex-1 overflow-y-auto bg-white"},Bo={key:0,class:"text-center py-12 text-gray-500"},Oo=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),Vo=e("p",null,"No hay productos en el carrito",-1),Ro=e("p",{class:"text-xs text-gray-400 mt-2"},"Busca o escanea un producto para comenzar",-1),Ao=[Oo,Vo,Ro],zo={key:1,class:"divide-y divide-gray-200"},Io={class:"flex items-start justify-between gap-3"},Xo={class:"flex-1 min-w-0"},Ho={class:"flex items-center gap-2 mb-1"},Ko={key:0,class:"text-xs text-red-600 font-semibold"},Uo={class:"font-medium text-sm text-gray-900 mb-1"},Go={class:"text-xs text-gray-500"},Wo={class:"flex items-center gap-3"},Qo={class:"flex flex-col items-center gap-1"},Jo=e("span",{class:"text-xs text-gray-500"},"Cant",-1),Yo={class:"flex items-center gap-1"},Zo=["onClick"],en={class:"w-10 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full font-semibold text-sm"},tn=["onClick"],sn={class:"flex flex-col items-end gap-1 min-w-[80px]"},on=e("span",{class:"text-xs text-gray-500"},"Total",-1),nn={class:"font-semibold text-sm text-gray-900"},an=["onClick"],ln=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),rn=[ln],cn=["onClick"],dn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),un=[dn],hn={key:0,class:"border-t border-gray-300 bg-white px-4 py-4 flex-shrink-0"},vn={class:"space-y-2 mb-4"},pn={class:"flex justify-between text-sm"},_n=e("span",{class:"text-gray-700"},"Subtotal:",-1),mn={class:"font-medium text-green-600"},fn={class:"flex justify-between text-sm"},gn=e("span",{class:"text-gray-700"},"Descuento:",-1),xn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),bn={class:"flex justify-between items-center pt-2 border-t border-gray-300"},yn=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),wn={class:"text-base font-bold text-green-600"},kn={class:"flex gap-3"},Cn={class:"p-6"},Mn=e("h2",{class:"text-lg font-semibold mb-4"},"Confirmar Venta",-1),Tn={class:"mb-4"},jn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Pago",-1),Sn=e("option",{value:"efectivo"},"Efectivo",-1),$n=e("option",{value:"tarjeta"},"Tarjeta",-1),Pn=e("option",{value:"transferencia"},"Transferencia",-1),En=e("option",{value:"mixto"},"Mixto",-1),Dn=[Sn,$n,Pn,En],Nn={key:0,class:"mb-4 p-4 bg-green-50 rounded-lg border border-green-100"},Fn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Dinero Recibido",-1),qn={class:"relative"},Ln=e("span",{class:"absolute left-3 top-2 text-gray-500"},"$",-1),Bn=["value"],On={key:0,class:"mt-3 flex justify-between items-center text-lg"},Vn=e("span",{class:"font-medium text-gray-700"},"Cambio a devolver:",-1),Rn={class:"font-bold text-green-700"},An={class:"mb-4"},zn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas (Opcional)",-1),In={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded"},Xn=e("h4",{class:"text-sm font-semibold text-green-800 mb-2"},"Descuentos por Producto:",-1),Hn={class:"space-y-1"},Kn={class:"text-green-700"},Un={class:"text-green-700 font-medium"},Gn={class:"mb-4 p-3 bg-gray-50 rounded"},Wn={class:"flex justify-between mb-2"},Qn=e("span",null,"Subtotal:",-1),Jn={key:0,class:"flex justify-between mb-2 text-red-600"},Yn={class:"flex justify-between font-bold text-lg pt-2 border-t"},Zn=e("span",null,"Total:",-1),ea={class:"flex gap-3"},ta={class:"p-6"},sa=e("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"¡Venta registrada exitosamente!",-1),oa={key:0,class:"mb-4"},na={class:"text-sm text-gray-600 mb-2"},aa={class:"font-semibold"},la={class:"text-sm text-gray-600 mb-2"},ra={class:"font-semibold"},ia={class:"flex gap-2 sm:gap-3 justify-center sm:justify-end"},ca=e("span",{class:"sm:hidden"},"✕",-1),da=e("span",{class:"hidden sm:inline"},"Cerrar",-1),ua=["disabled"],ha={key:0,class:"animate-pulse"},va={key:1},pa=e("span",{class:"hidden sm:inline ml-1"},"Descargar PDF",-1),_a=["disabled"],ma={key:0,class:"animate-pulse"},fa={key:1},ga=e("span",{class:"hidden sm:inline ml-1"},"Compartir",-1),xa=e("span",{class:"hidden sm:inline ml-1"},"Imprimir",-1),ba={id:"invoice-content-pos",class:"fixed top-0 left-0 w-[80mm] bg-white z-[-100] opacity-0 pointer-events-none"},ya={class:"bg-white text-black p-2 font-mono text-[11px] leading-tight",style:{width:"80mm",margin:"0 auto","font-family":"'Courier New', Courier, monospace"}},wa={class:"text-center mb-4"},ka=["src"],Ca={class:"font-bold text-base uppercase mb-1"},Ma={class:"text-[10px] space-y-0.5",style:{"font-size":"10px"}},Ta={key:0},ja={key:1,class:"whitespace-normal"},Sa={key:2,class:"whitespace-normal"},$a={key:3,class:"whitespace-normal break-words"},Pa={key:4,class:"whitespace-normal break-words"},Ea=e("div",{class:"border-b-2 border-dashed border-black my-2"},null,-1),Da={class:"mb-3 text-[10px] grid grid-cols-2 gap-x-2 gap-y-1"},Na={class:"col-span-2 text-center mb-1"},Fa={class:"text-sm font-bold"},qa={class:"text-[9px] text-gray-500"},La=e("span",{class:"font-bold block text-gray-600"},"Vendedor:",-1),Ba={class:"text-right"},Oa=e("span",{class:"font-bold block text-gray-600"},"Método de Pago:",-1),Va={class:"capitalize"},Ra={key:0,class:"col-span-2 mt-1 border-t border-dotted border-gray-300 pt-1"},Aa=e("span",{class:"font-bold text-gray-600"},"Cliente:",-1),za={key:0},Ia=e("span",{class:"font-bold text-gray-600"},"NIT/CC:",-1),Xa=e("div",{class:"border-b border-black my-2"},null,-1),Ha={class:"mb-4"},Ka=e("div",{class:"flex justify-between text-[9px] font-bold mb-2 uppercase text-gray-800"},[e("span",null,"Descripción"),e("span",null,"Total")],-1),Ua={class:"font-bold text-[11px] leading-tight mb-0.5"},Ga={key:0,class:"text-[9px] text-gray-500 italic mb-1"},Wa={class:"flex justify-between items-start text-[10px] mt-1"},Qa={class:"flex flex-col"},Ja={class:"text-gray-800"},Ya={key:0,class:"flex flex-col mt-0.5"},Za={style:{"text-decoration":"line-through",color:"#9ca3af"},class:"text-[9px]"},el={class:"text-[9px] font-bold text-gray-800"},tl={class:"font-bold text-[11px] mt-0.5"},sl=e("div",{class:"border-t border-black my-2 dashed"},null,-1),ol={class:"text-right text-[11px] space-y-1"},nl={key:0,class:"flex justify-between text-gray-600"},al=e("span",null,"Subtotal",-1),ll={key:1,class:"flex justify-between text-gray-600"},rl=e("span",null,"Descuento",-1),il={class:"flex justify-between text-base font-black pt-1"},cl=e("span",null,"TOTAL",-1),dl={key:2,class:"flex justify-between text-[10px] mt-1 text-green-700 font-bold"},ul=e("span",null,"Efectivo:",-1),hl={key:3,class:"flex justify-between text-[10px] text-green-700 font-bold"},vl=e("span",null,"Cambio:",-1),pl={class:"text-center mt-6 text-[10px] space-y-1 mb-4"},_l=e("p",{class:"font-medium"},"¡Gracias por su compra!",-1),ml={key:0,class:"mt-2 pt-2 border-t border-dotted border-gray-300 text-left"},fl=e("p",{class:"font-bold text-[9px] text-gray-500"},"Notas:",-1),gl={class:"italic"},xl={class:"p-6"},bl=e("h2",{class:"text-lg font-semibold mb-4"},"Escanear Código de Barras",-1),yl=e("p",{class:"text-sm text-gray-600 mb-4"}," Apunta la cámara hacia el código de barras. El producto se agregará automáticamente al carrito. ",-1),wl=e("div",{id:"barcode-scanner-sales",class:"w-full rounded-lg overflow-hidden",style:{"min-height":"300px"}},null,-1),kl={class:"p-6"},Cl={class:"flex items-center justify-between mb-4"},Ml={class:"text-lg font-semibold"},Tl=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),jl=[Tl],Sl={class:"space-y-4"},$l=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cantidad",-1),Pl=["value"],El=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Valor",-1),Dl=["value"],Nl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),Fl=e("option",{value:"percentage"},"Porcentaje",-1),ql=e("option",{value:"amount"},"Monto",-1),Ll=[Fl,ql],Bl={class:"block text-sm font-medium text-gray-700 mb-2"},Ol=["step","max","placeholder"],Vl={key:0,class:"p-4 bg-gray-50 rounded-lg space-y-2"},Rl={class:"flex justify-between text-sm"},Al=e("span",{class:"text-gray-700"},"Subtotal:",-1),zl={class:"font-semibold"},Il={class:"flex justify-between text-sm"},Xl=e("span",{class:"text-gray-700"},"Descuento:",-1),Hl={class:"font-semibold"},Kl={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},Ul=e("span",null,"Total:",-1),Gl={class:"flex gap-3 mt-6"},Wl={class:"p-6 max-h-[90vh] flex flex-col"},Ql={class:"flex items-center justify-between mb-4 flex-shrink-0"},Jl=e("h2",{class:"text-lg font-semibold"},"Catálogo de Productos",-1),Yl=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Zl=[Yl],er={class:"mb-4 relative flex-shrink-0"},tr=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),sr={class:"mb-4 flex items-center gap-2 overflow-x-auto pb-2 flex-shrink-0"},or=["onClick"],nr={class:"flex-1 overflow-y-auto"},ar={key:0,class:"text-center py-12 text-gray-500"},lr=e("p",null,"No se encontraron productos",-1),rr=[lr],ir={key:1,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"},cr=["onClick"],dr={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},ur=["src","alt"],hr={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},vr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),pr=[vr],_r={class:"p-2 flex-1 flex flex-col"},mr={class:"mb-1"},fr={class:"text-xs line-through text-red-600"},gr={class:"text-sm font-bold text-green-600"},xr={key:1,class:"text-sm font-bold text-gray-900"},br={class:"font-medium text-xs text-gray-900 line-clamp-2"},yr={class:"p-6"},wr={class:"flex items-center justify-between mb-4"},kr=e("h2",{class:"text-lg font-semibold"},"Descuento general de la factura",-1),Cr=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Mr=[Cr],Tr={class:"space-y-4"},jr=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),Sr=e("option",{value:"percentage"},"Porcentaje",-1),$r=e("option",{value:"amount"},"Monto",-1),Pr=[Sr,$r],Er={class:"block text-sm font-medium text-gray-700 mb-2"},Dr=["step","max","placeholder"],Nr={class:"p-4 bg-gray-50 rounded-lg space-y-2"},Fr={class:"flex justify-between text-sm"},qr=e("span",{class:"text-gray-700"},"Subtotal:",-1),Lr={class:"font-semibold"},Br={class:"flex justify-between text-sm"},Or=e("span",{class:"text-gray-700"},"Descuento:",-1),Vr={class:"font-semibold"},Rr={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},Ar=e("span",null,"Total:",-1),zr={class:"flex gap-3 mt-6"},Ir={class:"p-6"},Xr={class:"flex items-center justify-between mb-4"},Hr=e("h2",{class:"text-lg font-semibold text-red-600"},"⚠️ Stock Insuficiente",-1),Kr=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Ur=[Kr],Gr={class:"mb-4"},Wr=["innerHTML"],Qr={class:"flex justify-end"},ri={__name:"Index",props:{sales:Object,stats:Object,filters:Object,products:Array,categories:Array,store:Object},setup(p){const R=p,be=je(),Qe=H(()=>(be.props.auth?.roles||[]).includes("physical-sales")),De=()=>{Qe.value?he.post(route("logout"),{},{onSuccess:()=>{window.location.href=route("login")},onError:()=>{window.location.href=route("login")}}):he.visit(route("dashboard"))},ye=u("sales");mt({start_date:R.filters?.start_date||"",end_date:R.filters?.end_date||"",search:R.filters?.search||""});const Ne=u("");u(!1);const v=u(null),ae=u(!1),A=u(!1),Je=async()=>{if(v.value){A.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await Mt(o,`factura-${v.value.sale_number}.pdf`)}catch(o){console.error(o),alert("Error al generar el PDF")}finally{A.value=!1}}},Ye=async()=>{if(v.value){A.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await Tt(o,`factura-${v.value.sale_number}.pdf`,`Factura #${v.value.sale_number}`)}catch(o){console.error(o)}finally{A.value=!1}}},_e=u(!1),Fe=u(null),Ze=o=>{Fe.value=o,_e.value=!0},et=(o,s)=>{ie(o,s)},Z=o=>{if(o.variants&&o.variants.length>0&&o.variant_options&&o.variant_options.length>0){if(o.variants.reduce((t,n)=>t+(Number(n.stock)||0),0)===0&&(Number(o.quantity)||0)>0){ie(o);return}Ze(o)}else ie(o)},d=o=>!o&&o!==0?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),tt=o=>new Date(o).toLocaleString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),st=o=>{o&&he.visit(route("admin.physical-sales.show",o.id)+"?print=true")};H(()=>{if(!R.sales||!R.sales.data)return[];const o=new Date;o.setHours(0,0,0,0);const s=new Date(o);s.setHours(23,59,59,999);let t=R.sales.data.filter(n=>{const i=new Date(n.created_at);return i>=o&&i<=s});if(Ne.value.trim()){const n=Ne.value.toLowerCase();t=t.filter(i=>i.sale_number.toLowerCase().includes(n))}return t});const c=u([]),x=u(""),we=u(null),L=u([]),qe=u(!1),K=()=>{window.innerWidth>=1024&&We(()=>{we.value&&we.value.focus()})},le=u(!1),Le=u(""),z=u(!1),ee=u("efectivo"),N=u(0);Se(z,o=>{o&&(N.value=0)});const me=u(""),F=u(0),E=u("amount"),D=u(null);u(null),u(!1),u(!1);const U=u(!1),G=u(!1),te=u(!1),_=u(null),S=u("percentage"),$=u(0),I=u(!1),fe=u(""),W=u(null),ot=H(()=>{if(S.value==="percentage")return 100;if(_.value===null)return 0;const o=c.value[_.value];return o&&(o.original_price||o.unit_price)||0}),nt=H(()=>{if(ee.value!=="efectivo"||!N.value)return 0;const o=parseFloat(N.value);return Math.max(0,o-se.value)}),re=u(!1),ge=u(!1),at=()=>{ge.value=!0},ke=()=>{try{const o=new(window.AudioContext||window.webkitAudioContext),s=o.createOscillator(),t=o.createGain();s.connect(t),t.connect(o.destination),s.frequency.value=800,s.type="sine",t.gain.setValueAtTime(.3,o.currentTime),t.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),s.start(o.currentTime),s.stop(o.currentTime+.2)}catch{}},X=H(()=>c.value.reduce((o,s)=>o+s.quantity*s.unit_price,0)),Q=H(()=>E.value==="percentage"?X.value*F.value/100:F.value),se=H(()=>X.value-Q.value),xe=H(()=>{if(!R.products)return[];let o=R.products;if(D.value&&(o=o.filter(s=>s.category_id===D.value)),x.value.trim()){const s=x.value.toLowerCase();o=o.filter(t=>t.name.toLowerCase().includes(s)||t.id.toString().includes(s)||t.barcode&&t.barcode.toLowerCase().includes(s)||t.variant_options&&t.variant_options.some(n=>n.children&&n.children.some(i=>i.name.toLowerCase().includes(s)||i.barcode&&i.barcode.toLowerCase().includes(s)))||t.variants&&t.variants.some(n=>n.sku&&n.sku.toLowerCase().includes(s)||n.options&&Object.values(n.options).some(i=>String(i).toLowerCase().includes(s))))}return o}),oe=async()=>{if(!x.value.trim()){L.value=[];return}qe.value=!0;try{const s=(await window.axios.get(route("admin.physical-sales.search-products"),{params:{q:x.value}})).data?.products||[];L.value=s,s.length===1&&window.innerWidth<1024&&(Z(s[0]),x.value="",L.value=[])}catch{L.value=[]}finally{qe.value=!1}},Be=async o=>{const s=o.replace(/\s+/g,"").trim();if(s)try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(P=>P.options&&Object.values(P.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?(ie(n,f),Le.value=""):(Z(n),Le.value="")}else alert("Producto no encontrado con ese código de barras"),K()}catch{alert("Error al buscar producto"),K()}},q=(o,s=null)=>{const t=s?.price??o.price;let n=parseFloat(t),i=0;return o.promo_active&&o.promo_discount_percent>0&&(i=parseFloat(o.promo_discount_percent),n=Math.round(n*(100-i)/100)),{originalPrice:parseFloat(t),finalPrice:n,discountPercent:i}},ie=(o,s=null)=>{const t=c.value.find(n=>n.product_id===o.id&&n.variant_id===(s?.id||null));if(t)t.quantity+=1;else{const n=q(o,s);c.value.push({product_id:o.id,product_name:o.name,variant_id:s?.id||null,variant_options:s?.options||null,quantity:1,unit_price:n.finalPrice,original_price:n.originalPrice,discount_percent:n.discountPercent,product:o,variant:s})}x.value="",L.value=[],K()},B=o=>{if(o.product){const s=o.product.track_inventory;if(!s||s==="0"||s===0||s===!1)return"Ilimitado"}return o.variant&&o.variant.stock!==null&&o.variant.stock!==void 0?o.variant.stock:o.product&&o.product.quantity!==null&&o.product.quantity!==void 0?o.product.quantity:"N/A"},Ce=o=>{const s=B(o);return s==="Ilimitado"||s==="N/A"?!0:s>=o.quantity},lt=o=>{if(!Ce(o))return"bg-red-50";const s=B(o);return s===0||typeof s=="number"&&s<o.quantity?"bg-yellow-50":""},Oe=o=>{const s=B(o);return s===0||typeof s=="number"&&s<o.quantity?"text-red-600 font-semibold text-xs":typeof s=="number"&&s<5?"text-yellow-600 font-medium text-xs":"text-gray-600 text-xs"},rt=()=>{c.value=[],F.value=0,E.value="amount",K()},Ve=o=>{c.value.splice(o,1),K()},Re=(o,s)=>{const t=c.value[o],n=t.quantity+s;if(n>0){const i=B(t);if(typeof i=="number"&&n>i){fe.value=`No hay suficiente stock para el producto "${t.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${n}`,I.value=!0;return}t.quantity=n}},it=(o,s)=>{const t=parseInt(s.target.value);if(t>0){const n=c.value[o],i=B(n);if(typeof i=="number"&&t>i){fe.value=`No hay suficiente stock para el producto "${n.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${t}`,I.value=!0,s.target.value=n.quantity;return}c.value[o].quantity=t}},ce=o=>o==null||o===""?"":new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:!0}).format(o),Ae=o=>{if(typeof o=="number")return o;if(!o)return 0;const s=o.toString().replace(/\./g,"").replace(/[^0-9]/g,"");return parseFloat(s)||0},ct=(o,s)=>{let t=s.target.value;const n=Ae(t),i=c.value[o];i.discount_percent>0?(i.unit_price=n,i.original_price=n/(1-i.discount_percent/100)):(i.unit_price=n,i.original_price=n),t!==""&&(s.target.value=ce(n))},dt=o=>{let s=o.target.value;const t=Ae(s);N.value=t,s!==""&&(o.target.value=ce(t))},ut=(o,s)=>{let t=parseFloat(s.target.value)||0;t=Math.round(t*100)/100;const n=Math.min(100,Math.max(0,t)),i=c.value[o];i.original_price||(i.original_price=i.unit_price),i.discount_type="percentage",i.discount_value=n,i.discount_percent=n,i.unit_price=i.original_price*(1-n/100),t!==n&&(s.target.value=n)},Me=o=>{_.value=o;const s=c.value[o];s.discount_type?(S.value=s.discount_type,$.value=s.discount_value||0):s.discount_percent>0?(S.value="percentage",$.value=s.discount_percent):(S.value="percentage",$.value=0),U.value=!0},ht=()=>{if(_.value===null)return;const o=c.value[_.value];o.original_price||(o.original_price=o.unit_price);const s=o.original_price;if(S.value==="percentage"){const t=Math.min(100,Math.max(0,$.value)),n=Math.round(t*100)/100;o.discount_type="percentage",o.discount_value=n,o.discount_percent=n,o.unit_price=s*(1-n/100)}else{const t=Math.min(s,Math.max(0,$.value));o.discount_type="amount",o.discount_value=t,o.discount_percent=t/s*100,o.unit_price=s-t}U.value=!1,_.value=null,$.value=0},ze=()=>{G.value=!0},vt=()=>{G.value=!1},Ie=async()=>{try{le.value=!0,await We();const{Html5Qrcode:o}=await kt(async()=>{const{Html5Qrcode:n}=await import("./index-Cx66glhu.js");return{Html5Qrcode:n}},__vite__mapDeps([0,1,2])),s=document.getElementById("barcode-scanner-sales");if(!s)return;W.value=new o(s.id);const t={fps:10,qrbox:{width:250,height:250}};try{await W.value.start({facingMode:"environment"},t,async n=>{ke(),await Be(n),de()},n=>{})}catch{try{await W.value.start({facingMode:"user"},t,async i=>{ke(),await Be(i),de()},i=>{})}catch{alert("No se pudo acceder a la cámara. Por favor, permite el acceso a la cámara en la configuración del navegador."),le.value=!1}}}catch{alert("Error al inicializar el escáner. Por favor, intenta nuevamente."),le.value=!1}},de=async()=>{if(W.value){try{await W.value.stop(),await W.value.clear()}catch{}W.value=null}le.value=!1},ue=()=>{const o=document.head.querySelector('meta[name="csrf-token"]');if(o&&o.content)return window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=o.content,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=o.content),o.content;const t=(n=>{const f=`; ${document.cookie}`.split(`; ${n}=`);return f.length===2?f.pop().split(";").shift():null})("XSRF-TOKEN");if(t&&window.axios){const n=decodeURIComponent(t);return window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,n}return null};ft(()=>{K(),setTimeout(()=>{ue(),window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{ue()},300)},100)}),he.on("finish",()=>{setTimeout(()=>{const s=je().props.csrf_token;if(s){const t=document.head.querySelector('meta[name="csrf-token"]');t&&t.setAttribute("content",s),window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=s,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=s)}ue(),window.updateCsrfToken&&window.updateCsrfToken()},200)});const pt=async()=>{if(c.value.length===0){alert("El carrito está vacío");return}const o=[];for(let t=0;t<c.value.length;t++){const n=c.value[t];if(!Ce(n)){const i=B(n);o.push({name:n.product_name,requested:n.quantity,available:i})}}if(o.length>0){let t=`No se puede procesar la venta. Los siguientes productos no tienen stock suficiente:

`;o.forEach(n=>{t+=`• ${n.name}: Solicitado ${n.requested}, Disponible ${n.available}
`}),fe.value=t.replace(/\n/g,"<br>"),I.value=!0;return}const s={items:c.value.map(t=>({product_id:t.product_id,variant_id:t.variant_id,quantity:t.quantity,unit_price:t.unit_price,original_price:t.original_price,discount_percent:t.discount_percent})),subtotal:X.value,tax:0,discount:Q.value,total:se.value,payment_method:ee.value,notes:me.value};try{if(!window.axios){alert("Error: No se pudo inicializar la conexión. Por favor, recarga la página.");return}let n=je().props.csrf_token;if(n){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",n)}else n=ue();if(n||(await new Promise(m=>setTimeout(m,200)),n=ue()),!n){alert("Error: No se pudo obtener el token de seguridad. Por favor, recarga la página.");return}window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n;const i=()=>{const m=document.head.querySelector('meta[name="csrf-token"]');if(m&&m.content)return m.content;const w=(M=>{const Ge=`; ${document.cookie}`.split(`; ${M}=`);return Ge.length===2?Ge.pop().split(";").shift():null})("XSRF-TOKEN");return w?decodeURIComponent(w):null},f=async(m=0)=>{try{let C=i();if(!C&&m===0)try{const M=await window.axios.get(route("dashboard"),{headers:{"X-Requested-With":"XMLHttpRequest"}});await new Promise(T=>setTimeout(T,100)),C=i()}catch{}if(!C)throw new Error("No se pudo obtener el token CSRF. Por favor, recarga la página.");window.axios.defaults.headers.common["X-CSRF-TOKEN"]=C,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=C;const w=await window.axios.post(route("admin.physical-sales.store"),s,{headers:{"X-CSRF-TOKEN":C,"X-XSRF-TOKEN":C,"X-Requested-With":"XMLHttpRequest"}});if(w&&w.headers){const M=w.headers["x-csrf-token"]||w.headers["X-CSRF-TOKEN"];if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}}return w}catch(C){if(C.response){if(C.response.status===419&&m===0){const w=C.response.headers||{},M=w["x-csrf-token"]||w["X-CSRF-TOKEN"]||null;if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}else{const T=i();T&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=T)}return await new Promise(T=>setTimeout(T,200)),await f(1)}}else if(m===0){const w=i();return w&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=w),await new Promise(M=>setTimeout(M,200)),await f(1)}throw C}},k=await f(),P=k.headers?.["x-csrf-token"]||k.headers?.["X-CSRF-TOKEN"];if(P){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",P),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=P}k.data&&k.data.success?(v.value=k.data.sale,z.value=!1,c.value=[],x.value="",F.value=0,E.value="amount",me.value="",ee.value="efectivo",D.value=null,window.updateCsrfToken&&window.updateCsrfToken(),ae.value=!0,he.reload()):alert("Error: "+(k.data?.message||"No se pudo procesar la venta"))}catch(t){console.error("Error completo al procesar la venta:",{error:t,message:t.message,response:t.response,status:t.response?.status,data:t.response?.data,headers:t.response?.headers});let n="Error al procesar la venta";if(t.response){const i=t.response.status,f=t.response.data;i===419?(n="Tu sesión ha expirado. Por favor, recarga la página e intenta nuevamente.",window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{window.location.reload()},2e3)):i===422?f?.message?n=f.message:f?.errors?n=`Error de validación:
${Object.entries(f.errors).map(([P,m])=>Array.isArray(m)?`${P}: ${m.join(", ")}`:`${P}: ${m}`).join(`
`)}`:n="Error de validación. Verifica los datos e intenta nuevamente.":f?.message?n=f.message:n=`Error del servidor (${i}). Por favor, intenta nuevamente.`}else t.request?n="No se pudo conectar con el servidor. Verifica tu conexión a internet.":t.message&&(n=t.message);alert(n)}};gt(()=>{de()});let Xe;Se(x,async o=>{clearTimeout(Xe);const s=o.replace(/\s+/g,"").trim();if(s.length>=8&&/^\d+$/.test(s))try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(P=>P.options&&Object.values(P.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?ie(n,f):Z(n),x.value="",ke();return}}catch{}Xe=setTimeout(()=>{x.value.trim().length>=2?oe():L.value=[]},300)}),Se([_e,te,U,G,z,ae,re,I],(o,s)=>{o.some((n,i)=>!n&&s[i])&&setTimeout(()=>{K()},150)});const He=u(50),Te=u(!1),_t=()=>{Te.value=!0,document.addEventListener("mousemove",Ke),document.addEventListener("mouseup",Ue),document.body.style.userSelect="none",document.body.style.cursor="col-resize"},Ke=o=>{if(!Te.value)return;const s=window.innerWidth,t=o.clientX/s*100;t>20&&t<80&&(He.value=t)},Ue=()=>{Te.value=!1,document.removeEventListener("mousemove",Ke),document.removeEventListener("mouseup",Ue),document.body.style.userSelect="",document.body.style.cursor=""};return(o,s)=>(a(),l(j,null,[g($e(xt),{title:"Ventas Físicas"}),g(Ct,null,{header:y(()=>[ye.value!=="sales"?(a(),l("h2",Pt,"Ventas Físicas")):h("",!0)]),default:y(()=>[ye.value==="sales"?(a(),l("div",Et,[e("div",{style:bt({width:He.value+"%"}),class:"h-full flex flex-col border-r border-gray-300"},[e("div",Dt,[e("div",Nt,[e("button",{onClick:De,class:"px-3 py-2 bg-white text-gray-700 rounded-lg hover:bg-gray-100 text-sm font-medium flex items-center gap-2 border border-gray-200"},[Ft,b(" Salir ")]),e("button",{onClick:s[0]||(s[0]=t=>re.value=!0),class:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 text-sm font-medium flex items-center gap-2 border border-red-200",title:"Registrar Gasto / Salida"},[qt,b(" Gasto ")]),e("div",Lt,[O(e("input",{ref_key:"searchInput",ref:we,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:Pe(oe,["enter"])},null,544),[[ne,x.value]]),Bt,e("button",{onClick:Ie,class:"absolute right-2 top-1.5 p-1 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},Vt)])]),e("div",Rt,[e("button",{onClick:s[2]||(s[2]=t=>{D.value=null,x.value=""}),class:J(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(j,null,V(p.categories,t=>(a(),l("button",{key:t.id,onClick:n=>{D.value=t.id,x.value=""},class:J(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,At))),128))])]),e("div",zt,[xe.value.length===0?(a(),l("div",It,Ht)):(a(),l("div",Kt,[(a(!0),l(j,null,V(xe.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>Z(t)},[e("div",Gt,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,Wt)):(a(),l("svg",Qt,Yt))]),e("div",Zt,[e("div",es,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",ts,r(d(q(t).originalPrice)),1),e("p",ss,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",os,r(d(q(t).finalPrice)),1))]),e("h3",{class:"font-medium text-xs text-gray-900 line-clamp-2",title:t.name},r(t.name),9,ns)])],8,Ut))),128))]))])],4),e("div",{class:"w-1 hover:w-2 bg-gray-200 hover:bg-blue-400 cursor-col-resize flex items-center justify-center transition-all z-20 group",onMousedown:_t,title:"Arrastra para ajustar el tamaño"},ls,32),e("div",rs,[e("div",is,[e("div",cs,[ds,e("span",us,r($e(be).props.auth?.user?.name||"Usuario"),1),hs,p.store&&p.store.logo_url?(a(),l("img",{key:0,src:p.store.logo_url,alt:`Logo de ${p.store.name}`,class:"h-6 w-6 rounded-full object-cover"},null,8,vs)):h("",!0),p.store?(a(),l("span",ps,r(p.store.name),1)):h("",!0)])]),e("div",_s,[c.value.length===0?(a(),l("div",ms,xs)):(a(),l("div",bs,[e("table",ys,[ws,e("tbody",ks,[(a(!0),l(j,null,V(c.value,(t,n)=>(a(),l("tr",{key:n,class:J(["hover:bg-gray-50",lt(t)])},[e("td",{class:"px-3 py-3 text-left align-middle",title:t.product_name},[e("div",Ms,[e("div",Ts,[b(r(t.product_name)+" ",1),t.variant_options?(a(),l("span",js," ("+r(Object.values(t.variant_options).join(" / "))+") ",1)):h("",!0)])])],8,Cs),e("td",{class:"px-3 py-3 text-center align-middle w-16",title:`Stock disponible: ${B(t)}`},[e("span",{class:J(Oe(t))},r(B(t)),3)],8,Ss),e("td",{class:"px-3 py-3 text-center align-middle w-20",title:`Cantidad: ${t.quantity}`},[e("input",{type:"number",value:t.quantity,onChange:i=>it(n,i),class:"w-full text-center border border-gray-300 rounded text-sm py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1"},null,40,Ps)],8,$s),e("td",{class:"px-3 py-3 text-right align-middle w-40",title:`Precio unitario: ${d(t.unit_price)}`},[e("input",{type:"text",value:ce(t.original_price||t.unit_price),onInput:i=>ct(n,i),class:"w-full text-right border border-gray-300 rounded text-sm py-2 px-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"},null,40,Ds)],8,Es),e("td",{class:"px-3 py-3 text-right align-middle w-32",title:t.discount_type==="amount"?`Descuento: $${t.discount_value}`:`Descuento: ${t.discount_percent}%`},[t.discount_type==="amount"?(a(),l("button",{key:0,onClick:i=>Me(n),class:"w-full text-right border border-blue-200 bg-blue-50 text-blue-700 font-semibold rounded text-sm py-2 px-2 hover:bg-blue-100 transition-colors"}," $ "+r(ce(t.discount_value)),9,Fs)):(a(),l("div",qs,[e("input",{type:"number",value:t.discount_percent,onChange:i=>ut(n,i),onClick:yt(i=>Me(n),["self"]),class:"w-full text-right border border-gray-300 rounded text-sm py-2 pl-2 pr-6 cursor-pointer focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"},null,40,Ls),Bs]))],8,Ns),e("td",{class:"px-3 py-3 text-right align-middle w-36",title:`Subtotal: ${d(t.quantity*t.unit_price)}`},[e("span",Vs,r(d(t.quantity*t.unit_price)),1)],8,Os),e("td",Rs,[e("button",{onClick:i=>Ve(n),class:"flex items-center justify-center w-8 h-8 bg-red-500 text-white rounded hover:bg-red-600 transition-colors mx-auto",title:"Eliminar producto"},Is,8,As)])],2))),128))])])]))]),c.value.length>0?(a(),l("div",Xs,[e("div",Hs,[Ks,e("span",Us,r(d(X.value)),1)]),e("div",Gs,[Ws,e("span",{onClick:ze,class:"font-medium cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(F.value>0?"-"+d(Q.value):d(0))+" ",1),Qs])]),e("div",Js,[e("div",Ys,[Zs,e("span",eo,r(d(se.value)),1)]),e("div",to,[e("button",{onClick:s[3]||(s[3]=t=>z.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base"}," Procesar Venta "),e("button",{onClick:rt,class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base border border-red-300"}," Cancelar ")])])])):h("",!0)])])):h("",!0),ye.value==="sales"?(a(),l("div",so,[e("div",oo,[e("div",no,[e("div",ao,[lo,e("span",ro,r($e(be).props.auth?.user?.name||"Usuario"),1),io,p.store&&p.store.logo_url?(a(),l("img",{key:0,src:p.store.logo_url,alt:`Logo de ${p.store.name}`,class:"h-5 w-5 rounded-full object-cover"},null,8,co)):h("",!0),p.store?(a(),l("span",uo,r(p.store.name),1)):h("",!0)]),e("button",{onClick:De,class:"px-3 py-1.5 bg-teal-500 text-white rounded text-sm font-medium"}," « Regresar ")])]),e("div",ho,[e("div",vo,[e("button",{onClick:s[4]||(s[4]=t=>te.value=!0),class:"px-3 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center flex-shrink-0",title:"Ver catálogo de productos"},_o),e("button",{onClick:s[5]||(s[5]=t=>re.value=!0),class:"px-3 py-2.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 flex items-center justify-center flex-shrink-0 border border-red-200",title:"Registrar Gasto"},fo),e("div",go,[O(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:Pe(oe,["enter"]),onInput:oe},null,544),[[ne,x.value]]),xo,e("button",{onClick:Ie,class:"absolute right-2 top-2 p-1.5 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},yo)])]),L.value.length>0&&x.value.trim()?(a(),l("div",wo,[(a(!0),l(j,null,V(L.value,t=>(a(),l("div",{key:t.id,onClick:n=>{Z(t),x.value="",L.value=[]},class:"px-4 py-3 border-b border-gray-100 hover:bg-blue-50 cursor-pointer flex items-center gap-3"},[e("div",Co,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover rounded"},null,8,Mo)):(a(),l("svg",To,So))]),e("div",$o,[e("p",Po,r(t.name),1),e("div",null,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",Eo,r(d(q(t).originalPrice)),1),e("p",Do,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",No,r(d(q(t).finalPrice)),1))])]),Fo],8,ko))),128))])):h("",!0)]),qo,e("div",Lo,[c.value.length===0?(a(),l("div",Bo,Ao)):(a(),l("div",zo,[(a(!0),l(j,null,V(c.value,(t,n)=>(a(),l("div",{key:n,class:"px-4 py-3 bg-white"},[e("div",Io,[e("div",Xo,[e("div",Ho,[e("span",{class:J(Oe(t))}," Stock: "+r(B(t)),3),Ce(t)?h("",!0):(a(),l("span",Ko," ⚠ Sin stock "))]),e("p",Uo,r(t.product_name),1),e("p",Go,r(d(t.unit_price)),1)]),e("div",Wo,[e("div",Qo,[Jo,e("div",Yo,[e("button",{onClick:i=>Re(n,-1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," - ",8,Zo),e("span",en,r(t.quantity),1),e("button",{onClick:i=>Re(n,1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," + ",8,tn)])]),e("div",sn,[on,e("span",nn,r(d(t.quantity*t.unit_price)),1)]),e("button",{onClick:i=>Me(n),class:"w-8 h-8 flex items-center justify-center bg-gray-200 text-gray-600 rounded hover:bg-gray-300",title:"Aplicar descuento"},rn,8,an),e("button",{onClick:i=>Ve(n),class:"w-8 h-8 flex items-center justify-center bg-red-500 text-white rounded hover:bg-red-600"},un,8,cn)])])]))),128))]))]),c.value.length>0?(a(),l("div",hn,[e("div",vn,[e("div",pn,[_n,e("span",mn,r(d(X.value)),1)]),e("div",fn,[gn,e("span",{onClick:ze,class:"font-medium text-green-600 cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(F.value>0?"-"+d(Q.value):d(0))+" ",1),xn])]),e("div",bn,[yn,e("span",wn,r(d(se.value)),1)])]),e("div",kn,[e("button",{onClick:s[7]||(s[7]=t=>z.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base transition-colors"}," PROCESAR VENTA "),e("button",{onClick:s[8]||(s[8]=t=>{c.value=[],F.value=0,E.value="amount"}),class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base transition-colors border border-red-300"}," CANCELAR ")])])):h("",!0)])):h("",!0),g(Y,{show:z.value,onClose:s[12]||(s[12]=t=>z.value=!1)},{default:y(()=>[e("div",Cn,[Mn,e("div",Tn,[jn,O(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>ee.value=t),class:"w-full rounded-md border-gray-300"},Dn,512),[[Ee,ee.value]])]),ee.value==="efectivo"?(a(),l("div",Nn,[Fn,e("div",qn,[Ln,e("input",{value:ce(N.value),onInput:dt,type:"text",inputmode:"numeric",class:"w-full pl-7 rounded-md border-gray-300 focus:ring-green-500 focus:border-green-500 font-bold text-lg",placeholder:"0"},null,40,Bn)]),N.value?(a(),l("div",On,[Vn,e("span",Rn,r(d(nt.value)),1)])):h("",!0)])):h("",!0),e("div",An,[zn,O(e("textarea",{"onUpdate:modelValue":s[10]||(s[10]=t=>me.value=t),class:"w-full rounded-md border-gray-300",rows:"3",placeholder:"Notas adicionales sobre la venta..."},null,512),[[ne,me.value]])]),c.value.some(t=>t.discount_percent>0)?(a(),l("div",In,[Xn,e("div",Hn,[(a(!0),l(j,null,V(c.value.filter(t=>t.discount_percent>0),(t,n)=>(a(),l("div",{key:n,class:"flex justify-between text-sm"},[e("span",Kn,r(t.product_name)+":",1),e("span",Un,"-"+r(t.discount_percent)+"% ("+r(d((t.original_price-t.unit_price)*t.quantity))+")",1)]))),128))])])):h("",!0),e("div",Gn,[e("div",Wn,[Qn,e("span",null,r(d(X.value)),1)]),Q.value>0?(a(),l("div",Jn,[e("span",null,"Descuento ("+r(E.value==="percentage"?F.value+"%":"Monto")+"):",1),e("span",null,"-"+r(d(Q.value)),1)])):h("",!0),e("div",Yn,[Zn,e("span",null,r(d(se.value)),1)])]),e("div",ea,[g(ve,{onClick:s[11]||(s[11]=t=>z.value=!1)},{default:y(()=>[b("Cancelar")]),_:1}),g(pe,{onClick:pt},{default:y(()=>[b("Confirmar Venta")]),_:1})])])]),_:1},8,["show"]),g(Y,{show:ae.value,onClose:s[15]||(s[15]=t=>ae.value=!1)},{default:y(()=>[e("div",ta,[sa,v.value?(a(),l("div",oa,[e("p",na,[b(" Número de venta: "),e("span",aa,"#"+r(v.value.sale_number),1)]),e("p",la,[b(" Total: "),e("span",ra,r(d(v.value.total)),1)])])):h("",!0),e("div",ia,[g(ve,{onClick:s[13]||(s[13]=t=>ae.value=!1),class:"!px-3 sm:!px-4"},{default:y(()=>[ca,da]),_:1}),v.value?(a(),l("button",{key:0,onClick:Je,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:A.value,title:"Descargar PDF"},[A.value?(a(),l("span",ha,"⏳")):(a(),l("span",va,[b("⬇️ "),pa]))],8,ua)):h("",!0),v.value?(a(),l("button",{key:1,onClick:Ye,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:A.value,title:"Compartir Factura"},[A.value?(a(),l("span",ma,"⏳")):(a(),l("span",fa,[b("🔗 "),ga]))],8,_a)):h("",!0),v.value?(a(),wt(pe,{key:2,onClick:s[14]||(s[14]=t=>st(v.value)),class:"!px-3 sm:!px-4",title:"Imprimir Factura"},{default:y(()=>[b(" 🖨️ "),xa]),_:1})):h("",!0)]),e("div",ba,[e("div",ya,[e("div",wa,[p.store?.logo_url?(a(),l("img",{key:0,src:p.store.logo_url,alt:"Logo",class:"h-12 w-auto object-contain mx-auto mb-2 grayscale",crossorigin:"anonymous"},null,8,ka)):h("",!0),e("h2",Ca,r(p.store?.name),1),e("div",Ma,[p.store?.nit?(a(),l("p",Ta,"NIT: "+r(p.store.nit),1)):h("",!0),p.store?.address?(a(),l("p",ja,r(p.store.address),1)):h("",!0),p.store?.phone?(a(),l("p",Sa,"Tel: "+r(p.store.phone?.startsWith("57")?p.store.phone.substring(2):p.store.phone),1)):h("",!0),p.store?.email?(a(),l("p",$a,r(p.store.email),1)):h("",!0),p.store?.custom_domain?(a(),l("p",Pa,r(p.store.custom_domain),1)):h("",!0)])]),Ea,e("div",Da,[e("div",Na,[e("p",Fa,"Venta #"+r(v.value?.sale_number),1),e("p",qa,r(v.value?tt(v.value.created_at):""),1)]),e("div",null,[La,e("span",null,r(v.value?.user?.name||o.$page.props.auth.user.name),1)]),e("div",Ba,[Oa,e("span",Va,r(v.value?.payment_method),1)]),v.value?.customer_name?(a(),l("div",Ra,[e("p",null,[Aa,b(" "+r(v.value.customer_name),1)]),v.value.customer_nit?(a(),l("p",za,[Ia,b(" "+r(v.value.customer_nit),1)])):h("",!0)])):h("",!0)]),Xa,e("div",Ha,[Ka,(a(!0),l(j,null,V(v.value?.items,t=>(a(),l("div",{key:t.id,class:"mb-3 border-b border-gray-200 last:border-0 pb-2"},[e("div",Ua,r(t.product_name),1),t.variant_options?(a(),l("div",Ga,r(Object.values(t.variant_options).join(" / ")),1)):h("",!0),e("div",Wa,[e("div",Qa,[e("span",Ja,r(t.quantity)+" x "+r(d(t.unit_price)),1),t.discount_percent>0||t.original_price&&t.original_price>t.unit_price?(a(),l("div",Ya,[e("span",Za," Precio Normal: "+r(d(t.original_price||t.unit_price*100/(100-t.discount_percent))),1),e("span",el," Desc: "+r(t.discount_percent||Math.round((1-t.unit_price/t.original_price)*100))+"% ",1)])):h("",!0)]),e("div",tl,r(d(t.subtotal)),1)])]))),128))]),sl,e("div",ol,[v.value?.discount>0?(a(),l("div",nl,[al,e("span",null,r(d(v.value.subtotal)),1)])):h("",!0),v.value?.discount>0?(a(),l("div",ll,[rl,e("span",null,"-"+r(d(v.value.discount)),1)])):h("",!0),e("div",il,[cl,e("span",null,r(d(v.value?.total)),1)]),N.value>0&&v.value?(a(),l("div",dl,[ul,e("span",null,r(d(N.value)),1)])):h("",!0),N.value>v.value?.total?(a(),l("div",hl,[vl,e("span",null,r(d(N.value-v.value.total)),1)])):h("",!0)]),e("div",pl,[_l,v.value?.notes?(a(),l("div",ml,[fl,e("p",gl,r(v.value.notes),1)])):h("",!0)])])])])]),_:1},8,["show"]),g(Y,{show:le.value,onClose:de},{default:y(()=>[e("div",xl,[bl,yl,wl,g(ve,{onClick:de,class:"mt-4"},{default:y(()=>[b("Cerrar")]),_:1})])]),_:1},8,["show"]),g(Y,{show:U.value,onClose:s[20]||(s[20]=t=>U.value=!1)},{default:y(()=>[e("div",kl,[e("div",Cl,[e("h2",Ml,r(_.value!==null?c.value[_.value]?.product_name:"Descuento de Producto"),1),e("button",{onClick:s[16]||(s[16]=t=>U.value=!1),class:"text-gray-400 hover:text-gray-600"},jl)]),e("div",Sl,[e("div",null,[$l,e("input",{type:"number",value:_.value!==null?c.value[_.value]?.quantity:1,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,Pl)]),e("div",null,[El,e("input",{type:"number",value:_.value!==null?c.value[_.value]?.original_price||c.value[_.value]?.unit_price:0,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,Dl)]),e("div",null,[Nl,O(e("select",{"onUpdate:modelValue":s[17]||(s[17]=t=>S.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},Ll,512),[[Ee,S.value]])]),e("div",null,[e("label",Bl," Descuento "+r(S.value==="percentage"?"%":""),1),O(e("input",{"onUpdate:modelValue":s[18]||(s[18]=t=>$.value=t),type:"number",step:(S.value==="percentage","0.01"),min:0,max:ot.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:S.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,Ol),[[ne,$.value,void 0,{number:!0}]])]),_.value!==null?(a(),l("div",Vl,[e("div",Rl,[Al,e("span",zl,r(d((c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity)),1)]),e("div",Il,[Xl,e("span",Hl,r(d(S.value==="percentage"?(c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity*$.value/100:$.value*c.value[_.value]?.quantity)),1)]),e("div",Kl,[Ul,e("span",null,r(d((c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity-(S.value==="percentage"?(c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity*$.value/100:$.value*c.value[_.value]?.quantity))),1)])])):h("",!0)]),e("div",Gl,[g(ve,{onClick:s[19]||(s[19]=t=>U.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(pe,{onClick:ht},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(St,{show:re.value,onClose:s[21]||(s[21]=t=>re.value=!1),onSuccess:at},null,8,["show"]),g($t,{show:_e.value,product:Fe.value,onClose:s[22]||(s[22]=t=>_e.value=!1),onAddToCart:et},null,8,["show","product"]),g(Y,{show:te.value,onClose:s[26]||(s[26]=t=>te.value=!1),"max-width":"4xl"},{default:y(()=>[e("div",Wl,[e("div",Ql,[Jl,e("button",{onClick:s[23]||(s[23]=t=>te.value=!1),class:"text-gray-400 hover:text-gray-600"},Zl)]),e("div",er,[O(e("input",{"onUpdate:modelValue":s[24]||(s[24]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",onKeyup:Pe(oe,["enter"]),onInput:oe},null,544),[[ne,x.value]]),tr]),e("div",sr,[e("button",{onClick:s[25]||(s[25]=t=>D.value=null),class:J(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(j,null,V(p.categories,t=>(a(),l("button",{key:t.id,onClick:n=>D.value=t.id,class:J(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,or))),128))]),e("div",nr,[xe.value.length===0?(a(),l("div",ar,rr)):(a(),l("div",ir,[(a(!0),l(j,null,V(xe.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>{Z(t),te.value=!1}},[e("div",dr,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,ur)):(a(),l("svg",hr,pr))]),e("div",_r,[e("div",mr,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",fr,r(d(q(t).originalPrice)),1),e("p",gr,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",xr,r(d(q(t).finalPrice)),1))]),e("h3",br,r(t.name),1)])],8,cr))),128))]))])])]),_:1},8,["show"]),g(Y,{show:G.value,onClose:s[31]||(s[31]=t=>G.value=!1)},{default:y(()=>[e("div",yr,[e("div",wr,[kr,e("button",{onClick:s[27]||(s[27]=t=>G.value=!1),class:"text-gray-400 hover:text-gray-600"},Mr)]),e("div",Tr,[e("div",null,[jr,O(e("select",{"onUpdate:modelValue":s[28]||(s[28]=t=>E.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},Pr,512),[[Ee,E.value]])]),e("div",null,[e("label",Er," Descuento "+r(E.value==="percentage"?"%":""),1),O(e("input",{"onUpdate:modelValue":s[29]||(s[29]=t=>F.value=t),type:"number",step:(E.value==="percentage","0.01"),min:0,max:E.value==="percentage"?100:X.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:E.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,Dr),[[ne,F.value,void 0,{number:!0}]])]),e("div",Nr,[e("div",Fr,[qr,e("span",Lr,r(d(X.value)),1)]),e("div",Br,[Or,e("span",Vr,r(d(Q.value)),1)]),e("div",Rr,[Ar,e("span",null,r(d(se.value)),1)])])]),e("div",zr,[g(ve,{onClick:s[30]||(s[30]=t=>G.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(pe,{onClick:vt},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(Y,{show:I.value,onClose:s[34]||(s[34]=t=>I.value=!1)},{default:y(()=>[e("div",Ir,[e("div",Xr,[Hr,e("button",{onClick:s[32]||(s[32]=t=>I.value=!1),class:"text-gray-400 hover:text-gray-600"},Ur)]),e("div",Gr,[e("div",{class:"text-sm text-gray-700 whitespace-pre-line",innerHTML:fe.value},null,8,Wr)]),e("div",Qr,[g(pe,{onClick:s[33]||(s[33]=t=>I.value=!1)},{default:y(()=>[b("Entendido")]),_:1})])])]),_:1},8,["show"]),g(jt,{show:ge.value,type:"success",title:"¡Gasto Guardado!",message:"El gasto se ha registrado correctamente en el sistema.","primary-text":"Entendido",onClose:s[35]||(s[35]=t=>ge.value=!1),onPrimary:s[36]||(s[36]=t=>ge.value=!1)},null,8,["show"])]),_:1})],64))}};export{ri as default};
