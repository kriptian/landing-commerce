const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DT4PNOCT.js","assets/app-Ci2tMwYp.js","assets/app-BtB7ZY43.css"])))=>i.map(i=>d[i]);
import{H as Pe,c as U,r as h,u as bt,w as we,B as Je,A as pe,D as yt,a as l,o as a,b as g,d as Ee,h as wt,e as y,i as u,f as e,y as kt,m as b,j,q as De,n as G,x as ee,F as S,s as I,t as r,g as Ct,k as Ye,p as Fe,z as Mt,C as Ze,_ as Tt}from"./app-Ci2tMwYp.js";import{_ as jt}from"./AuthenticatedLayout-yxxeSqKN.js";import{d as St,s as $t}from"./pdfUtils-DxHqdUzx.js";import{_ as Pt}from"./AlertModal-qmVh7xon.js";import{_ as te}from"./Modal-BjVvNRw8.js";import{_ as _e}from"./SecondaryButton-v3UmzY0Q.js";import{_ as me}from"./PrimaryButton-DdIonq6s.js";import Et from"./ExpenseModal-BERzSgDy.js";import Dt from"./VariantSelectorModal-BRpzfOuu.js";import"./InputError-B0UpGuro.js";const Ft={key:0,class:"font-semibold text-xl text-gray-800 leading-tight"},Nt={key:0,class:"hidden lg:flex fixed inset-0 bg-white flex-row",style:{"margin-top":"0","z-index":"10"}},qt={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},Vt={class:"flex items-center gap-3 mb-3"},Lt=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),Bt=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Ot={class:"flex-1 relative"},Rt=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),At=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),It=[At],zt={class:"flex items-center gap-2 overflow-x-auto"},Xt=["onClick"],Ht={class:"flex-1 overflow-y-auto p-4"},Kt={key:0,class:"text-center py-12 text-gray-500"},Ut=e("p",null,"No se encontraron productos",-1),Gt=[Ut],Wt={key:1,class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Qt=["onClick"],Jt={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},Yt=["src","alt"],Zt={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},es=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),ts=[es],ss={class:"p-2 flex-1 flex flex-col"},os={class:"mb-1"},ns={class:"text-xs line-through text-red-600"},as={class:"text-sm font-bold text-green-600"},ls={key:1,class:"text-sm font-bold text-gray-900"},rs=["title"],is=e("div",{class:"h-8 w-1 bg-gray-400 rounded-full group-hover:bg-white"},null,-1),cs=[is],ds={class:"flex-1 h-full flex flex-col bg-white overflow-hidden",style:{"min-width":"300px"}},us={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},hs={class:"flex items-center gap-3"},vs=e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),ps={class:"text-blue-700 font-semibold"},_s=e("span",{class:"text-blue-400"},"|",-1),ms=["src","alt"],fs={key:1,class:"text-blue-700 font-medium text-sm"},gs={class:"flex-1 overflow-y-auto px-3 py-2"},xs={key:0,class:"text-center py-12 text-gray-500"},bs=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),ys=e("p",null,"El carrito está vacío",-1),ws=[bs,ys],ks={key:1,class:"overflow-x-auto"},Cs={class:"w-full text-sm"},Ms=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-3 py-3 text-left text-xs font-semibold text-gray-700"},"Producto"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"},"Stock"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-20"},"Cant"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-40"},"Valor"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-32"},"Desc"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-36"},"SubTotal"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"})])],-1),Ts={class:"divide-y divide-gray-200 bg-white"},js=["title"],Ss={class:"min-w-0",style:{"max-width":"140px"}},$s={class:"font-medium text-gray-900"},Ps={key:0,class:"text-xs text-gray-500 ml-1"},Es=["title"],Ds=["title"],Fs=["value","onChange"],Ns=["title"],qs=["value","onInput"],Vs=["title"],Ls=["onClick"],Bs={key:1,class:"relative"},Os=["value","onChange","onClick"],Rs=e("span",{class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm font-medium pointer-events-none"},"%",-1),As=["title"],Is={class:"font-semibold text-gray-900 text-sm"},zs={class:"px-3 py-3 text-center align-middle w-16"},Xs=["onClick"],Hs=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),Ks=[Hs],Us={key:0,class:"border-t border-gray-200 px-4 py-3 bg-gray-50 space-y-3 flex-shrink-0"},Gs={class:"flex justify-between text-sm"},Ws=e("span",{class:"text-gray-700"},"Total Bruto:",-1),Qs={class:"font-medium"},Js={class:"flex justify-between text-sm items-center"},Ys=e("span",{class:"text-gray-700"},"Descuento:",-1),Zs=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),eo={class:"flex justify-between text-sm items-center"},to={class:"flex items-center text-gray-700 gap-2 cursor-pointer"},so=e("span",null,"Incluir Envío:",-1),oo={key:0,class:"relative w-32"},no=e("span",{class:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500"},"$",-1),ao={key:1,class:"text-gray-500 text-xs italic"},lo={class:"pt-2 border-t border-gray-300"},ro={class:"flex justify-between items-center mb-3"},io=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),co={class:"text-base font-bold text-green-600"},uo={class:"flex gap-3"},ho={key:1,class:"lg:hidden fixed inset-0 bg-white flex flex-col",style:{"margin-top":"0","z-index":"10"}},vo={class:"bg-blue-500 px-4 py-3 flex-shrink-0"},po={class:"flex items-center justify-between"},_o={class:"flex items-center gap-2"},mo=e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),fo={class:"text-white font-semibold"},go=e("span",{class:"text-white"},"|",-1),xo=["src","alt"],bo={key:1,class:"text-white font-medium text-sm"},yo={class:"bg-gray-100 px-4 py-3 flex-shrink-0 border-b border-gray-200"},wo={class:"flex items-center gap-2"},ko=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),Co=[ko],Mo=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),To=[Mo],jo={class:"flex-1 relative"},So=e("svg",{class:"absolute left-3 top-3 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),$o=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),Po=[$o],Eo={key:0,class:"mt-3 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto"},Do=["onClick"],Fo={class:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center flex-shrink-0"},No=["src","alt"],qo={key:1,class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Vo=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),Lo=[Vo],Bo={class:"flex-1 min-w-0"},Oo={class:"font-medium text-sm text-gray-900 truncate"},Ro={class:"text-xs line-through text-red-600"},Ao={class:"text-xs text-green-600 font-semibold"},Io={key:1,class:"text-xs text-gray-500"},zo=e("svg",{class:"w-5 h-5 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Xo=e("div",{class:"bg-gray-200 px-4 py-2 flex-shrink-0"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-8 h-8 bg-blue-400 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})])]),e("h3",{class:"text-gray-700 font-semibold text-sm"},"INFORMACION DE LA VENTA")])],-1),Ho={class:"flex-1 overflow-y-auto bg-white"},Ko={key:0,class:"text-center py-12 text-gray-500"},Uo=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),Go=e("p",null,"No hay productos en el carrito",-1),Wo=e("p",{class:"text-xs text-gray-400 mt-2"},"Busca o escanea un producto para comenzar",-1),Qo=[Uo,Go,Wo],Jo={key:1,class:"divide-y divide-gray-200"},Yo={class:"flex items-start justify-between gap-3"},Zo={class:"flex-1 min-w-0"},en={class:"flex items-center gap-2 mb-1"},tn={key:0,class:"text-xs text-red-600 font-semibold"},sn={class:"font-medium text-sm text-gray-900 mb-1"},on={class:"text-xs text-gray-500"},nn={class:"flex items-center gap-3"},an={class:"flex flex-col items-center gap-1"},ln=e("span",{class:"text-xs text-gray-500"},"Cant",-1),rn={class:"flex items-center gap-1"},cn=["onClick"],dn={class:"w-10 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full font-semibold text-sm"},un=["onClick"],hn={class:"flex flex-col items-end gap-1 min-w-[80px]"},vn=e("span",{class:"text-xs text-gray-500"},"Total",-1),pn={class:"font-semibold text-sm text-gray-900"},_n=["onClick"],mn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),fn=[mn],gn=["onClick"],xn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),bn=[xn],yn={key:0,class:"border-t border-gray-300 bg-white px-4 py-4 flex-shrink-0"},wn={class:"space-y-2 mb-4"},kn={class:"flex justify-between text-sm"},Cn=e("span",{class:"text-gray-700"},"Subtotal:",-1),Mn={class:"font-medium text-green-600"},Tn={class:"flex justify-between text-sm"},jn=e("span",{class:"text-gray-700"},"Descuento:",-1),Sn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),$n={class:"flex justify-between text-sm items-center"},Pn={class:"flex items-center text-gray-700 gap-2 cursor-pointer"},En=e("span",null,"Incluir Envío:",-1),Dn={key:0,class:"relative w-32"},Fn=e("span",{class:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-500"},"$",-1),Nn={key:1,class:"text-gray-500 text-xs italic"},qn={class:"flex justify-between items-center pt-2 border-t border-gray-300"},Vn=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),Ln={class:"text-base font-bold text-green-600"},Bn={class:"flex gap-3"},On={class:"p-6"},Rn=e("h2",{class:"text-lg font-semibold mb-4"},"Confirmar Venta",-1),An={class:"mb-4"},In=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Pago",-1),zn=e("option",{value:"efectivo"},"Efectivo",-1),Xn=e("option",{value:"tarjeta"},"Tarjeta",-1),Hn=e("option",{value:"transferencia"},"Transferencia",-1),Kn=e("option",{value:"mixto"},"Mixto",-1),Un=[zn,Xn,Hn,Kn],Gn={key:0,class:"mb-4 p-4 bg-green-50 rounded-lg border border-green-100"},Wn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Dinero Recibido",-1),Qn={class:"relative"},Jn=e("span",{class:"absolute left-3 top-2 text-gray-500"},"$",-1),Yn=["value"],Zn={key:0,class:"mt-3 flex justify-between items-center text-lg"},ea=e("span",{class:"font-medium text-gray-700"},"Cambio a devolver:",-1),ta={class:"font-bold text-green-700"},sa={class:"mb-4"},oa=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas (Opcional)",-1),na={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded"},aa=e("h4",{class:"text-sm font-semibold text-green-800 mb-2"},"Descuentos por Producto:",-1),la={class:"space-y-1"},ra={class:"text-green-700"},ia={class:"text-green-700 font-medium"},ca={class:"mb-4 p-3 bg-gray-50 rounded"},da={class:"flex justify-between mb-2"},ua=e("span",null,"Subtotal:",-1),ha={key:0,class:"flex justify-between mb-2 text-red-600"},va={key:1,class:"flex justify-between mb-2 text-gray-600"},pa=e("span",null,"Costo de Envío:",-1),_a={class:"flex justify-between font-bold text-lg pt-2 border-t"},ma=e("span",null,"Total:",-1),fa={class:"flex gap-3"},ga={class:"p-6"},xa=e("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"¡Venta registrada exitosamente!",-1),ba={key:0,class:"mb-4"},ya={class:"text-sm text-gray-600 mb-2"},wa={class:"font-semibold"},ka={class:"text-sm text-gray-600 mb-2"},Ca={class:"font-semibold"},Ma={class:"flex gap-2 sm:gap-3 justify-center sm:justify-end"},Ta=e("span",{class:"sm:hidden"},"✕",-1),ja=e("span",{class:"hidden sm:inline"},"Cerrar",-1),Sa=["disabled"],$a={key:0,class:"animate-pulse"},Pa={key:1},Ea=e("span",{class:"hidden sm:inline ml-1"},"Descargar PDF",-1),Da=["disabled"],Fa={key:0,class:"animate-pulse"},Na={key:1},qa=e("span",{class:"hidden sm:inline ml-1"},"Compartir",-1),Va=e("span",{class:"hidden sm:inline ml-1"},"Imprimir",-1),La={id:"invoice-content-pos",class:"fixed top-0 left-0 w-[80mm] bg-white z-[-100] opacity-0 pointer-events-none"},Ba={class:"bg-white text-black p-2 font-mono text-[11px] leading-tight",style:{width:"80mm",margin:"0 auto","font-family":"'Courier New', Courier, monospace"}},Oa={class:"text-center mb-4"},Ra=["src"],Aa={class:"font-bold text-base uppercase mb-1"},Ia={class:"text-[10px] space-y-0.5",style:{"font-size":"10px"}},za={key:0},Xa={key:1,class:"whitespace-normal"},Ha={key:2,class:"whitespace-normal"},Ka={key:3,class:"whitespace-normal"},Ua={key:4,class:"whitespace-normal"},Ga={key:5,class:"whitespace-normal"},Wa={key:6,class:"whitespace-normal break-words"},Qa={key:7,class:"whitespace-normal break-words"},Ja=e("div",{class:"border-b-2 border-dashed border-black my-2"},null,-1),Ya={class:"mb-3 text-[10px] grid grid-cols-2 gap-x-2 gap-y-1"},Za={class:"col-span-2 text-center mb-1"},el={class:"text-sm font-bold"},tl={class:"text-[9px] text-gray-500"},sl=e("span",{class:"font-bold block text-gray-600"},"Vendedor:",-1),ol={class:"text-right"},nl=e("span",{class:"font-bold block text-gray-600"},"Método de Pago:",-1),al={class:"capitalize"},ll={key:0,class:"col-span-2 mt-1 border-t border-dotted border-gray-300 pt-1"},rl=e("span",{class:"font-bold text-gray-600"},"Cliente:",-1),il={key:0},cl=e("span",{class:"font-bold text-gray-600"},"NIT/CC:",-1),dl=e("div",{class:"border-b border-black my-2"},null,-1),ul={class:"mb-4"},hl=e("div",{class:"flex justify-between text-[9px] font-bold mb-2 uppercase text-gray-800"},[e("span",null,"Descripción"),e("span",null,"Total")],-1),vl={class:"font-bold text-[11px] leading-tight mb-0.5"},pl={key:0,class:"text-[9px] text-gray-500 italic mb-1"},_l={class:"flex justify-between items-start text-[10px] mt-1"},ml={class:"flex flex-col"},fl={class:"text-gray-800"},gl={key:0,class:"flex flex-col mt-0.5"},xl={style:{"text-decoration":"line-through",color:"#9ca3af"},class:"text-[9px]"},bl={class:"text-[9px] font-bold text-gray-800"},yl={class:"font-bold text-[11px] mt-0.5"},wl=e("div",{class:"border-t border-black my-2 dashed"},null,-1),kl={class:"text-right text-[11px] space-y-1"},Cl={key:0,class:"flex justify-between text-gray-600"},Ml=e("span",null,"Subtotal",-1),Tl={key:1,class:"flex justify-between text-gray-600"},jl=e("span",null,"Descuento",-1),Sl={key:2,class:"flex justify-between text-gray-600"},$l=e("span",null,"Costo de envío",-1),Pl={class:"flex justify-between text-base font-black pt-1"},El=e("span",null,"TOTAL",-1),Dl={key:3,class:"flex justify-between text-[10px] mt-1 text-green-700 font-bold"},Fl=e("span",null,"Efectivo:",-1),Nl={key:4,class:"flex justify-between text-[10px] text-green-700 font-bold"},ql=e("span",null,"Cambio:",-1),Vl={class:"text-center mt-6 text-[10px] space-y-1 mb-4"},Ll=e("p",{class:"font-medium"},"¡Gracias por su compra!",-1),Bl={key:0,class:"mt-2 pt-2 border-t border-dotted border-gray-300 text-left"},Ol=e("p",{class:"font-bold text-[9px] text-gray-500"},"Notas:",-1),Rl={class:"italic"},Al={class:"p-6"},Il=e("h2",{class:"text-lg font-semibold mb-4"},"Escanear Código de Barras",-1),zl=e("p",{class:"text-sm text-gray-600 mb-4"}," Apunta la cámara hacia el código de barras. El producto se agregará automáticamente al carrito. ",-1),Xl=e("div",{id:"barcode-scanner-sales",class:"w-full rounded-lg overflow-hidden",style:{"min-height":"300px"}},null,-1),Hl={class:"p-6"},Kl={class:"flex items-center justify-between mb-4"},Ul={class:"text-lg font-semibold"},Gl=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Wl=[Gl],Ql={class:"space-y-4"},Jl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cantidad",-1),Yl=["value"],Zl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Valor",-1),er=["value"],tr=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),sr=e("option",{value:"percentage"},"Porcentaje",-1),or=e("option",{value:"amount"},"Monto",-1),nr=[sr,or],ar={class:"block text-sm font-medium text-gray-700 mb-2"},lr=["step","max","placeholder"],rr={key:0,class:"p-4 bg-gray-50 rounded-lg space-y-2"},ir={class:"flex justify-between text-sm"},cr=e("span",{class:"text-gray-700"},"Subtotal:",-1),dr={class:"font-semibold"},ur={class:"flex justify-between text-sm"},hr=e("span",{class:"text-gray-700"},"Descuento:",-1),vr={class:"font-semibold"},pr={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},_r=e("span",null,"Total:",-1),mr={class:"flex gap-3 mt-6"},fr={class:"p-6 max-h-[90vh] flex flex-col"},gr={class:"flex items-center justify-between mb-4 flex-shrink-0"},xr=e("h2",{class:"text-lg font-semibold"},"Catálogo de Productos",-1),br=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),yr=[br],wr={class:"mb-4 relative flex-shrink-0"},kr=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),Cr={class:"mb-4 flex items-center gap-2 overflow-x-auto pb-2 flex-shrink-0"},Mr=["onClick"],Tr={class:"flex-1 overflow-y-auto"},jr={key:0,class:"text-center py-12 text-gray-500"},Sr=e("p",null,"No se encontraron productos",-1),$r=[Sr],Pr={key:1,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"},Er=["onClick"],Dr={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},Fr=["src","alt"],Nr={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),Vr=[qr],Lr={class:"p-2 flex-1 flex flex-col"},Br={class:"mb-1"},Or={class:"text-xs line-through text-red-600"},Rr={class:"text-sm font-bold text-green-600"},Ar={key:1,class:"text-sm font-bold text-gray-900"},Ir={class:"font-medium text-xs text-gray-900 line-clamp-2"},zr={class:"p-6"},Xr={class:"flex items-center justify-between mb-4"},Hr=e("h2",{class:"text-lg font-semibold"},"Descuento general de la factura",-1),Kr=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Ur=[Kr],Gr={class:"space-y-4"},Wr=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),Qr=e("option",{value:"percentage"},"Porcentaje",-1),Jr=e("option",{value:"amount"},"Monto",-1),Yr=[Qr,Jr],Zr={class:"block text-sm font-medium text-gray-700 mb-2"},ei=["step","max","placeholder"],ti={class:"p-4 bg-gray-50 rounded-lg space-y-2"},si={class:"flex justify-between text-sm"},oi=e("span",{class:"text-gray-700"},"Subtotal:",-1),ni={class:"font-semibold"},ai={class:"flex justify-between text-sm"},li=e("span",{class:"text-gray-700"},"Descuento:",-1),ri={class:"font-semibold"},ii={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},ci=e("span",null,"Total:",-1),di={class:"flex gap-3 mt-6"},ui={class:"p-6"},hi={class:"flex items-center justify-between mb-4"},vi=e("h2",{class:"text-lg font-semibold text-red-600"},"⚠️ Stock Insuficiente",-1),pi=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),_i=[pi],mi={class:"mb-4"},fi=["innerHTML"],gi={class:"flex justify-end"},$i={__name:"Index",props:{sales:Object,stats:Object,filters:Object,products:Array,categories:Array,store:Object},setup(v){const D=v,ke=Pe(),et=U(()=>(ke.props.auth?.roles||[]).includes("physical-sales")),Ne=()=>{et.value?pe.post(route("logout"),{},{onSuccess:()=>{window.location.href=route("login")},onError:()=>{window.location.href=route("login")}}):pe.visit(route("dashboard"))},Ce=h("sales");bt({start_date:D.filters?.start_date||"",end_date:D.filters?.end_date||"",search:D.filters?.search||""});const qe=h("");h(!1);const p=h(null),re=h(!1),z=h(!1),tt=async()=>{if(p.value){z.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await St(o,`factura-${p.value.sale_number}.pdf`)}catch(o){console.error(o),alert("Error al generar el PDF")}finally{z.value=!1}}},st=async()=>{if(p.value){z.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await $t(o,`factura-${p.value.sale_number}.pdf`,`Factura #${p.value.sale_number}`)}catch(o){console.error(o)}finally{z.value=!1}}},fe=h(!1),Ve=h(null),ot=o=>{Ve.value=o,fe.value=!0},nt=(o,s)=>{de(o,s)},se=o=>{if(o.variants&&o.variants.length>0&&o.variant_options&&o.variant_options.length>0){if(o.variants.reduce((t,n)=>t+(Number(n.stock)||0),0)===0&&(Number(o.quantity)||0)>0){de(o);return}ot(o)}else de(o)},d=o=>!o&&o!==0?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),at=o=>new Date(o).toLocaleString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),lt=o=>{o&&pe.visit(route("admin.physical-sales.show",o.id)+"?print=true")};U(()=>{if(!D.sales||!D.sales.data)return[];const o=new Date;o.setHours(0,0,0,0);const s=new Date(o);s.setHours(23,59,59,999);let t=D.sales.data.filter(n=>{const i=new Date(n.created_at);return i>=o&&i<=s});if(qe.value.trim()){const n=qe.value.toLowerCase();t=t.filter(i=>i.sale_number.toLowerCase().includes(n))}return t});const c=h([]),x=h(""),Me=h(null),R=h([]),Le=h(!1),W=()=>{window.innerWidth>=1024&&Ze(()=>{Me.value&&Me.value.focus()})},ie=h(!1),Be=h(""),X=h(!1),oe=h("efectivo"),q=h(0);we(X,o=>{o&&(q.value=0)});const ge=h(""),V=h(0),F=h("amount"),N=h(null);h(null),h(!1),h(!1);const Q=h(!1),J=h(!1),ne=h(!1),_=h(null),$=h("percentage"),P=h(0),H=h(!1),xe=h(""),Y=h(null),rt=U(()=>{if($.value==="percentage")return 100;if(_.value===null)return 0;const o=c.value[_.value];return o&&(o.original_price||o.unit_price)||0}),it=U(()=>{if(oe.value!=="efectivo"||!q.value)return 0;const o=parseFloat(q.value);return Math.max(0,o-ae.value)}),ce=h(!1),be=h(!1),ct=()=>{be.value=!0},Te=()=>{try{const o=new(window.AudioContext||window.webkitAudioContext),s=o.createOscillator(),t=o.createGain();s.connect(t),t.connect(o.destination),s.frequency.value=800,s.type="sine",t.gain.setValueAtTime(.3,o.currentTime),t.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),s.start(o.currentTime),s.stop(o.currentTime+.2)}catch{}},K=U(()=>c.value.reduce((o,s)=>o+s.quantity*s.unit_price,0)),Z=U(()=>F.value==="percentage"?K.value*V.value/100:V.value),L=h(!1),B=h(0);Je(()=>{D.store?.delivery_cost_active}),we(L,o=>{o&&B.value===0&&D.store?.delivery_cost&&(B.value=parseFloat(D.store.delivery_cost))});const ae=U(()=>{let o=K.value-Z.value;return L.value&&(o+=parseFloat(B.value)||0),o}),ye=U(()=>{if(!D.products)return[];let o=D.products;if(N.value&&(o=o.filter(s=>s.category_id===N.value)),x.value.trim()){const s=x.value.toLowerCase();o=o.filter(t=>t.name.toLowerCase().includes(s)||t.id.toString().includes(s)||t.barcode&&t.barcode.toLowerCase().includes(s)||t.variant_options&&t.variant_options.some(n=>n.children&&n.children.some(i=>i.name.toLowerCase().includes(s)||i.barcode&&i.barcode.toLowerCase().includes(s)))||t.variants&&t.variants.some(n=>n.sku&&n.sku.toLowerCase().includes(s)||n.options&&Object.values(n.options).some(i=>String(i).toLowerCase().includes(s))))}return o}),le=async()=>{if(!x.value.trim()){R.value=[];return}Le.value=!0;try{const s=(await window.axios.get(route("admin.physical-sales.search-products"),{params:{q:x.value}})).data?.products||[];R.value=s,s.length===1&&window.innerWidth<1024&&(se(s[0]),x.value="",R.value=[])}catch{R.value=[]}finally{Le.value=!1}},Oe=async o=>{const s=o.replace(/\s+/g,"").trim();if(s)try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(E=>E.options&&Object.values(E.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?(de(n,f),Be.value=""):(se(n),Be.value="")}else alert("Producto no encontrado con ese código de barras"),W()}catch{alert("Error al buscar producto"),W()}},O=(o,s=null)=>{const t=s?.price??o.price;let n=parseFloat(t),i=0;return o.promo_active&&o.promo_discount_percent>0&&(i=parseFloat(o.promo_discount_percent),n=Math.round(n*(100-i)/100)),{originalPrice:parseFloat(t),finalPrice:n,discountPercent:i}},de=(o,s=null)=>{const t=c.value.find(n=>n.product_id===o.id&&n.variant_id===(s?.id||null));if(t)t.quantity+=1;else{const n=O(o,s);c.value.push({product_id:o.id,product_name:o.name,variant_id:s?.id||null,variant_options:s?.options||null,quantity:1,unit_price:n.finalPrice,original_price:n.originalPrice,discount_percent:n.discountPercent,product:o,variant:s})}x.value="",R.value=[],W()},A=o=>{if(o.product){const s=o.product.track_inventory;if(!s||s==="0"||s===0||s===!1)return"Ilimitado"}return o.variant&&o.variant.stock!==null&&o.variant.stock!==void 0?o.variant.stock:o.product&&o.product.quantity!==null&&o.product.quantity!==void 0?o.product.quantity:"N/A"},je=o=>{const s=A(o);return s==="Ilimitado"||s==="N/A"?!0:s>=o.quantity},dt=o=>{if(!je(o))return"bg-red-50";const s=A(o);return s===0||typeof s=="number"&&s<o.quantity?"bg-yellow-50":""},Re=o=>{const s=A(o);return s===0||typeof s=="number"&&s<o.quantity?"text-red-600 font-semibold text-xs":typeof s=="number"&&s<5?"text-yellow-600 font-medium text-xs":"text-gray-600 text-xs"},ut=()=>{c.value=[],V.value=0,F.value="amount",W()},Ae=o=>{c.value.splice(o,1),W()},Ie=(o,s)=>{const t=c.value[o],n=t.quantity+s;if(n>0){const i=A(t);if(typeof i=="number"&&n>i){xe.value=`No hay suficiente stock para el producto "${t.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${n}`,H.value=!0;return}t.quantity=n}},ht=(o,s)=>{const t=parseInt(s.target.value);if(t>0){const n=c.value[o],i=A(n);if(typeof i=="number"&&t>i){xe.value=`No hay suficiente stock para el producto "${n.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${t}`,H.value=!0,s.target.value=n.quantity;return}c.value[o].quantity=t}},ue=o=>o==null||o===""?"":new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:!0}).format(o),ze=o=>{if(typeof o=="number")return o;if(!o)return 0;const s=o.toString().replace(/\./g,"").replace(/[^0-9]/g,"");return parseFloat(s)||0},vt=(o,s)=>{let t=s.target.value;const n=ze(t),i=c.value[o];i.discount_percent>0?(i.unit_price=n,i.original_price=n/(1-i.discount_percent/100)):(i.unit_price=n,i.original_price=n),t!==""&&(s.target.value=ue(n))},pt=o=>{let s=o.target.value;const t=ze(s);q.value=t,s!==""&&(o.target.value=ue(t))},_t=(o,s)=>{let t=parseFloat(s.target.value)||0;t=Math.round(t*100)/100;const n=Math.min(100,Math.max(0,t)),i=c.value[o];i.original_price||(i.original_price=i.unit_price),i.discount_type="percentage",i.discount_value=n,i.discount_percent=n,i.unit_price=i.original_price*(1-n/100),t!==n&&(s.target.value=n)},Se=o=>{_.value=o;const s=c.value[o];s.discount_type?($.value=s.discount_type,P.value=s.discount_value||0):s.discount_percent>0?($.value="percentage",P.value=s.discount_percent):($.value="percentage",P.value=0),Q.value=!0},mt=()=>{if(_.value===null)return;const o=c.value[_.value];o.original_price||(o.original_price=o.unit_price);const s=o.original_price;if($.value==="percentage"){const t=Math.min(100,Math.max(0,P.value)),n=Math.round(t*100)/100;o.discount_type="percentage",o.discount_value=n,o.discount_percent=n,o.unit_price=s*(1-n/100)}else{const t=Math.min(s,Math.max(0,P.value));o.discount_type="amount",o.discount_value=t,o.discount_percent=t/s*100,o.unit_price=s-t}Q.value=!1,_.value=null,P.value=0},Xe=()=>{J.value=!0},ft=()=>{J.value=!1},He=async()=>{try{ie.value=!0,await Ze();const{Html5Qrcode:o}=await Tt(async()=>{const{Html5Qrcode:n}=await import("./index-DT4PNOCT.js");return{Html5Qrcode:n}},__vite__mapDeps([0,1,2])),s=document.getElementById("barcode-scanner-sales");if(!s)return;Y.value=new o(s.id);const t={fps:10,qrbox:{width:250,height:250}};try{await Y.value.start({facingMode:"environment"},t,async n=>{Te(),await Oe(n),he()},n=>{})}catch{try{await Y.value.start({facingMode:"user"},t,async i=>{Te(),await Oe(i),he()},i=>{})}catch{alert("No se pudo acceder a la cámara. Por favor, permite el acceso a la cámara en la configuración del navegador."),ie.value=!1}}}catch{alert("Error al inicializar el escáner. Por favor, intenta nuevamente."),ie.value=!1}},he=async()=>{if(Y.value){try{await Y.value.stop(),await Y.value.clear()}catch{}Y.value=null}ie.value=!1},ve=()=>{const o=document.head.querySelector('meta[name="csrf-token"]');if(o&&o.content)return window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=o.content,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=o.content),o.content;const t=(n=>{const f=`; ${document.cookie}`.split(`; ${n}=`);return f.length===2?f.pop().split(";").shift():null})("XSRF-TOKEN");if(t&&window.axios){const n=decodeURIComponent(t);return window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,n}return null};Je(()=>{W(),setTimeout(()=>{ve(),window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{ve()},300)},100)}),pe.on("finish",()=>{setTimeout(()=>{const s=Pe().props.csrf_token;if(s){const t=document.head.querySelector('meta[name="csrf-token"]');t&&t.setAttribute("content",s),window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=s,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=s)}ve(),window.updateCsrfToken&&window.updateCsrfToken()},200)});const gt=async()=>{if(c.value.length===0){alert("El carrito está vacío");return}const o=[];for(let t=0;t<c.value.length;t++){const n=c.value[t];if(!je(n)){const i=A(n);o.push({name:n.product_name,requested:n.quantity,available:i})}}if(o.length>0){let t=`No se puede procesar la venta. Los siguientes productos no tienen stock suficiente:

`;o.forEach(n=>{t+=`• ${n.name}: Solicitado ${n.requested}, Disponible ${n.available}
`}),xe.value=t.replace(/\n/g,"<br>"),H.value=!0;return}const s={items:c.value.map(t=>({product_id:t.product_id,variant_id:t.variant_id,quantity:t.quantity,unit_price:t.unit_price,original_price:t.original_price,discount_percent:t.discount_percent})),subtotal:K.value,tax:0,discount:Z.value,total:ae.value,delivery_cost:L.value&&parseFloat(B.value)||0,payment_method:oe.value,notes:ge.value};try{if(!window.axios){alert("Error: No se pudo inicializar la conexión. Por favor, recarga la página.");return}let n=Pe().props.csrf_token;if(n){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",n)}else n=ve();if(n||(await new Promise(m=>setTimeout(m,200)),n=ve()),!n){alert("Error: No se pudo obtener el token de seguridad. Por favor, recarga la página.");return}window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n;const i=()=>{const m=document.head.querySelector('meta[name="csrf-token"]');if(m&&m.content)return m.content;const w=(M=>{const Qe=`; ${document.cookie}`.split(`; ${M}=`);return Qe.length===2?Qe.pop().split(";").shift():null})("XSRF-TOKEN");return w?decodeURIComponent(w):null},f=async(m=0)=>{try{let C=i();if(!C&&m===0)try{const M=await window.axios.get(route("dashboard"),{headers:{"X-Requested-With":"XMLHttpRequest"}});await new Promise(T=>setTimeout(T,100)),C=i()}catch{}if(!C)throw new Error("No se pudo obtener el token CSRF. Por favor, recarga la página.");window.axios.defaults.headers.common["X-CSRF-TOKEN"]=C,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=C;const w=await window.axios.post(route("admin.physical-sales.store"),s,{headers:{"X-CSRF-TOKEN":C,"X-XSRF-TOKEN":C,"X-Requested-With":"XMLHttpRequest"}});if(w&&w.headers){const M=w.headers["x-csrf-token"]||w.headers["X-CSRF-TOKEN"];if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}}return w}catch(C){if(C.response){if(C.response.status===419&&m===0){const w=C.response.headers||{},M=w["x-csrf-token"]||w["X-CSRF-TOKEN"]||null;if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}else{const T=i();T&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=T)}return await new Promise(T=>setTimeout(T,200)),await f(1)}}else if(m===0){const w=i();return w&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=w),await new Promise(M=>setTimeout(M,200)),await f(1)}throw C}},k=await f(),E=k.headers?.["x-csrf-token"]||k.headers?.["X-CSRF-TOKEN"];if(E){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",E),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=E}k.data&&k.data.success?(p.value=k.data.sale,X.value=!1,c.value=[],x.value="",V.value=0,F.value="amount",ge.value="",oe.value="efectivo",N.value=null,window.updateCsrfToken&&window.updateCsrfToken(),re.value=!0,pe.reload()):alert("Error: "+(k.data?.message||"No se pudo procesar la venta"))}catch(t){console.error("Error completo al procesar la venta:",{error:t,message:t.message,response:t.response,status:t.response?.status,data:t.response?.data,headers:t.response?.headers});let n="Error al procesar la venta";if(t.response){const i=t.response.status,f=t.response.data;i===419?(n="Tu sesión ha expirado. Por favor, recarga la página e intenta nuevamente.",window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{window.location.reload()},2e3)):i===422?f?.message?n=f.message:f?.errors?n=`Error de validación:
${Object.entries(f.errors).map(([E,m])=>Array.isArray(m)?`${E}: ${m.join(", ")}`:`${E}: ${m}`).join(`
`)}`:n="Error de validación. Verifica los datos e intenta nuevamente.":f?.message?n=f.message:n=`Error del servidor (${i}). Por favor, intenta nuevamente.`}else t.request?n="No se pudo conectar con el servidor. Verifica tu conexión a internet.":t.message&&(n=t.message);alert(n)}};yt(()=>{he()});let Ke;we(x,async o=>{clearTimeout(Ke);const s=o.replace(/\s+/g,"").trim();if(s.length>=8&&/^\d+$/.test(s))try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(E=>E.options&&Object.values(E.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?de(n,f):se(n),x.value="",Te();return}}catch{}Ke=setTimeout(()=>{x.value.trim().length>=2?le():R.value=[]},300)}),we([fe,ne,Q,J,X,re,ce,H],(o,s)=>{o.some((n,i)=>!n&&s[i])&&setTimeout(()=>{W()},150)});const Ue=h(50),$e=h(!1),xt=()=>{$e.value=!0,document.addEventListener("mousemove",Ge),document.addEventListener("mouseup",We),document.body.style.userSelect="none",document.body.style.cursor="col-resize"},Ge=o=>{if(!$e.value)return;const s=window.innerWidth,t=o.clientX/s*100;t>20&&t<80&&(Ue.value=t)},We=()=>{$e.value=!1,document.removeEventListener("mousemove",Ge),document.removeEventListener("mouseup",We),document.body.style.userSelect="",document.body.style.cursor=""};return(o,s)=>(a(),l(S,null,[g(Ee(wt),{title:"Ventas Físicas"}),g(jt,null,{header:y(()=>[Ce.value!=="sales"?(a(),l("h2",Ft,"Ventas Físicas")):u("",!0)]),default:y(()=>[Ce.value==="sales"?(a(),l("div",Nt,[e("div",{style:kt({width:Ue.value+"%"}),class:"h-full flex flex-col border-r border-gray-300"},[e("div",qt,[e("div",Vt,[e("button",{onClick:Ne,class:"px-3 py-2 bg-white text-gray-700 rounded-lg hover:bg-gray-100 text-sm font-medium flex items-center gap-2 border border-gray-200"},[Lt,b(" Salir ")]),e("button",{onClick:s[0]||(s[0]=t=>ce.value=!0),class:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 text-sm font-medium flex items-center gap-2 border border-red-200",title:"Registrar Gasto / Salida"},[Bt,b(" Gasto ")]),e("div",Ot,[j(e("input",{ref_key:"searchInput",ref:Me,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:De(le,["enter"])},null,544),[[G,x.value]]),Rt,e("button",{onClick:He,class:"absolute right-2 top-1.5 p-1 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},It)])]),e("div",zt,[e("button",{onClick:s[2]||(s[2]=t=>{N.value=null,x.value=""}),class:ee(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",N.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(S,null,I(v.categories,t=>(a(),l("button",{key:t.id,onClick:n=>{N.value=t.id,x.value=""},class:ee(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",N.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,Xt))),128))])]),e("div",Ht,[ye.value.length===0?(a(),l("div",Kt,Gt)):(a(),l("div",Wt,[(a(!0),l(S,null,I(ye.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>se(t)},[e("div",Jt,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,Yt)):(a(),l("svg",Zt,ts))]),e("div",ss,[e("div",os,[t.promo_active&&t.promo_discount_percent>0?(a(),l(S,{key:0},[e("p",ns,r(d(O(t).originalPrice)),1),e("p",as,r(d(O(t).finalPrice)),1)],64)):(a(),l("p",ls,r(d(O(t).finalPrice)),1))]),e("h3",{class:"font-medium text-xs text-gray-900 line-clamp-2",title:t.name},r(t.name),9,rs)])],8,Qt))),128))]))])],4),e("div",{class:"w-1 hover:w-2 bg-gray-200 hover:bg-blue-400 cursor-col-resize flex items-center justify-center transition-all z-20 group",onMousedown:xt,title:"Arrastra para ajustar el tamaño"},cs,32),e("div",ds,[e("div",us,[e("div",hs,[vs,e("span",ps,r(Ee(ke).props.auth?.user?.name||"Usuario"),1),_s,v.store&&v.store.logo_url?(a(),l("img",{key:0,src:v.store.logo_url,alt:`Logo de ${v.store.name}`,class:"h-6 w-6 rounded-full object-cover"},null,8,ms)):u("",!0),v.store?(a(),l("span",fs,r(v.store.name),1)):u("",!0)])]),e("div",gs,[c.value.length===0?(a(),l("div",xs,ws)):(a(),l("div",ks,[e("table",Cs,[Ms,e("tbody",Ts,[(a(!0),l(S,null,I(c.value,(t,n)=>(a(),l("tr",{key:n,class:ee(["hover:bg-gray-50",dt(t)])},[e("td",{class:"px-3 py-3 text-left align-middle",title:t.product_name},[e("div",Ss,[e("div",$s,[b(r(t.product_name)+" ",1),t.variant_options?(a(),l("span",Ps," ("+r(Object.values(t.variant_options).join(" / "))+") ",1)):u("",!0)])])],8,js),e("td",{class:"px-3 py-3 text-center align-middle w-16",title:`Stock disponible: ${A(t)}`},[e("span",{class:ee(Re(t))},r(A(t)),3)],8,Es),e("td",{class:"px-3 py-3 text-center align-middle w-20",title:`Cantidad: ${t.quantity}`},[e("input",{type:"number",value:t.quantity,onChange:i=>ht(n,i),class:"w-full text-center border border-gray-300 rounded text-sm py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1"},null,40,Fs)],8,Ds),e("td",{class:"px-3 py-3 text-right align-middle w-40",title:`Precio unitario: ${d(t.unit_price)}`},[e("input",{type:"text",value:ue(t.original_price||t.unit_price),onInput:i=>vt(n,i),class:"w-full text-right border border-gray-300 rounded text-sm py-2 px-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"},null,40,qs)],8,Ns),e("td",{class:"px-3 py-3 text-right align-middle w-32",title:t.discount_type==="amount"?`Descuento: $${t.discount_value}`:`Descuento: ${t.discount_percent}%`},[t.discount_type==="amount"?(a(),l("button",{key:0,onClick:i=>Se(n),class:"w-full text-right border border-blue-200 bg-blue-50 text-blue-700 font-semibold rounded text-sm py-2 px-2 hover:bg-blue-100 transition-colors"}," $ "+r(ue(t.discount_value)),9,Ls)):(a(),l("div",Bs,[e("input",{type:"number",value:t.discount_percent,onChange:i=>_t(n,i),onClick:Ct(i=>Se(n),["self"]),class:"w-full text-right border border-gray-300 rounded text-sm py-2 pl-2 pr-6 cursor-pointer focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"},null,40,Os),Rs]))],8,Vs),e("td",{class:"px-3 py-3 text-right align-middle w-36",title:`Subtotal: ${d(t.quantity*t.unit_price)}`},[e("span",Is,r(d(t.quantity*t.unit_price)),1)],8,As),e("td",zs,[e("button",{onClick:i=>Ae(n),class:"flex items-center justify-center w-8 h-8 bg-red-500 text-white rounded hover:bg-red-600 transition-colors mx-auto",title:"Eliminar producto"},Ks,8,Xs)])],2))),128))])])]))]),c.value.length>0?(a(),l("div",Us,[e("div",Gs,[Ws,e("span",Qs,r(d(K.value)),1)]),e("div",Js,[Ys,e("span",{onClick:Xe,class:"font-medium cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(V.value>0?"-"+d(Z.value):d(0))+" ",1),Zs])]),e("div",eo,[e("label",to,[j(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=t=>L.value=t),class:"rounded border-gray-300 text-blue-600 shadow-sm focus:ring-blue-500 w-4 h-4"},null,512),[[Ye,L.value]]),so]),L.value?(a(),l("div",oo,[no,j(e("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=t=>B.value=t),class:"w-full text-right border border-gray-300 rounded text-sm py-1 pl-6 pr-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"},null,512),[[G,B.value]])])):(a(),l("span",ao,"No aplica"))]),e("div",lo,[e("div",ro,[io,e("span",co,r(d(ae.value)),1)]),e("div",uo,[e("button",{onClick:s[5]||(s[5]=t=>X.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base"}," Procesar Venta "),e("button",{onClick:ut,class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base border border-red-300"}," Cancelar ")])])])):u("",!0)])])):u("",!0),Ce.value==="sales"?(a(),l("div",ho,[e("div",vo,[e("div",po,[e("div",_o,[mo,e("span",fo,r(Ee(ke).props.auth?.user?.name||"Usuario"),1),go,v.store&&v.store.logo_url?(a(),l("img",{key:0,src:v.store.logo_url,alt:`Logo de ${v.store.name}`,class:"h-5 w-5 rounded-full object-cover"},null,8,xo)):u("",!0),v.store?(a(),l("span",bo,r(v.store.name),1)):u("",!0)]),e("button",{onClick:Ne,class:"px-3 py-1.5 bg-teal-500 text-white rounded text-sm font-medium"}," « Regresar ")])]),e("div",yo,[e("div",wo,[e("button",{onClick:s[6]||(s[6]=t=>ne.value=!0),class:"px-3 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center flex-shrink-0",title:"Ver catálogo de productos"},Co),e("button",{onClick:s[7]||(s[7]=t=>ce.value=!0),class:"px-3 py-2.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 flex items-center justify-center flex-shrink-0 border border-red-200",title:"Registrar Gasto"},To),e("div",jo,[j(e("input",{"onUpdate:modelValue":s[8]||(s[8]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:De(le,["enter"]),onInput:le},null,544),[[G,x.value]]),So,e("button",{onClick:He,class:"absolute right-2 top-2 p-1.5 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},Po)])]),R.value.length>0&&x.value.trim()?(a(),l("div",Eo,[(a(!0),l(S,null,I(R.value,t=>(a(),l("div",{key:t.id,onClick:n=>{se(t),x.value="",R.value=[]},class:"px-4 py-3 border-b border-gray-100 hover:bg-blue-50 cursor-pointer flex items-center gap-3"},[e("div",Fo,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover rounded"},null,8,No)):(a(),l("svg",qo,Lo))]),e("div",Bo,[e("p",Oo,r(t.name),1),e("div",null,[t.promo_active&&t.promo_discount_percent>0?(a(),l(S,{key:0},[e("p",Ro,r(d(O(t).originalPrice)),1),e("p",Ao,r(d(O(t).finalPrice)),1)],64)):(a(),l("p",Io,r(d(O(t).finalPrice)),1))])]),zo],8,Do))),128))])):u("",!0)]),Xo,e("div",Ho,[c.value.length===0?(a(),l("div",Ko,Qo)):(a(),l("div",Jo,[(a(!0),l(S,null,I(c.value,(t,n)=>(a(),l("div",{key:n,class:"px-4 py-3 bg-white"},[e("div",Yo,[e("div",Zo,[e("div",en,[e("span",{class:ee(Re(t))}," Stock: "+r(A(t)),3),je(t)?u("",!0):(a(),l("span",tn," ⚠ Sin stock "))]),e("p",sn,r(t.product_name),1),e("p",on,r(d(t.unit_price)),1)]),e("div",nn,[e("div",an,[ln,e("div",rn,[e("button",{onClick:i=>Ie(n,-1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," - ",8,cn),e("span",dn,r(t.quantity),1),e("button",{onClick:i=>Ie(n,1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," + ",8,un)])]),e("div",hn,[vn,e("span",pn,r(d(t.quantity*t.unit_price)),1)]),e("button",{onClick:i=>Se(n),class:"w-8 h-8 flex items-center justify-center bg-gray-200 text-gray-600 rounded hover:bg-gray-300",title:"Aplicar descuento"},fn,8,_n),e("button",{onClick:i=>Ae(n),class:"w-8 h-8 flex items-center justify-center bg-red-500 text-white rounded hover:bg-red-600"},bn,8,gn)])])]))),128))]))]),c.value.length>0?(a(),l("div",yn,[e("div",wn,[e("div",kn,[Cn,e("span",Mn,r(d(K.value)),1)]),e("div",Tn,[jn,e("span",{onClick:Xe,class:"font-medium text-green-600 cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(V.value>0?"-"+d(Z.value):d(0))+" ",1),Sn])]),e("div",$n,[e("label",Pn,[j(e("input",{type:"checkbox","onUpdate:modelValue":s[9]||(s[9]=t=>L.value=t),class:"rounded border-gray-300 text-blue-600 shadow-sm focus:ring-blue-500 w-4 h-4"},null,512),[[Ye,L.value]]),En]),L.value?(a(),l("div",Dn,[Fn,j(e("input",{type:"number","onUpdate:modelValue":s[10]||(s[10]=t=>B.value=t),class:"w-full text-right border border-gray-300 rounded text-sm py-1 pl-6 pr-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",min:"0"},null,512),[[G,B.value]])])):(a(),l("span",Nn,"No aplica"))]),e("div",qn,[Vn,e("span",Ln,r(d(ae.value)),1)])]),e("div",Bn,[e("button",{onClick:s[11]||(s[11]=t=>X.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base transition-colors"}," PROCESAR VENTA "),e("button",{onClick:s[12]||(s[12]=t=>{c.value=[],V.value=0,F.value="amount"}),class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base transition-colors border border-red-300"}," CANCELAR ")])])):u("",!0)])):u("",!0),g(te,{show:X.value,onClose:s[16]||(s[16]=t=>X.value=!1)},{default:y(()=>[e("div",On,[Rn,e("div",An,[In,j(e("select",{"onUpdate:modelValue":s[13]||(s[13]=t=>oe.value=t),class:"w-full rounded-md border-gray-300"},Un,512),[[Fe,oe.value]])]),oe.value==="efectivo"?(a(),l("div",Gn,[Wn,e("div",Qn,[Jn,e("input",{value:ue(q.value),onInput:pt,type:"text",inputmode:"numeric",class:"w-full pl-7 rounded-md border-gray-300 focus:ring-green-500 focus:border-green-500 font-bold text-lg",placeholder:"0"},null,40,Yn)]),q.value?(a(),l("div",Zn,[ea,e("span",ta,r(d(it.value)),1)])):u("",!0)])):u("",!0),e("div",sa,[oa,j(e("textarea",{"onUpdate:modelValue":s[14]||(s[14]=t=>ge.value=t),class:"w-full rounded-md border-gray-300",rows:"3",placeholder:"Notas adicionales sobre la venta..."},null,512),[[G,ge.value]])]),c.value.some(t=>t.discount_percent>0)?(a(),l("div",na,[aa,e("div",la,[(a(!0),l(S,null,I(c.value.filter(t=>t.discount_percent>0),(t,n)=>(a(),l("div",{key:n,class:"flex justify-between text-sm"},[e("span",ra,r(t.product_name)+":",1),e("span",ia,"-"+r(t.discount_percent)+"% ("+r(d((t.original_price-t.unit_price)*t.quantity))+")",1)]))),128))])])):u("",!0),e("div",ca,[e("div",da,[ua,e("span",null,r(d(K.value)),1)]),Z.value>0?(a(),l("div",ha,[e("span",null,"Descuento ("+r(F.value==="percentage"?V.value+"%":"Monto")+"):",1),e("span",null,"-"+r(d(Z.value)),1)])):u("",!0),L.value&&parseFloat(B.value)>0?(a(),l("div",va,[pa,e("span",null,r(d(B.value)),1)])):u("",!0),e("div",_a,[ma,e("span",null,r(d(ae.value)),1)])]),e("div",fa,[g(_e,{onClick:s[15]||(s[15]=t=>X.value=!1)},{default:y(()=>[b("Cancelar")]),_:1}),g(me,{onClick:gt},{default:y(()=>[b("Confirmar Venta")]),_:1})])])]),_:1},8,["show"]),g(te,{show:re.value,onClose:s[19]||(s[19]=t=>re.value=!1)},{default:y(()=>[e("div",ga,[xa,p.value?(a(),l("div",ba,[e("p",ya,[b(" Número de venta: "),e("span",wa,"#"+r(p.value.sale_number),1)]),e("p",ka,[b(" Total: "),e("span",Ca,r(d(p.value.total)),1)])])):u("",!0),e("div",Ma,[g(_e,{onClick:s[17]||(s[17]=t=>re.value=!1),class:"!px-3 sm:!px-4"},{default:y(()=>[Ta,ja]),_:1}),p.value?(a(),l("button",{key:0,onClick:tt,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:z.value,title:"Descargar PDF"},[z.value?(a(),l("span",$a,"⏳")):(a(),l("span",Pa,[b("⬇️ "),Ea]))],8,Sa)):u("",!0),p.value?(a(),l("button",{key:1,onClick:st,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:z.value,title:"Compartir Factura"},[z.value?(a(),l("span",Fa,"⏳")):(a(),l("span",Na,[b("🔗 "),qa]))],8,Da)):u("",!0),p.value?(a(),Mt(me,{key:2,onClick:s[18]||(s[18]=t=>lt(p.value)),class:"!px-3 sm:!px-4",title:"Imprimir Factura"},{default:y(()=>[b(" 🖨️ "),Va]),_:1})):u("",!0)]),e("div",La,[e("div",Ba,[e("div",Oa,[v.store?.logo_url?(a(),l("img",{key:0,src:v.store.logo_url,alt:"Logo",class:"h-12 w-auto object-contain mx-auto mb-2 grayscale",crossorigin:"anonymous"},null,8,Ra)):u("",!0),e("h2",Aa,r(v.store?.name),1),e("div",Ia,[v.store?.nit?(a(),l("p",za,"NIT: "+r(v.store.nit),1)):u("",!0),v.store?.address?(a(),l("p",Xa,r(v.store.address),1)):u("",!0),v.store?.address_two?(a(),l("p",Ha,r(v.store.address_two),1)):u("",!0),v.store?.address_three?(a(),l("p",Ka,r(v.store.address_three),1)):u("",!0),v.store?.address_four?(a(),l("p",Ua,r(v.store.address_four),1)):u("",!0),v.store?.phone?(a(),l("p",Ga,"Tel: "+r(v.store.phone?.startsWith("57")?v.store.phone.substring(2):v.store.phone),1)):u("",!0),v.store?.email?(a(),l("p",Wa,r(v.store.email),1)):u("",!0),v.store?.custom_domain?(a(),l("p",Qa,r(v.store.custom_domain),1)):u("",!0)])]),Ja,e("div",Ya,[e("div",Za,[e("p",el,"Venta #"+r(p.value?.sale_number),1),e("p",tl,r(p.value?at(p.value.created_at):""),1)]),e("div",null,[sl,e("span",null,r(p.value?.user?.name||o.$page.props.auth.user.name),1)]),e("div",ol,[nl,e("span",al,r(p.value?.payment_method),1)]),p.value?.customer_name?(a(),l("div",ll,[e("p",null,[rl,b(" "+r(p.value.customer_name),1)]),p.value.customer_nit?(a(),l("p",il,[cl,b(" "+r(p.value.customer_nit),1)])):u("",!0)])):u("",!0)]),dl,e("div",ul,[hl,(a(!0),l(S,null,I(p.value?.items,t=>(a(),l("div",{key:t.id,class:"mb-3 border-b border-gray-200 last:border-0 pb-2"},[e("div",vl,r(t.product_name),1),t.variant_options?(a(),l("div",pl,r(Object.values(t.variant_options).join(" / ")),1)):u("",!0),e("div",_l,[e("div",ml,[e("span",fl,r(t.quantity)+" x "+r(d(t.unit_price)),1),t.discount_percent>0||t.original_price&&t.original_price>t.unit_price?(a(),l("div",gl,[e("span",xl," Precio habitual: "+r(d(t.original_price||t.unit_price*100/(100-t.discount_percent))),1),e("span",bl," Desc: "+r(t.discount_percent||Math.round((1-t.unit_price/t.original_price)*100))+"% ",1)])):u("",!0)]),e("div",yl,r(d(t.subtotal)),1)])]))),128))]),wl,e("div",kl,[p.value?.discount>0?(a(),l("div",Cl,[Ml,e("span",null,r(d(p.value.subtotal)),1)])):u("",!0),p.value?.discount>0?(a(),l("div",Tl,[jl,e("span",null,"-"+r(d(p.value.discount)),1)])):u("",!0),parseFloat(p.value?.delivery_cost)>0?(a(),l("div",Sl,[$l,e("span",null,r(d(p.value.delivery_cost)),1)])):u("",!0),e("div",Pl,[El,e("span",null,r(d(p.value?.total)),1)]),q.value>0&&p.value?(a(),l("div",Dl,[Fl,e("span",null,r(d(q.value)),1)])):u("",!0),q.value>p.value?.total?(a(),l("div",Nl,[ql,e("span",null,r(d(q.value-p.value.total)),1)])):u("",!0)]),e("div",Vl,[Ll,p.value?.notes?(a(),l("div",Bl,[Ol,e("p",Rl,r(p.value.notes),1)])):u("",!0)])])])])]),_:1},8,["show"]),g(te,{show:ie.value,onClose:he},{default:y(()=>[e("div",Al,[Il,zl,Xl,g(_e,{onClick:he,class:"mt-4"},{default:y(()=>[b("Cerrar")]),_:1})])]),_:1},8,["show"]),g(te,{show:Q.value,onClose:s[24]||(s[24]=t=>Q.value=!1)},{default:y(()=>[e("div",Hl,[e("div",Kl,[e("h2",Ul,r(_.value!==null?c.value[_.value]?.product_name:"Descuento de Producto"),1),e("button",{onClick:s[20]||(s[20]=t=>Q.value=!1),class:"text-gray-400 hover:text-gray-600"},Wl)]),e("div",Ql,[e("div",null,[Jl,e("input",{type:"number",value:_.value!==null?c.value[_.value]?.quantity:1,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,Yl)]),e("div",null,[Zl,e("input",{type:"number",value:_.value!==null?c.value[_.value]?.original_price||c.value[_.value]?.unit_price:0,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,er)]),e("div",null,[tr,j(e("select",{"onUpdate:modelValue":s[21]||(s[21]=t=>$.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},nr,512),[[Fe,$.value]])]),e("div",null,[e("label",ar," Descuento "+r($.value==="percentage"?"%":""),1),j(e("input",{"onUpdate:modelValue":s[22]||(s[22]=t=>P.value=t),type:"number",step:($.value==="percentage","0.01"),min:0,max:rt.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:$.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,lr),[[G,P.value,void 0,{number:!0}]])]),_.value!==null?(a(),l("div",rr,[e("div",ir,[cr,e("span",dr,r(d((c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity)),1)]),e("div",ur,[hr,e("span",vr,r(d($.value==="percentage"?(c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity*P.value/100:P.value*c.value[_.value]?.quantity)),1)]),e("div",pr,[_r,e("span",null,r(d((c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity-($.value==="percentage"?(c.value[_.value]?.original_price||c.value[_.value]?.unit_price)*c.value[_.value]?.quantity*P.value/100:P.value*c.value[_.value]?.quantity))),1)])])):u("",!0)]),e("div",mr,[g(_e,{onClick:s[23]||(s[23]=t=>Q.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(me,{onClick:mt},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(Et,{show:ce.value,onClose:s[25]||(s[25]=t=>ce.value=!1),onSuccess:ct},null,8,["show"]),g(Dt,{show:fe.value,product:Ve.value,onClose:s[26]||(s[26]=t=>fe.value=!1),onAddToCart:nt},null,8,["show","product"]),g(te,{show:ne.value,onClose:s[30]||(s[30]=t=>ne.value=!1),"max-width":"4xl"},{default:y(()=>[e("div",fr,[e("div",gr,[xr,e("button",{onClick:s[27]||(s[27]=t=>ne.value=!1),class:"text-gray-400 hover:text-gray-600"},yr)]),e("div",wr,[j(e("input",{"onUpdate:modelValue":s[28]||(s[28]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",onKeyup:De(le,["enter"]),onInput:le},null,544),[[G,x.value]]),kr]),e("div",Cr,[e("button",{onClick:s[29]||(s[29]=t=>N.value=null),class:ee(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",N.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(S,null,I(v.categories,t=>(a(),l("button",{key:t.id,onClick:n=>N.value=t.id,class:ee(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",N.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,Mr))),128))]),e("div",Tr,[ye.value.length===0?(a(),l("div",jr,$r)):(a(),l("div",Pr,[(a(!0),l(S,null,I(ye.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>{se(t),ne.value=!1}},[e("div",Dr,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,Fr)):(a(),l("svg",Nr,Vr))]),e("div",Lr,[e("div",Br,[t.promo_active&&t.promo_discount_percent>0?(a(),l(S,{key:0},[e("p",Or,r(d(O(t).originalPrice)),1),e("p",Rr,r(d(O(t).finalPrice)),1)],64)):(a(),l("p",Ar,r(d(O(t).finalPrice)),1))]),e("h3",Ir,r(t.name),1)])],8,Er))),128))]))])])]),_:1},8,["show"]),g(te,{show:J.value,onClose:s[35]||(s[35]=t=>J.value=!1)},{default:y(()=>[e("div",zr,[e("div",Xr,[Hr,e("button",{onClick:s[31]||(s[31]=t=>J.value=!1),class:"text-gray-400 hover:text-gray-600"},Ur)]),e("div",Gr,[e("div",null,[Wr,j(e("select",{"onUpdate:modelValue":s[32]||(s[32]=t=>F.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},Yr,512),[[Fe,F.value]])]),e("div",null,[e("label",Zr," Descuento "+r(F.value==="percentage"?"%":""),1),j(e("input",{"onUpdate:modelValue":s[33]||(s[33]=t=>V.value=t),type:"number",step:(F.value==="percentage","0.01"),min:0,max:F.value==="percentage"?100:K.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:F.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,ei),[[G,V.value,void 0,{number:!0}]])]),e("div",ti,[e("div",si,[oi,e("span",ni,r(d(K.value)),1)]),e("div",ai,[li,e("span",ri,r(d(Z.value)),1)]),e("div",ii,[ci,e("span",null,r(d(ae.value)),1)])])]),e("div",di,[g(_e,{onClick:s[34]||(s[34]=t=>J.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(me,{onClick:ft},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(te,{show:H.value,onClose:s[38]||(s[38]=t=>H.value=!1)},{default:y(()=>[e("div",ui,[e("div",hi,[vi,e("button",{onClick:s[36]||(s[36]=t=>H.value=!1),class:"text-gray-400 hover:text-gray-600"},_i)]),e("div",mi,[e("div",{class:"text-sm text-gray-700 whitespace-pre-line",innerHTML:xe.value},null,8,fi)]),e("div",gi,[g(me,{onClick:s[37]||(s[37]=t=>H.value=!1)},{default:y(()=>[b("Entendido")]),_:1})])])]),_:1},8,["show"]),g(Pt,{show:be.value,type:"success",title:"¡Gasto Guardado!",message:"El gasto se ha registrado correctamente en el sistema.","primary-text":"Entendido",onClose:s[39]||(s[39]=t=>be.value=!1),onPrimary:s[40]||(s[40]=t=>be.value=!1)},null,8,["show"])]),_:1})],64))}};export{$i as default};
