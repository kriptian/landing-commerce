import{r as i,c as G,w as D,o as U,n as F,a as W,b as n,d as o,e as u,u as V,h as H,f as m,g as e,T as $,i as v,j as S,v as K,k as J,t as r,F as g,l as j,m as h,p as q,q as Q,s as X}from"./app-D7ttTWGz.js";import{_ as Y}from"./AuthenticatedLayout-DDDo1cMT.js";import{_ as Z}from"./Pagination-C1EG426L.js";const ee=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestión de Inventario",-1),te={class:"py-12"},se={class:"max-w-screen-2xl mx-auto sm:px-6 lg:px-8"},ae={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ne={class:"p-6 text-gray-900"},oe={class:"mb-4 flex items-center justify-between"},re={class:"flex items-center gap-3"},le=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-4.35-4.35m0 0A7.5 7.5 0 104.5 4.5a7.5 7.5 0 0012.15 12.15z"})],-1),ie=[le],ce={key:0,class:"relative"},ue={class:"flex items-center gap-2"},de=["href"],pe=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{d:"M7 10a1 1 0 011-1h2V4a1 1 0 112 0v5h2a1 1 0 01.7 1.714l-3 3a1 1 0 01-1.4 0l-3-3A1 1 0 017 10z"}),e("path",{d:"M5 15a1 1 0 011 1v2a2 2 0 002 2h8a2 2 0 002-2v-2a1 1 0 112 0v2a4 4 0 01-4 4H8a4 4 0 01-4-4v-2a1 1 0 011-1z"})],-1),me={class:"relative"},he=e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 111.06 1.06l-4.24 4.25a.75.75 0 01-1.06 0L5.21 8.29a.75.75 0 01.02-1.08z","clip-rule":"evenodd"})],-1),xe={key:0,class:"absolute right-0 mt-2 w-40 bg-white border rounded-md shadow-lg z-10"},fe=["onClick"],ye={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},we={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},ve={class:"min-w-[920px] sm:min-w-full divide-y divide-gray-200"},ge=e("thead",{class:"sticky top-0 z-10 bg-gray-50"},[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Producto / Variante"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"STOCK ACTUAL"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ COMPRA"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ VENTA"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"% Gan."),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"$ Gan."),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Estado"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap w-12"},[e("span",{class:"sr-only"},"Acciones")])])],-1),_e={class:"bg-white divide-y divide-gray-200"},be={key:0,class:"odd:bg-white even:bg-gray-100"},ke={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-800 font-bold"},Ne={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},Ce={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm text-gray-700"},Le={key:0},Se={key:1},ze={key:0},Be={key:1},Te={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Ee={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap w-12"},Me=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),Ae={key:0},Fe=e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," No hay productos para mostrar. ",-1),Ve=[Fe],Ie={__name:"Index",props:{products:Object,filters:Object},setup(x){const _=x,f=i(!!_.filters?.search),d=i(_.filters?.search||""),c=i(_.filters?.status||""),z=i(null),y=i(!1),b=[{value:"",label:"Todos"},{value:"out_of_stock",label:"Agotados"},{value:"low_stock",label:"¡Pocas unidades!"}],I=G(()=>(b.find(s=>s.value===c.value)||b[0]).label),O=async()=>{f.value=!f.value,f.value?(await F(),z.value?.focus()):(d.value="",k())},k=()=>{X.get(route("admin.inventory.index"),{search:d.value||void 0,status:c.value||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})};let B;D(d,()=>{clearTimeout(B),B=setTimeout(()=>k(),350)});const P=s=>{c.value=s,y.value=!1,k()},R=s=>{if(!c.value)return!0;const a=Number(s.quantity)||0,t=Number(s.alert)||0;return c.value==="out_of_stock"?a<=0:c.value==="low_stock"?t>0&&a>0&&a<=t:!0},T=s=>{const a=Number(s.stock)||0,t=Number(s.alert)||0;return a<=0?{text:"Agotado",class:"bg-red-100 text-red-800"}:t>0&&a<=t?{text:"¡Pocas unidades!",class:"bg-yellow-100 text-yellow-800"}:{text:"En Stock",class:"bg-green-100 text-green-800"}},N=s=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(Number(s||0)),C=(s,a)=>{const t=Number(s||0),l=Number(a||0);return!t||!l||t<=0?null:Number(((l-t)/t*100).toFixed(2))},L=(s,a)=>{const t=Number(s||0),l=Number(a||0);if(!t||!l||t<=0)return null;const A=l-t;return A>=0?A:null},w=i(null),E=i(!1),M=i(!1),p=()=>{const s=w.value;if(!s)return;const a=s.scrollWidth-s.clientWidth,t=s.scrollLeft||0;E.value=t>0,M.value=t<a-1};return U(()=>{F(()=>p()),w.value?.addEventListener("scroll",p,{passive:!0}),window.addEventListener("resize",p)}),W(()=>{w.value?.removeEventListener("scroll",p),window.removeEventListener("resize",p)}),(s,a)=>(o(),n(g,null,[u(V(H),{title:"Gestión de Inventario"}),u(Y,null,{header:m(()=>[ee]),default:m(()=>[e("div",te,[e("div",se,[e("div",ae,[e("div",ne,[e("div",oe,[e("div",re,[e("button",{type:"button",onClick:O,class:"p-2 rounded hover:bg-gray-100 transition"},ie),u($,{name:"fade-slide"},{default:m(()=>[f.value?(o(),n("div",ce,[S(e("input",{ref_key:"searchInputRef",ref:z,"onUpdate:modelValue":a[0]||(a[0]=t=>d.value=t),type:"text",placeholder:"Buscar producto...",class:"w-64 md:w-80 border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[K,d.value]])])):v("",!0)]),_:1})]),e("div",ue,[e("a",{href:s.route("admin.inventory.export"),class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150"},[pe,J(" Exportar a Excel ")],8,de),e("div",me,[e("button",{type:"button",onClick:a[1]||(a[1]=t=>y.value=!y.value),class:"inline-flex items-center gap-2 px-3 py-2 border rounded-md shadow-sm hover:bg-gray-50"},[e("span",null,r(I.value),1),he]),u($,{name:"fade-slide"},{default:m(()=>[y.value?(o(),n("ul",xe,[(o(),n(g,null,j(b,t=>e("li",{key:t.value},[e("button",{type:"button",onClick:l=>P(t.value),class:h(["w-full text-left px-3 py-2 hover:bg-gray-100",{"font-semibold text-indigo-600":t.value===c.value}])},r(t.label),11,fe)])),64))])):v("",!0)]),_:1})])])]),e("div",{ref_key:"scrollBoxRef",ref:w,class:"relative overflow-x-auto w-full"},[S(e("div",ye,null,512),[[q,E.value]]),S(e("div",we,null,512),[[q,M.value]]),e("table",ve,[ge,e("tbody",_e,[(o(!0),n(g,null,j(x.products.data,(t,l)=>(o(),n(g,{key:t.id},[R(t)?(o(),n("tr",be,[e("td",{class:h(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-r",l%2===1?"bg-gray-100":"bg-white"])},r(t.name),3),e("td",ke,r(t.quantity),1),e("td",Ne,r(N(t.purchase_price)),1),e("td",Ce,r(N(t.price)),1),e("td",{class:h(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":C(t.purchase_price,t.price)===null}])},[C(t.purchase_price,t.price)!==null?(o(),n("span",Le,r(C(t.purchase_price,t.price))+"%",1)):(o(),n("span",Se,"—"))],2),e("td",{class:h(["px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm",{"text-gray-500":L(t.purchase_price,t.price)===null}])},[L(t.purchase_price,t.price)!==null?(o(),n("span",ze,r(N(L(t.purchase_price,t.price))),1)):(o(),n("span",Be,"—"))],2),e("td",Te,[e("span",{class:h(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",T({stock:t.quantity,alert:t.alert}).class])},r(T({stock:t.quantity,alert:t.alert}).text),3)]),e("td",Ee,[u(V(Q),{href:s.route("admin.products.edit",t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:m(()=>[Me]),_:2},1032,["href"])])])):v("",!0)],64))),128)),x.products.data.length===0?(o(),n("tr",Ae,Ve)):v("",!0)])])],512),u(Z,{class:"mt-6",links:x.products.links},null,8,["links"])])])])])]),_:1})],64))}};export{Ie as default};
