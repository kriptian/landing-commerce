import{u as U,r as x,a as l,o as i,b as v,d,h as N,e as S,f as e,i as g,F as _,n as y,t as m,g as h,j as w,q as k,m as $}from"./app-BWfncV94.js";import{_ as B}from"./AuthenticatedLayout-J7uuA0aO.js";import{_ as F}from"./AlertModal-CyuLGaFw.js";import{s as D}from"./safeRoute-CFL_QDz4.js";import"./Modal-BKig7U95.js";const T=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Crear categoría",-1),q={class:"py-12"},L={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},O={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},P={class:"p-6 text-gray-900"},R={key:0,class:"mb-4 p-4 rounded-lg bg-red-50 border border-red-200"},z=e("h4",{class:"font-medium text-red-800 mb-2"},"Errores al crear la categoría:",-1),G={class:"list-disc list-inside text-sm text-red-700 space-y-1"},H={class:"mb-6 border-b pb-6"},J=e("label",{for:"name",class:"block font-medium text-lg text-gray-800"},"Nombre de la Categoría",-1),K={key:0,class:"text-sm text-red-600 mt-2"},Q={class:"mt-6"},W=e("h3",{class:"font-medium text-lg text-gray-800"},"Estructura de Subcategorías",-1),X=e("p",{class:"text-sm text-gray-500"},"Definí subcategorías y un subnivel adicional (máximo 3 niveles en total).",-1),Y={class:"flex items-center gap-4 p-3"},Z=["onUpdate:modelValue","placeholder"],ee=["onClick"],te={class:"bg-gray-50 px-3 pb-3"},se=["onClick"],re={class:"w-5 h-5 inline-flex items-center justify-center rounded-full border border-gray-300 text-gray-700"},oe={key:0,class:"mt-3 space-y-2"},ne=["onUpdate:modelValue","placeholder"],ae=["onClick"],le=["onClick"],ie=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("rect",{x:"4",y:"3",width:"11",height:"15",rx:"2",ry:"2","stroke-width":"1.5"}),e("circle",{cx:"18",cy:"18",r:"3","stroke-width":"1.5"}),e("path",{"stroke-linecap":"round","stroke-width":"1.5",d:"M18 16.5v3M16.5 18h3"})],-1),de={key:0,class:"text-sm text-red-600 mt-2"},ce=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[e("rect",{x:"4",y:"3",width:"11",height:"15",rx:"2",ry:"2","stroke-width":"1.5"}),e("circle",{cx:"18",cy:"18",r:"3","stroke-width":"1.5"}),e("path",{"stroke-linecap":"round","stroke-width":"1.5",d:"M18 16.5v3M16.5 18h3"})],-1),ue={class:"flex items-center justify-end mt-8 border-t pt-6"},he=["disabled"],me=e("span",{class:"text-lg"},"+",-1),be=e("span",null,"Crear",-1),pe=[me,be],ke={__name:"Create",setup(ge){const r=U({name:"",subcategories:[]}),A=()=>{r.subcategories.push({name:"",children:[],_showChildren:!1})},E=c=>{r.subcategories.splice(c,1)},V=c=>{const t=r.subcategories[c];t&&(Array.isArray(t.children)||(t.children=[]),t._showChildren=!t._showChildren)},I=c=>{const t=r.subcategories[c];t&&(Array.isArray(t.children)||(t.children=[]),t.children.push({name:""}))},j=(c,t)=>{const s=r.subcategories[c];!s||!Array.isArray(s.children)||s.children.splice(t,1)},b=x(!1),f=x(!1),p=x([]),M=()=>{const c=D("admin.categories.store",{},"/admin/categories");r.post(c,{onSuccess:()=>{b.value=!0,f.value=!1,p.value=[]},onError:t=>{const s=[];for(const[n,a]of Object.entries(r.errors)){let o="";if(typeof a=="string"?o=a:Array.isArray(a)?o=a.join(", "):o=String(a),o.includes("has already been taken"))if(n.includes("subcategories")&&n.includes("children")){const u=n.match(/subcategories\.(\d+)\.children\.(\d+)\.name/);if(u){const C=parseInt(u[1])+1;o=`El nombre del subnivel ${parseInt(u[2])+1} de la subcategoría ${C} ya existe en tu tienda.`}else o="Uno de los nombres de subnivel ya existe en tu tienda."}else if(n.includes("subcategories")){const u=n.match(/subcategories\.(\d+)\.name/);u?o=`El nombre de la subcategoría ${parseInt(u[1])+1} ya existe en tu tienda.`:o="Uno de los nombres de subcategoría ya existe en tu tienda."}else o=o.replace("has already been taken","ya existe en tu tienda");s.push(o)}p.value=s,f.value=s.length>0}})};return(c,t)=>(i(),l(_,null,[v(d(N),{title:"Crear categoría"}),v(B,null,{header:S(()=>[T]),default:S(()=>[e("div",q,[e("div",L,[e("div",O,[e("div",P,[f.value&&p.value.length>0?(i(),l("div",R,[z,e("ul",G,[(i(!0),l(_,null,y(p.value,(s,n)=>(i(),l("li",{key:n},m(s),1))),128))])])):g("",!0),e("form",{onSubmit:h(M,["prevent"])},[e("div",H,[J,w(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=s=>d(r).name=s),type:"text",class:"block mt-2 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[k,d(r).name]]),d(r).errors.name?(i(),l("p",K,m(d(r).errors.name),1)):g("",!0)]),e("div",Q,[W,X,(i(!0),l(_,null,y(d(r).subcategories,(s,n)=>(i(),l("div",{key:n,class:"mt-4 border rounded-lg overflow-hidden"},[e("div",Y,[w(e("input",{"onUpdate:modelValue":a=>s.name=a,type:"text",placeholder:`Nombre de la Subcategoría ${n+1}`,class:"block w-full rounded-md shadow-sm border-gray-300"},null,8,Z),[[k,s.name]]),e("button",{onClick:h(a=>E(n),["prevent"]),type:"button",class:"bg-red-500 text-white font-bold p-2 rounded-full h-8 w-8 flex items-center justify-center"}," - ",8,ee)]),e("div",te,[e("button",{type:"button",class:"inline-flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",onClick:h(a=>V(n),["prevent"])},[e("span",re,m(s._showChildren?"v":">"),1),e("span",null,m(s._showChildren?"Colapsar subniveles":"Expandir subniveles"),1)],8,se),s._showChildren?(i(),l("div",oe,[(i(!0),l(_,null,y(s.children||[],(a,o)=>(i(),l("div",{key:o,class:"flex items-center gap-3"},[w(e("input",{"onUpdate:modelValue":u=>a.name=u,type:"text",class:"block w-full rounded-md shadow-sm border-gray-300",placeholder:`Subnivel ${o+1}`},null,8,ne),[[k,a.name]]),e("button",{onClick:h(u=>j(n,o),["prevent"]),type:"button",class:"bg-red-500 text-white font-bold p-2 rounded-full h-8 w-8 flex items-center justify-center"},"- ",8,ae)]))),128)),e("button",{type:"button",class:"mt-1 inline-flex items-center gap-2 border border-green-500 text-green-600 py-1 px-3 rounded hover:bg-green-50",onClick:h(a=>I(n),["prevent"])},[ie,$(" Agregar subnivel ")],8,le)])):g("",!0)])]))),128)),d(r).errors.subcategories?(i(),l("p",de,m(d(r).errors.subcategories),1)):g("",!0),e("button",{onClick:h(A,["prevent"]),type:"button",class:"mt-4 inline-flex items-center gap-2 border border-green-500 text-green-600 py-2 px-4 rounded hover:bg-green-50"},[ce,$(" Añadir Subcategoría ")])]),e("div",ue,[e("button",{type:"submit",disabled:d(r).processing,class:"bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 inline-flex items-center gap-2"},pe,8,he)])],32)])])])])]),_:1}),v(F,{show:b.value,type:"success",title:"Categorías",message:"¡Categoría creada con éxito!","primary-text":"Entendido",onPrimary:t[1]||(t[1]=s=>{b.value=!1,d(r).reset()}),onClose:t[2]||(t[2]=s=>{b.value=!1,d(r).reset()})},null,8,["show"])],64))}};export{ke as default};
