import{r as p,c as O,y as k,z,b as d,d as n,e as m,u as _,h as N,f as g,g as e,F as v,l as y,i as $,t,k as w,m as j,x as P,j as V,A as M,q}from"./app-D7ttTWGz.js";import{_ as L}from"./AuthenticatedLayout-DDDo1cMT.js";import{_ as T}from"./AlertModal-Bl0CaqCv.js";import"./Modal-UfrBPs3q.js";const A={class:"flex items-center space-x-4"},F={class:"font-semibold text-xl text-gray-800 leading-tight"},B={class:"py-12"},I={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-8"},R={class:"lg:col-span-2 space-y-8"},U={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},G={class:"p-6"},H=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Productos en la Orden",-1),J={class:"divide-y divide-gray-200"},K={class:"flex-grow"},Q={class:"font-bold text-gray-900"},W={key:0,class:"text-sm text-gray-600 mt-1"},X={class:"font-semibold"},Y={class:"text-sm text-gray-500 mt-2"},Z={class:"font-semibold text-gray-800 shrink-0 ml-4"},ee={class:"border-t border-gray-200 pt-4 mt-4 text-right"},te={class:"text-2xl font-bold"},se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},oe={class:"p-6"},ae=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Datos del Cliente",-1),le={class:"mt-4 space-y-4 text-gray-700"},de=e("p",{class:"font-semibold text-sm text-gray-500"},"Nombre:",-1),ne=e("p",{class:"font-semibold text-sm text-gray-500"},"Teléfono:",-1),re=e("p",{class:"font-semibold text-sm text-gray-500"},"Correo:",-1),ie=e("p",{class:"font-semibold text-sm text-gray-500"},"Dirección:",-1),ce={class:"space-y-8"},ue={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},me={class:"p-6"},_e=e("h3",{class:"text-lg font-semibold mb-4"},"Estado del Pedido",-1),he={class:"text-center mb-4"},pe={class:"text-sm text-center text-gray-500"},ge={class:"mt-6 border-t pt-6"},be=e("label",{for:"status",class:"block font-medium text-sm text-gray-700 mb-2"},"Cambiar Estado",-1),ve=e("option",{value:"recibido"},"Recibido",-1),xe=e("option",{value:"en_preparacion"},"En Preparación",-1),fe=e("option",{value:"despachado"},"Despachado",-1),ye=e("option",{value:"entregado"},"Entregado",-1),we=e("option",{value:"cancelado"},"Cancelado",-1),Ce=[ve,xe,fe,ye,we],Ee=["disabled"],Se=e("div",{class:"p-6"},[e("div",{class:"mt-6 flex justify-end"})],-1),Ne={__name:"Show",props:{order:Object},setup(o){const r=p(!1),i=p(""),c=p(""),b=p("success"),h=o,C=l=>{const s={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(l).toLocaleDateString("es-CO",s)},x=O(()=>({recibido:{text:"Recibido",class:"bg-yellow-100 text-yellow-800"},en_preparacion:{text:"En Preparación",class:"bg-blue-100 text-blue-800"},despachado:{text:"Despachado",class:"bg-purple-100 text-purple-800"},entregado:{text:"Entregado",class:"bg-green-100 text-green-800"},cancelado:{text:"Cancelado",class:"bg-red-100 text-red-800"}})[h.order.status]||{text:h.order.status,class:"bg-gray-100 text-gray-800"}),u=k({status:h.order.status}),E=()=>{const l=u.status;u.put(route("admin.orders.update",h.order.id),{preserveScroll:!0,onSuccess:()=>{b.value="success",l==="despachado"||l==="entregado"?(i.value="Venta confirmada",c.value="Inventario actualizado correctamente."):l==="cancelado"?(i.value="Pedido cancelado",c.value="El estado se actualizó y el inventario fue revertido si correspondía."):(i.value="Estado actualizado",c.value="El estado de la orden se guardó correctamente."),r.value=!0},onError:s=>{b.value="error",i.value="Error al actualizar",c.value=Array.isArray(s)?s.join(`
`):s?.status||Object.values(s||{}).join(`
`)||"Ocurrió un error inesperado.",r.value=!0}})};return(l,s)=>{const S=z("Modal");return n(),d(v,null,[m(_(N),{title:`Orden #${o.order.sequence_number??o.order.id}`},null,8,["title"]),m(L,null,{header:g(()=>[e("div",A,[m(_(q),{href:l.route("admin.orders.index"),class:"text-blue-600 hover:text-blue-800"},{default:g(()=>[w(" ← Volver a Órdenes ")]),_:1},8,["href"]),e("h2",F," Detalle de la Orden #"+t(o.order.sequence_number??o.order.id),1)])]),default:g(()=>[e("div",B,[e("div",I,[e("div",R,[e("div",U,[e("div",G,[H,e("div",J,[(n(!0),d(v,null,y(o.order.items,a=>(n(),d("div",{key:a.id,class:"py-4 flex justify-between items-start"},[e("div",K,[e("p",Q,t(a.product_name),1),a.variant_options?(n(),d("div",W,[(n(!0),d(v,null,y(a.variant_options,(D,f)=>(n(),d("span",{key:f,class:"mr-2 bg-gray-100 px-2 py-1 rounded"},[e("span",X,t(f)+":",1),w(" "+t(D),1)]))),128))])):$("",!0),e("p",Y,t(a.quantity)+" x $ "+t(Number(a.unit_price).toLocaleString("es-CO")),1)]),e("p",Z,"$ "+t(Number(a.unit_price*a.quantity).toLocaleString("es-CO")),1)]))),128))]),e("div",ee,[e("p",te,"Total: $ "+t(Number(o.order.total_price).toLocaleString("es-CO")),1)])])]),e("div",se,[e("div",oe,[ae,e("div",le,[e("div",null,[de,e("p",null,t(o.order.customer_name),1)]),e("div",null,[ne,e("p",null,t(o.order.customer_phone),1)]),e("div",null,[re,e("p",null,t(o.order.customer_email),1)]),e("div",null,[ie,e("p",null,t(o.order.customer_address),1)])])])])]),e("div",ce,[e("div",ue,[e("div",me,[_e,e("div",he,[e("span",{class:j(["px-4 py-2 inline-flex text-lg leading-5 font-semibold rounded-full",x.value.class])},t(x.value.text),3)]),e("p",pe," Pedido realizado el: "+t(C(o.order.created_at)),1),e("form",{onSubmit:P(E,["prevent"])},[e("div",ge,[be,V(e("select",{id:"status","onUpdate:modelValue":s[0]||(s[0]=a=>_(u).status=a),class:"block w-full rounded-md shadow-sm border-gray-300"},Ce,512),[[M,_(u).status]]),e("button",{type:"submit",disabled:_(u).processing,class:"mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Actualizar Estado ",8,Ee)])],32)])])])])])]),_:1}),m(S,{show:l.confirmingSale,onClose:l.closeSaleModal},{default:g(()=>[Se]),_:1},8,["show","onClose"]),m(T,{show:r.value,type:b.value,title:i.value,message:c.value,"primary-text":"Entendido",onPrimary:s[1]||(s[1]=a=>r.value=!1),onClose:s[2]||(s[2]=a=>r.value=!1)},null,8,["show","type","title","message"])],64)}}};export{Ne as default};
