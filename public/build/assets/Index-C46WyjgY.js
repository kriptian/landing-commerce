import{r as d,u as ge,c as R,x as ve,w as xe,a as l,o as n,b as _,d as h,h as ye,e as m,f as e,i as c,n as se,j as x,E as oe,l as f,F,k as B,t as r,g as ae,A,z as Y,p as g,G as ne,D as fe}from"./app-SsEMnYrU.js";import{_ as be}from"./AuthenticatedLayout-C52cI_5r.js";import{_ as H}from"./Modal-CSpKFLf1.js";import{_ as Q}from"./SecondaryButton-B5UMDAvl.js";import{_ as re}from"./PrimaryButton-OYiKg9Gw.js";import{_ as we}from"./Pagination-9gHM4STL.js";import"./AlertModal-Csg112t6.js";const ke=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Ventas FÃ­sicas",-1),Ce={class:"py-12"},$e={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},De={class:"mb-6 border-b border-gray-200"},Fe={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Me={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ve={class:"lg:col-span-2 space-y-6"},je={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Se={class:"p-6"},Pe=e("h3",{class:"text-lg font-semibold mb-4"},"Buscar Productos",-1),Ee={class:"flex gap-2 mb-4"},Be={key:0,class:"mt-4 space-y-2 max-h-64 overflow-y-auto"},Ne=["onClick"],Te={class:"flex justify-between items-center"},Ue={class:"font-medium"},qe={class:"text-sm text-gray-500"},Le={key:0,class:"text-xs text-gray-400"},Ie=["onClick"],Oe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ze={class:"p-6"},Re=e("h3",{class:"text-lg font-semibold mb-4"},"Carrito de Venta",-1),Ae={key:0,class:"text-center py-8 text-gray-500"},Ye={key:1,class:"space-y-3"},He={class:"flex-1"},Qe={class:"font-medium"},Ke={key:0,class:"text-sm text-gray-500"},Ge={class:"flex items-center gap-2"},We={key:0,class:"text-sm text-gray-400 line-through"},Je={class:"text-sm text-gray-600 font-medium"},Xe={key:0,class:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded font-medium"},Ze={class:"flex items-center gap-2"},et=["onClick"],tt={class:"w-12 text-center"},st=["onClick"],ot={class:"w-20 text-right font-medium"},at=["onClick"],nt={key:2,class:"mt-6 pt-4 border-t space-y-2"},rt={class:"flex justify-between"},lt=e("span",null,"Subtotal:",-1),it={class:"flex justify-between"},dt=e("span",null,"Descuento:",-1),ct=["max"],ut={class:"flex justify-between text-lg font-bold pt-2 border-t"},pt=e("span",null,"Total:",-1),mt={class:"lg:col-span-1"},_t={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ht={class:"p-6"},gt={class:"flex items-center justify-between mb-4"},vt=e("h3",{class:"text-lg font-semibold"},"Ventas Recientes",-1),xt=["title"],yt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-600"},ft=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"},null,-1),bt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),wt=[ft,bt],kt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5 text-gray-600"},Ct=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228L3 3m6.772 6.772L21 21m-3.228-3.228L21 21m-6.772-6.772L3 3"},null,-1),$t=[Ct],Dt={class:"mb-4"},Ft={key:0,class:"text-center py-8 text-gray-500"},Mt={key:1,class:"text-center py-8 text-gray-500"},Vt={key:2,class:"space-y-3 max-h-96 overflow-y-auto"},jt=["onClick"],St={class:"flex justify-between items-start"},Pt={class:"font-medium text-sm"},Et={class:"text-xs text-gray-500"},Bt={class:"font-semibold text-green-600"},Nt={key:1},Tt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Ut={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},qt={class:"p-6"},Lt=e("h3",{class:"text-sm font-medium text-gray-500 uppercase tracking-wider"},"Ventas Totales",-1),It={class:"mt-1 text-3xl font-semibold text-gray-900"},Ot={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},zt={class:"p-6"},Rt=e("h3",{class:"text-sm font-medium text-gray-500 uppercase tracking-wider"},"Total de Ventas",-1),At={class:"mt-1 text-3xl font-semibold text-gray-900"},Yt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg mb-6"},Ht={class:"p-6"},Qt={class:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end"},Kt=e("label",{for:"search_sale",class:"block text-sm font-medium text-gray-700"},"Buscar por nÃºmero",-1),Gt=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700"},"Desde",-1),Wt=e("label",{for:"end_date",class:"block text-sm font-medium text-gray-700"},"Hasta",-1),Jt={class:"flex space-x-2"},Xt=["disabled"],Zt={class:"mt-4 flex flex-wrap gap-2"},es=e("span",{class:"text-sm text-gray-500 mr-2 self-center"},"Rangos rÃ¡pidos:",-1),ts={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ss={class:"p-6"},os={class:"flex justify-between items-center mb-4"},as=e("h3",{class:"text-lg font-semibold"},"Historial de Ventas",-1),ns=["href"],rs=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",class:"w-4 h-4 mr-2"},[e("path",{d:"M7 10a1 1 0 011-1h2V4a1 1 0 112 0v5h2a1 1 0 01.7 1.714l-3 3a1 1 0 01-1.4 0l-3-3A1 1 0 017 10z"}),e("path",{d:"M5 15a1 1 0 011 1v2a2 2 0 002 2h8a2 2 0 002-2v-2a1 1 0 112 0v2a4 4 0 01-4 4H8a4 4 0 01-4-4v-2a1 1 0 011-1z"})],-1),ls={class:"overflow-x-auto"},is={class:"min-w-full divide-y divide-gray-200"},ds=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"NÃºmero"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Vendedor"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Fecha"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"MÃ©todo de Pago"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Subtotal"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Descuento"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Total"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Acciones")])],-1),cs={class:"bg-white divide-y divide-gray-200"},us={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600"},ps={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ms={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},_s={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize"},hs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},gs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},vs={class:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900"},xs={class:"px-6 py-4 whitespace-nowrap text-sm"},ys={key:0},fs=e("td",{colspan:"8",class:"px-6 py-4 text-center text-gray-500"}," No hay ventas para mostrar en este perÃ­odo. ",-1),bs=[fs],ws={class:"p-6"},ks=e("h2",{class:"text-lg font-semibold mb-4"},"Confirmar Venta",-1),Cs={class:"mb-4"},$s=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"MÃ©todo de Pago",-1),Ds=e("option",{value:"efectivo"},"Efectivo",-1),Fs=e("option",{value:"tarjeta"},"Tarjeta",-1),Ms=e("option",{value:"transferencia"},"Transferencia",-1),Vs=e("option",{value:"mixto"},"Mixto",-1),js=[Ds,Fs,Ms,Vs],Ss={class:"mb-4"},Ps=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas (Opcional)",-1),Es={key:0,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded"},Bs=e("h4",{class:"text-sm font-semibold text-green-800 mb-2"},"Descuentos por Producto:",-1),Ns={class:"space-y-1"},Ts={class:"text-green-700"},Us={class:"text-green-700 font-medium"},qs={class:"mb-4 p-3 bg-gray-50 rounded"},Ls={class:"flex justify-between mb-2"},Is=e("span",null,"Subtotal:",-1),Os={key:0,class:"flex justify-between mb-2 text-red-600"},zs=e("span",null,"Descuento manual:",-1),Rs={class:"flex justify-between font-bold text-lg pt-2 border-t"},As=e("span",null,"Total:",-1),Ys={class:"flex gap-3"},Hs={class:"p-6"},Qs=e("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"Â¡Venta registrada exitosamente!",-1),Ks={key:0,class:"mb-4"},Gs={class:"text-sm text-gray-600 mb-2"},Ws={class:"font-semibold"},Js={class:"text-sm text-gray-600 mb-2"},Xs={class:"font-semibold"},Zs={class:"flex gap-3"},eo={class:"p-6"},to=e("h2",{class:"text-lg font-semibold mb-4"},"Escanear CÃ³digo de Barras",-1),so=e("p",{class:"text-sm text-gray-600 mb-4"}," Por favor, ingresa el cÃ³digo de barras manualmente o usa un lector externo. ",-1),oo={class:"flex gap-2"},po={__name:"Index",props:{sales:Object,stats:Object,filters:Object},setup(b){const i=b,C=d("sales"),v=ge({start_date:i.filters?.start_date||"",end_date:i.filters?.end_date||"",search:i.filters?.search||""}),M=d(""),V=d(!1),$=d(null),N=d(!1),K=()=>{v.get(route("admin.physical-sales.index"),{preserveState:!0,preserveScroll:!0})},G=o=>{const s=o.getFullYear(),t=String(o.getMonth()+1).padStart(2,"0"),a=String(o.getDate()).padStart(2,"0");return`${s}-${t}-${a}`},le=()=>{const o=new Date;return new Date(o.getFullYear(),o.getMonth(),o.getDate())},j=o=>{const s=le();let t,a;switch(o){case"today":t=s,a=s;break;case"last7":t=new Date(s),t.setDate(t.getDate()-6),a=s;break;case"last30":t=new Date(s),t.setDate(t.getDate()-29),a=s;break;case"thisMonth":t=new Date(s.getFullYear(),s.getMonth(),1),a=new Date(s.getFullYear(),s.getMonth()+1,0);break;case"lastMonth":t=new Date(s.getFullYear(),s.getMonth()-1,1),a=new Date(s.getFullYear(),s.getMonth(),0);break;default:return}v.start_date=G(t),v.end_date=G(a),K()},D=o=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),ie=o=>new Date(o).toLocaleString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),de=o=>{o&&A.visit(route("admin.physical-sales.show",o.id)+"?print=true")},W=R(()=>{if(!i.sales||!i.sales.data)return[];const o=new Date;o.setHours(0,0,0,0);const s=new Date(o);s.setHours(23,59,59,999);let t=i.sales.data.filter(a=>{const p=new Date(a.created_at);return p>=o&&p<=s});if(M.value.trim()){const a=M.value.toLowerCase();t=t.filter(p=>p.sale_number.toLowerCase().includes(a))}return t}),ce=o=>V.value?"***":`$${parseFloat(o).toFixed(2)}`,u=d([]),y=d(""),w=d([]),J=d(!1),L=d(!1),S=d(""),P=d(!1),T=d("efectivo"),U=d(""),k=d(0);let q=null;const E=R(()=>u.value.reduce((o,s)=>o+s.quantity*s.unit_price,0)),I=R(()=>E.value-k.value),X=async()=>{if(!y.value.trim()){w.value=[];return}J.value=!0;try{const s=await(await fetch(route("admin.physical-sales.search-products")+"?q="+encodeURIComponent(y.value))).json();w.value=s.products||[]}catch(o){console.error("Error buscando productos:",o),w.value=[]}finally{J.value=!1}},Z=async o=>{if(o.trim())try{const t=await(await fetch(route("admin.physical-sales.get-product-by-barcode")+"?barcode="+encodeURIComponent(o))).json();t.product?(O(t.product),S.value=""):alert("Producto no encontrado con ese cÃ³digo de barras")}catch(s){console.error("Error buscando por cÃ³digo de barras:",s),alert("Error al buscar producto")}},ue=(o,s=null)=>{const t=s?.price??o.price;let a=parseFloat(t),p=0;return o.promo_active&&o.promo_discount_percent>0&&(p=parseFloat(o.promo_discount_percent),a=Math.round(a*(100-p)/100)),{originalPrice:parseFloat(t),finalPrice:a,discountPercent:p}},O=(o,s=null)=>{const t=u.value.find(a=>a.product_id===o.id&&a.variant_id===(s?.id||null));if(t)t.quantity+=1;else{const a=ue(o,s);u.value.push({product_id:o.id,product_name:o.name,variant_id:s?.id||null,variant_options:s?.options||null,quantity:1,unit_price:a.finalPrice,original_price:a.originalPrice,discount_percent:a.discountPercent,product:o,variant:s})}y.value="",w.value=[]},pe=o=>{u.value.splice(o,1)},ee=(o,s)=>{const t=u.value[o],a=t.quantity+s;a>0&&(t.quantity=a)},me=async()=>{try{q=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),L.value=!0}catch(o){console.error("Error accediendo a la cÃ¡mara:",o),alert("No se pudo acceder a la cÃ¡mara. Por favor, permite el acceso a la cÃ¡mara en la configuraciÃ³n del navegador.")}},z=()=>{q&&(q.getTracks().forEach(o=>o.stop()),q=null),L.value=!1},_e=async()=>{if(u.value.length===0){alert("El carrito estÃ¡ vacÃ­o");return}const o={items:u.value.map(s=>({product_id:s.product_id,variant_id:s.variant_id,quantity:s.quantity,unit_price:s.unit_price})),subtotal:E.value,tax:0,discount:k.value,total:I.value,payment_method:T.value,notes:U.value};try{if(!window.axios){alert("Error: No se pudo inicializar la conexiÃ³n. Por favor, recarga la pÃ¡gina.");return}const s=await window.axios.post(route("admin.physical-sales.store"),o);s.data&&s.data.success?($.value=s.data.sale,P.value=!1,u.value=[],y.value="",k.value=0,U.value="",T.value="efectivo",N.value=!0,A.reload()):alert("Error: "+(s.data?.message||"No se pudo procesar la venta"))}catch(s){console.error("Error procesando venta:",s);let t="Error al procesar la venta";s.response?s.response.status===419?t="La sesiÃ³n ha expirado. Por favor, recarga la pÃ¡gina e intenta nuevamente.":s.response.status===422?t=s.response.data?.message||"Error de validaciÃ³n. Verifica los datos e intenta nuevamente.":s.response.data?.message&&(t=s.response.data.message):s.request&&(t="No se pudo conectar con el servidor. Verifica tu conexiÃ³n."),alert(t)}};ve(()=>{z()});let te;return xe(y,()=>{clearTimeout(te),te=setTimeout(()=>{y.value.trim().length>=2?X():w.value=[]},300)}),(o,s)=>(n(),l(F,null,[_(h(ye),{title:"Ventas FÃ­sicas"}),_(be,null,{header:m(()=>[ke]),default:m(()=>[e("div",Ce,[e("div",$e,[e("div",De,[e("nav",Fe,[e("button",{onClick:s[0]||(s[0]=t=>C.value="sales"),class:se([C.value==="sales"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Ventas ",2),e("button",{onClick:s[1]||(s[1]=t=>C.value="reports"),class:se([C.value==="reports"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Reportes ",2)])]),C.value==="sales"?(n(),l("div",Me,[e("div",Ve,[e("div",je,[e("div",Se,[Pe,e("div",Ee,[x(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>y.value=t),type:"text",placeholder:"Buscar por nombre, ID o cÃ³digo de barras...",class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",onKeyup:oe(X,["enter"])},null,544),[[f,y.value]]),e("button",{onClick:me,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," ðŸ“· Escanear ")]),w.value.length>0?(n(),l("div",Be,[(n(!0),l(F,null,B(w.value,t=>(n(),l("div",{key:t.id,class:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer",onClick:a=>O(t)},[e("div",Te,[e("div",null,[e("p",Ue,r(t.name),1),e("p",qe,"$"+r(t.price),1),t.barcode?(n(),l("p",Le,"CÃ³digo: "+r(t.barcode),1)):c("",!0)]),e("button",{onClick:ae(a=>O(t),["stop"]),class:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700"}," Agregar ",8,Ie)])],8,Ne))),128))])):c("",!0)])]),e("div",Oe,[e("div",ze,[Re,u.value.length===0?(n(),l("div",Ae," El carrito estÃ¡ vacÃ­o ")):(n(),l("div",Ye,[(n(!0),l(F,null,B(u.value,(t,a)=>(n(),l("div",{key:a,class:"flex items-center justify-between p-3 border rounded-md"},[e("div",He,[e("p",Qe,r(t.product_name),1),t.variant_options?(n(),l("p",Ke,r(Object.entries(t.variant_options).map(([p,he])=>`${p}: ${he}`).join(", ")),1)):c("",!0),e("div",Ge,[e("div",null,[t.original_price&&t.original_price>t.unit_price?(n(),l("p",We," $"+r(t.original_price.toFixed(2)),1)):c("",!0),e("p",Je," $"+r(t.unit_price.toFixed(2))+" c/u ",1)]),t.discount_percent>0?(n(),l("span",Xe," -"+r(t.discount_percent)+"% ",1)):c("",!0)])]),e("div",Ze,[e("button",{onClick:p=>ee(a,-1),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"}," - ",8,et),e("span",tt,r(t.quantity),1),e("button",{onClick:p=>ee(a,1),class:"px-2 py-1 bg-gray-200 rounded hover:bg-gray-300"}," + ",8,st),e("span",ot," $"+r((t.quantity*t.unit_price).toFixed(2)),1),e("button",{onClick:p=>pe(a),class:"px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700"}," Ã— ",8,at)])]))),128))])),u.value.length>0?(n(),l("div",nt,[e("div",rt,[lt,e("span",null,"$"+r(E.value.toFixed(2)),1)]),e("div",it,[dt,x(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>k.value=t),type:"number",step:"0.01",min:"0",max:E.value,class:"w-24 text-right border rounded px-2"},null,8,ct),[[f,k.value,void 0,{number:!0}]])]),e("div",ut,[pt,e("span",null,"$"+r(I.value.toFixed(2)),1)]),e("button",{onClick:s[4]||(s[4]=t=>P.value=!0),class:"w-full mt-4 px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 font-semibold"}," Procesar Venta ")])):c("",!0)])])]),e("div",mt,[e("div",_t,[e("div",ht,[e("div",gt,[vt,e("button",{onClick:s[5]||(s[5]=t=>V.value=!V.value),class:"p-2 rounded-md hover:bg-gray-100 transition-colors",title:V.value?"Mostrar valores":"Ocultar valores"},[V.value?(n(),l("svg",kt,$t)):(n(),l("svg",yt,wt))],8,xt)]),e("div",Dt,[x(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>M.value=t),type:"text",placeholder:"Buscar por nÃºmero de venta...",class:"w-full rounded-md border-gray-300 shadow-sm text-sm"},null,512),[[f,M.value]])]),!i.sales||!i.sales.data||i.sales.data.length===0?(n(),l("div",Ft," No hay ventas registradas ")):W.value.length===0?(n(),l("div",Mt,r(M.value.trim()?"No se encontraron ventas con ese nÃºmero":"No hay ventas del dÃ­a de hoy"),1)):(n(),l("div",Vt,[(n(!0),l(F,null,B(W.value,t=>(n(),l("div",{key:t.id,class:"p-3 border rounded-md hover:bg-gray-50 cursor-pointer",onClick:a=>h(A).get(o.route("admin.physical-sales.show",t.id))},[e("div",St,[e("div",null,[e("p",Pt,"#"+r(t.sale_number),1),e("p",Et,r(new Date(t.created_at).toLocaleString()),1)]),e("p",Bt,r(ce(t.total)),1)])],8,jt))),128))]))])])])])):c("",!0),C.value==="reports"?(n(),l("div",Nt,[e("div",Tt,[e("div",Ut,[e("div",qt,[Lt,e("p",It,r(b.stats?D(b.stats.totalSales||0):"$0"),1)])]),e("div",Ot,[e("div",zt,[Rt,e("p",At,r(b.stats&&b.stats.totalCount||0),1)])])]),e("div",Yt,[e("div",Ht,[e("form",{onSubmit:ae(K,["prevent"])},[e("div",Qt,[e("div",null,[Kt,x(e("input",{type:"text",id:"search_sale","onUpdate:modelValue":s[7]||(s[7]=t=>h(v).search=t),placeholder:"Ej: V-000001",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[f,h(v).search]])]),e("div",null,[Gt,x(e("input",{type:"date",id:"start_date","onUpdate:modelValue":s[8]||(s[8]=t=>h(v).start_date=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[f,h(v).start_date]])]),e("div",null,[Wt,x(e("input",{type:"date",id:"end_date","onUpdate:modelValue":s[9]||(s[9]=t=>h(v).end_date=t),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,512),[[f,h(v).end_date]])]),e("div",Jt,[e("button",{type:"submit",disabled:h(v).processing,class:"w-full bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Filtrar ",8,Xt),_(h(Y),{href:o.route("admin.physical-sales.index"),class:"w-full bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded hover:bg-gray-400 text-center"},{default:m(()=>[g(" Limpiar ")]),_:1},8,["href"])])]),e("div",Zt,[es,e("button",{type:"button",onClick:s[10]||(s[10]=t=>j("today")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Hoy"),e("button",{type:"button",onClick:s[11]||(s[11]=t=>j("last7")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Ãšltimos 7 dÃ­as"),e("button",{type:"button",onClick:s[12]||(s[12]=t=>j("last30")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Ãšltimos 30 dÃ­as"),e("button",{type:"button",onClick:s[13]||(s[13]=t=>j("thisMonth")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Este mes"),e("button",{type:"button",onClick:s[14]||(s[14]=t=>j("lastMonth")),class:"px-3 py-1 rounded-full text-sm border bg-white text-gray-700 border-gray-300 hover:bg-gray-50"},"Mes pasado")])],32)])]),e("div",ts,[e("div",ss,[e("div",os,[as,i.sales&&i.sales.data&&i.sales.data.length>0?(n(),l("a",{key:0,href:o.route("admin.physical-sales.export",{start_date:b.filters?.start_date,end_date:b.filters?.end_date}),class:"inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition"},[rs,g(" Exportar a Excel ")],8,ns)):c("",!0)]),e("div",ls,[e("table",is,[ds,e("tbody",cs,[(n(!0),l(F,null,B(i.sales.data,t=>(n(),l("tr",{key:t.id},[e("td",us,[_(h(Y),{href:o.route("admin.physical-sales.show",t.id),class:"hover:underline"},{default:m(()=>[g(r(t.sale_number),1)]),_:2},1032,["href"])]),e("td",ps,r(t.user?.name||"N/A"),1),e("td",ms,r(ie(t.created_at)),1),e("td",_s,r(t.payment_method),1),e("td",hs,r(D(t.subtotal)),1),e("td",gs,r(D(t.discount)),1),e("td",vs,r(D(t.total)),1),e("td",xs,[_(h(Y),{href:o.route("admin.physical-sales.show",t.id),class:"text-blue-600 hover:text-blue-900"},{default:m(()=>[g(" Ver ")]),_:2},1032,["href"])])]))),128)),!i.sales||!i.sales.data||i.sales.data.length===0?(n(),l("tr",ys,bs)):c("",!0)])])]),i.sales&&i.sales.links?(n(),ne(we,{key:0,class:"mt-6",links:i.sales.links},null,8,["links"])):c("",!0)])])])):c("",!0)])]),_(H,{show:P.value,onClose:s[18]||(s[18]=t=>P.value=!1)},{default:m(()=>[e("div",ws,[ks,e("div",Cs,[$s,x(e("select",{"onUpdate:modelValue":s[15]||(s[15]=t=>T.value=t),class:"w-full rounded-md border-gray-300"},js,512),[[fe,T.value]])]),e("div",Ss,[Ps,x(e("textarea",{"onUpdate:modelValue":s[16]||(s[16]=t=>U.value=t),class:"w-full rounded-md border-gray-300",rows:"3",placeholder:"Notas adicionales sobre la venta..."},null,512),[[f,U.value]])]),u.value.some(t=>t.discount_percent>0)?(n(),l("div",Es,[Bs,e("div",Ns,[(n(!0),l(F,null,B(u.value.filter(t=>t.discount_percent>0),(t,a)=>(n(),l("div",{key:a,class:"flex justify-between text-sm"},[e("span",Ts,r(t.product_name)+":",1),e("span",Us,"-"+r(t.discount_percent)+"% ("+r(D((t.original_price-t.unit_price)*t.quantity))+")",1)]))),128))])])):c("",!0),e("div",qs,[e("div",Ls,[Is,e("span",null,"$"+r(E.value.toFixed(2)),1)]),k.value>0?(n(),l("div",Os,[zs,e("span",null,"-$"+r((k.value||0).toFixed(2)),1)])):c("",!0),e("div",Rs,[As,e("span",null,"$"+r(I.value.toFixed(2)),1)])]),e("div",Ys,[_(Q,{onClick:s[17]||(s[17]=t=>P.value=!1)},{default:m(()=>[g("Cancelar")]),_:1}),_(re,{onClick:_e},{default:m(()=>[g("Confirmar Venta")]),_:1})])])]),_:1},8,["show"]),_(H,{show:N.value,onClose:s[21]||(s[21]=t=>N.value=!1)},{default:m(()=>[e("div",Hs,[Qs,$.value?(n(),l("div",Ks,[e("p",Gs,[g(" NÃºmero de venta: "),e("span",Ws,"#"+r($.value.sale_number),1)]),e("p",Js,[g(" Total: "),e("span",Xs,r(D($.value.total)),1)])])):c("",!0),e("div",Zs,[_(Q,{onClick:s[19]||(s[19]=t=>N.value=!1)},{default:m(()=>[g("Cerrar")]),_:1}),$.value?(n(),ne(re,{key:0,onClick:s[20]||(s[20]=t=>de($.value))},{default:m(()=>[g(" ðŸ–¨ï¸ Imprimir Factura ")]),_:1})):c("",!0)])])]),_:1},8,["show"]),_(H,{show:L.value,onClose:z},{default:m(()=>[e("div",eo,[to,so,e("div",oo,[x(e("input",{"onUpdate:modelValue":s[22]||(s[22]=t=>S.value=t),type:"text",placeholder:"CÃ³digo de barras...",class:"flex-1 rounded-md border-gray-300",onKeyup:s[23]||(s[23]=oe(t=>Z(S.value),["enter"]))},null,544),[[f,S.value]]),e("button",{onClick:s[24]||(s[24]=t=>Z(S.value)),class:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"}," Buscar ")]),_(Q,{onClick:z,class:"mt-4"},{default:m(()=>[g("Cerrar")]),_:1})])]),_:1},8,["show"])]),_:1})],64))}};export{po as default};
