import{A as Q,r as l,o as ve,n as pe,a as ge,c as Z,b as i,d as r,e as n,u as p,h as fe,f as a,g as e,i as g,m as E,j as L,p as k,q as z,k as f,s as ee,F as j,l as te,t as C,x as S,L as se,y as oe}from"./app-DSOEodqv.js";import{_ as _e}from"./AuthenticatedLayout-CIdVDnfy.js";import{u as xe}from"./index-KeuFesuB.js";import{_ as le}from"./Modal-DkZHA6uo.js";import{_ as ae}from"./SecondaryButton-DS6zJKLS.js";import{D as re}from"./DangerButton-V7Dgwovn.js";import{_ as ye}from"./AlertModal-PUHbo1QC.js";const we={class:"flex justify-between items-center"},be=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestionar Usuarios y Roles",-1),Ee=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),Le=e("span",null,"Crear",-1),ke=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),ze=e("span",null,"Crear",-1),Ce={class:"py-12"},Se={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Me={class:"p-6 text-gray-900"},Ae={class:"mb-4 border-b border-gray-200"},Ue={class:"-mb-px flex space-x-8","aria-label":"Tabs"},Fe={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},Be={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},Ne={class:"min-w-[720px] w-full divide-y divide-gray-200 table-auto"},Ve={class:"sticky top-0 z-10 bg-gray-50"},He=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),Te=[He],je=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Email",-1),De=e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Rol",-1),$e=e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")],-1),Ie={class:"bg-white divide-y divide-gray-200"},We=["title"],Xe={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},qe={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Oe={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},Ge={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-right text-sm font-medium"},Ke={class:"flex justify-end items-center gap-2"},Pe=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),Ye=["onClick"],Je=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),Qe=[Je],Ze={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},et={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},tt={class:"min-w-[520px] w-full divide-y divide-gray-200 table-auto"},st={class:"sticky top-0 z-10 bg-gray-50"},ot=e("div",{class:"mx-auto my-auto h-6 w-1.5 bg-gray-300 rounded-full group-hover:bg-indigo-400"},null,-1),lt=[ot],at=e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")],-1),rt={class:"bg-white divide-y divide-gray-200"},nt=["title"],it={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-right text-sm font-medium"},ct={class:"flex justify-end items-center gap-2"},dt=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),ut=["onClick"],ht=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),mt=[ht],vt={class:"p-6"},pt=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que quieres eliminar este usuario? ",-1),gt=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. ",-1),ft={class:"mt-6 flex justify-end"},_t={class:"p-6"},xt=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que quieres eliminar este rol? ",-1),yt=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. No podrás eliminar un rol si hay usuarios que lo tengan asignado. ",-1),wt={class:"mt-6 flex justify-end"},ne="users_firstcol_w_px",ie="roles_firstcol_w_px",bt=60,Et=320,At={__name:"Index",props:{users:Array,roles:Array},setup(D){const ce=Q().props.auth.user,R=Q(),c=l(R?.props?.ziggy?.query?.tab==="roles"?"roles":"users"),_=l(!!R.props.flash?.success),M=l(R.props.flash?.success||""),A=l(!1),U=l(null),de=t=>{U.value=t,A.value=!0},x=()=>{A.value=!1,U.value=null},ue=()=>{oe.delete(route("admin.users.destroy",U.value),{preserveScroll:!0,onSuccess:()=>{x(),M.value="¡Usuario eliminado con éxito!",_.value=!0},onError:()=>{x(),M.value="Hubo un error al eliminar el usuario.",_.value=!0}})},F=l(!1),B=l(null),$=xe(),he=t=>{B.value=t,F.value=!0},y=()=>{F.value=!1,B.value=null},me=()=>{oe.delete(route("admin.roles.destroy",B.value),{preserveScroll:!0,onSuccess:()=>{y(),$.success("¡Rol eliminado con éxito!")},onError:()=>{y(),$.error("No se puede eliminar un rol que está en uso.")}})},w=l(null),b=l(null),I=l(!1),W=l(!1),X=l(!1),q=l(!1),O=(t,o,s)=>{const d=t.value;if(!d)return;const T=d.scrollWidth-d.clientWidth,J=d.scrollLeft||0;o.value=J>0,s.value=J<T-1};ve(()=>{const t=()=>O(w,I,W),o=()=>O(b,X,q);pe(()=>{t(),o()}),w.value?.addEventListener("scroll",t,{passive:!0}),b.value?.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",t),window.addEventListener("resize",o)}),ge(()=>{w.value?.removeEventListener("scroll",()=>{}),b.value?.removeEventListener("scroll",()=>{}),window.removeEventListener("resize",()=>{})});const u=l(Number(localStorage.getItem(ne))||180),h=l(Number(localStorage.getItem(ie))||200),G=Z(()=>({width:u.value+"px",minWidth:u.value+"px",maxWidth:u.value+"px"})),K=Z(()=>({width:h.value+"px",minWidth:h.value+"px",maxWidth:h.value+"px"}));let N=0,V=0,H="users";const m=t=>{const o=t.touches?t.touches[0].clientX:t.clientX,s=Math.max(bt,Math.min(Et,V+(o-N)));H==="users"?u.value=s:h.value=s},v=()=>{document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",m),document.removeEventListener("touchend",v);try{localStorage.setItem(ne,String(u.value)),localStorage.setItem(ie,String(h.value))}catch{}},P=t=>{H="users",N=t.touches?t.touches[0].clientX:t.clientX,V=u.value,document.addEventListener("mousemove",m,{passive:!1}),document.addEventListener("mouseup",v),document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",v)},Y=t=>{H="roles",N=t.touches?t.touches[0].clientX:t.clientX,V=h.value,document.addEventListener("mousemove",m,{passive:!1}),document.addEventListener("mouseup",v),document.addEventListener("touchmove",m,{passive:!1}),document.addEventListener("touchend",v)};return(t,o)=>(r(),i(j,null,[n(p(fe),{title:"Gestionar Usuarios y Roles"}),n(_e,null,{header:a(()=>[e("div",we,[be,e("div",null,[c.value==="roles"?(r(),se(p(S),{key:0,href:t.route("admin.roles.create"),class:"inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow ml-4"},{default:a(()=>[Ee,Le]),_:1},8,["href"])):g("",!0),c.value==="users"?(r(),se(p(S),{key:1,href:t.route("admin.users.create"),class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},{default:a(()=>[ke,ze]),_:1},8,["href"])):g("",!0)])])]),default:a(()=>[e("div",Ce,[e("div",Se,[e("div",Re,[e("div",Me,[e("div",Ae,[e("nav",Ue,[e("button",{onClick:o[0]||(o[0]=s=>c.value="users"),class:E([c.value==="users"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Usuarios ",2),e("button",{onClick:o[1]||(o[1]=s=>c.value="roles"),class:E([c.value==="roles"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])}," Roles ",2)])]),c.value==="users"?(r(),i("div",{key:0,ref_key:"usersScrollRef",ref:w,class:"relative overflow-x-auto"},[L(e("div",Fe,null,512),[[k,I.value]]),L(e("div",Be,null,512),[[k,W.value]]),e("table",Ne,[e("thead",Ve,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:z(G.value)},[f(" Nombre "),e("div",{onMousedown:P,onTouchstart:ee(P,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},Te,32)],4),je,De,$e])]),e("tbody",Ie,[(r(!0),i(j,null,te(D.users,(s,d)=>(r(),i("tr",{key:s.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:E(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r truncate",d%2===1?"bg-gray-100":"bg-white"]),style:z(G.value),title:s.name},C(s.name),15,We),e("td",Xe,C(s.email),1),e("td",qe,[s.roles.length>0?(r(),i("span",Oe,C(s.roles[0].name),1)):g("",!0)]),e("td",Ge,[e("div",Ke,[n(p(S),{href:t.route("admin.users.edit",s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:a(()=>[Pe]),_:2},1032,["href"]),s.id!==p(ce).id?(r(),i("button",{key:0,onClick:T=>de(s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},Qe,8,Ye)):g("",!0)])])]))),128))])])],512)):g("",!0),c.value==="roles"?(r(),i("div",{key:1,ref_key:"rolesScrollRef",ref:b,class:"relative overflow-x-auto"},[L(e("div",Ze,null,512),[[k,X.value]]),L(e("div",et,null,512),[[k,q.value]]),e("table",tt,[e("thead",st,[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap relative",style:z(K.value)},[f(" Nombre del Rol "),e("div",{onMousedown:Y,onTouchstart:ee(Y,["prevent"]),class:"absolute top-0 right-0 h-full w-3 cursor-col-resize group"},lt,32)],4),at])]),e("tbody",rt,[(r(!0),i(j,null,te(D.roles,(s,d)=>(r(),i("tr",{key:s.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:E(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r truncate",d%2===1?"bg-gray-100":"bg-white"]),style:z(K.value),title:s.name},C(s.name),15,nt),e("td",it,[e("div",ct,[n(p(S),{href:t.route("admin.roles.edit",s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:a(()=>[dt]),_:2},1032,["href"]),e("button",{onClick:T=>he(s.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},mt,8,ut)])])]))),128))])])],512)):g("",!0)])])])])]),_:1}),n(le,{show:A.value,onClose:x},{default:a(()=>[e("div",vt,[pt,gt,e("div",ft,[n(ae,{onClick:x},{default:a(()=>[f(" Cancelar ")]),_:1}),n(re,{class:"ms-3",onClick:ue},{default:a(()=>[f(" Sí, Eliminar Usuario ")]),_:1})])])]),_:1},8,["show"]),n(le,{show:F.value,onClose:y},{default:a(()=>[e("div",_t,[xt,yt,e("div",wt,[n(ae,{onClick:y},{default:a(()=>[f(" Cancelar ")]),_:1}),n(re,{class:"ms-3",onClick:me},{default:a(()=>[f(" Sí, Eliminar Rol ")]),_:1})])])]),_:1},8,["show"]),n(ye,{show:_.value,type:"info",title:"Notificación",message:M.value,"primary-text":"Entendido",onPrimary:o[2]||(o[2]=s=>_.value=!1),onClose:o[3]||(o[3]=s=>_.value=!1)},null,8,["show","message"])],64))}};export{At as default};
