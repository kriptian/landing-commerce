import{A as ke,r as g,z as Ce,o as Se,a as je,c as z,w as Ae,b as a,d as i,e as A,u as d,h as Oe,f as M,g as e,s as _,i as O,j as v,v as w,O as Ve,m as N,F as k,l as j,t as C,C as K,k as F}from"./app-BJsUzWIY.js";import{_ as $e}from"./AuthenticatedLayout-lSpluC5c.js";import{_ as Z}from"./AlertModal-C4EBbWE2.js";import{_ as De}from"./Modal-BI8Mm2wF.js";import{_ as Me}from"./SecondaryButton-tVfUgZb4.js";import{D as Ee}from"./DangerButton-dpwaAEKb.js";const ze={class:"font-semibold text-xl text-gray-800 leading-tight"},Pe={class:"py-12"},Ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Te={class:"p-6 text-gray-900"},Be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qe={class:"mb-4"},Ne=e("label",{for:"name",class:"block font-medium text-sm text-gray-700"},"Nombre",-1),Fe={class:"mb-4"},Ge=e("label",{for:"price",class:"block font-medium text-sm text-gray-700"},"Precio (Principal)",-1),Le={class:"inline-flex items-center gap-2 mb-3 select-none"},He=e("span",{class:"font-semibold"},"Controlar inventario",-1),Re={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Qe=e("label",{for:"quantity",class:"block font-medium text-sm text-gray-700"},"Inventario (Total)",-1),We=["disabled"],Je=e("label",{for:"alert_general",class:"block font-medium text-sm text-gray-700"},"Alerta (Opcional)",-1),Xe=["disabled"],Ye=e("label",{for:"purchase_price",class:"block font-medium text-sm text-gray-700"},"Precio de compra",-1),Ke=e("div",{class:"mb-2"},[e("label",{class:"block font-medium text-sm text-gray-700"},"Categorías")],-1),Ze={class:"space-y-3"},et=["onUpdate:modelValue","onChange"],tt=e("option",{value:null},"Seleccione una categoría",-1),st=["value"],ot={class:"mb-4"},lt=e("label",{for:"short_description",class:"block font-medium text-sm text-gray-700"},"Descripción Corta",-1),nt={class:"mb-4"},rt=e("label",{for:"long_description",class:"block font-medium text-sm text-gray-700"},"Descripción Larga",-1),at={class:"mb-4"},it=e("label",{for:"specifications",class:"block font-medium text-sm text-gray-700"},"Especificaciones (separadas por comas)",-1),dt={class:"md:col-span-2 mt-6 border-t pt-6"},ct=e("h3",{class:"text-lg font-medium text-gray-900"},"Atributos de variantes",-1),ut=e("p",{class:"text-sm text-gray-600 mb-4"},'Definí atributos como "Color" y "Talla" y sus valores separados por comas. Podés regenerar combinaciones.',-1),pt={class:"mb-4 p-4 border rounded-md bg-gray-50"},mt={class:"space-y-2"},ht={class:"md:col-span-2"},ft=e("label",{class:"block text-sm font-medium text-gray-700"},"Nombre",-1),vt=["onUpdate:modelValue"],_t={class:"md:col-span-3"},gt=e("label",{class:"block text-sm font-medium text-gray-700"},"Valores (separados por coma)",-1),bt=["onUpdate:modelValue"],yt={class:"md:col-span-5 flex items-center gap-2"},xt=["onClick","title","aria-label"],wt={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},kt=e("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"},null,-1),Ct=[kt],St={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},jt=e("path",{d:"M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z"},null,-1),At=[jt],Ot=["textContent"],Vt={key:0,class:"md:col-span-5 grid grid-cols-1 md:grid-cols-5 gap-3 items-start"},$t={class:"md:col-span-2"},Dt=e("label",{class:"block text-sm font-medium text-gray-700"},"Depende de",-1),Mt=["onUpdate:modelValue"],Et=e("option",{value:""},"(sin dependencia)",-1),zt=["value","disabled"],Pt={key:0,class:"md:col-span-3"},Ut=e("label",{class:"block text-sm font-medium text-gray-700"},"Permitir valores del hijo según el valor del padre",-1),It={class:"mt-2 space-y-3"},Tt={class:"text-xs font-semibold text-gray-700 mb-2"},Bt={class:"flex flex-wrap gap-3"},qt=["checked","onChange"],Nt={class:"md:col-span-5 flex items-center gap-4 mt-3"},Ft=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[e("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"})],-1),Gt=[Ft],Lt=e("span",{class:"text-xs md:hidden"},"Añadir",-1),Ht={class:"flex items-center gap-2"},Rt=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[e("path",{d:"M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z"})],-1),Qt=[Rt],Wt=e("span",{class:"text-xs md:hidden"},"Quitar",-1),Jt={class:"mt-6 border-t pt-6"},Xt={class:"p-4 border rounded-md bg-gray-50 col-span-2"},Yt={class:"flex items-center justify-between mb-2"},Kt=e("label",{class:"block font-medium text-sm text-gray-700"},"Imágenes actuales",-1),Zt={class:"text-xs text-gray-500"},es={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3"},ts=["onClick"],ss=["src"],os=["onClick"],ls={key:1,class:"text-sm text-gray-500 mt-2"},ns={class:"mt-4 col-span-2"},rs=e("label",{for:"new_gallery_files",class:"block font-medium text-sm text-gray-700"},"Añadir más imágenes",-1),as=e("p",{class:"mt-1 text-xs text-gray-500"},"Formatos de imagen y hasta 2 MB por archivo.",-1),is={class:"relative flex items-center justify-center bg-gray-50 border rounded-lg h-[60vh] min-h-[320px] mb-3 select-none"},ds=["src"],cs={class:"flex items-center gap-2 overflow-x-auto py-2"},us=["onClick"],ps=["src"],ms={class:"md:col-span-2 flex items-center justify-end mt-6 border-t pt-6"},hs=["disabled"],fs=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),vs=e("span",null,"Guardar",-1),_s=[fs,vs],gs={class:"p-6"},bs=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Deseás guardar los cambios del producto? ",-1),ys=e("p",{class:"mt-1 text-sm text-gray-600"}," Se actualizará la información y variantes del producto. ",-1),xs={class:"mt-6 flex justify-end"},ws=2*1024*1024,Vs={__name:"Edit",props:{product:Object,categories:Array,selectedCategoryPath:Array},setup(ee){const c=ee,G=ke(),P=g(!!G?.props?.flash?.success);g(G?.props?.flash?.success||"");const E=g(!1),V=g(!1),U=g([]),te=o=>{const s=Array.from(o?.target?.files||[]),t=[],l=[];for(const n of s){if(!(n?.type||"").startsWith("image/")){t.push(`${n.name}: no es una imagen válida.`);continue}if(n.size>ws){t.push(`${n.name}: supera el límite de 2 MB.`);continue}l.push(n)}if(t.length){U.value=["Problemas con las imágenes seleccionadas:",...t],V.value=!0,o?.target&&(o.target.value=""),r.new_gallery_files=[];return}r.new_gallery_files=l},m=g([{options:c.categories,selected:null}]),se=async()=>{if(!Array.isArray(c.selectedCategoryPath)||c.selectedCategoryPath.length===0)return;for(let s=0;s<c.selectedCategoryPath.length;s++){const t=c.selectedCategoryPath[s];if(m.value[s]||(m.value[s]={options:[],selected:null}),s>0&&m.value[s].options.length===0){const l=m.value[s-1].selected;if(l){const u=await(await fetch(route("admin.categories.children",l))).json();m.value[s].options=Array.isArray(u.data)?u.data:[]}}m.value[s].selected=t.id,r.category_id=t.id,s<c.selectedCategoryPath.length-1&&(m.value[s+1]||(m.value[s+1]={options:[],selected:null}))}const o=r.category_id;if(o){const t=await(await fetch(route("admin.categories.children",o))).json(),l=Array.isArray(t.data)?t.data:[];l.length>0&&m.value.push({options:l,selected:null})}},oe=o=>{m.value.splice(o+1)},le=async o=>{const s=m.value[o].selected;if(oe(o),r.category_id=s||null,!s)return;const t=await fetch(route("admin.categories.children",s));if(!t.ok)return;const l=await t.json(),n=Array.isArray(l.data)?l.data:[];n.length>0&&m.value.push({options:n,selected:null})},ne=o=>Object.entries(o).map(([s,t])=>`${s}:${t}`).join(", "),re=c.product.variants.map(o=>({id:o.id,options_text:ne(o.options),price:o.price??"",purchase_price:o.purchase_price??null,retail_price:o.retail_price??null,stock:o.stock,alert:o.alert??null})),r=Ce({_method:"PUT",name:c.product.name,price:c.product.price,purchase_price:c.product.purchase_price??null,track_inventory:c.product.track_inventory??!0,quantity:c.product.quantity,alert:c.product.alert??null,category_id:c.product.category_id,short_description:c.product.short_description,long_description:c.product.long_description,specifications:c.product.specifications?JSON.parse(c.product.specifications).join(", "):"",new_gallery_files:[],images_to_delete:[],variants:re,variants_to_delete:[],variant_attributes:[]}),b=g([{name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}}]),ae=()=>{b.value.push({name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}})},ie=o=>{b.value.splice(o,1)},$=o=>String(o||"").split(",").map(s=>s.trim()).filter(Boolean);function de(o,s,t){return(o.rulesSelected&&Array.isArray(o.rulesSelected[s])?o.rulesSelected[s]:[]).includes(t)}function ce(o,s,t,l){const n=!!l?.target?.checked;o.rulesSelected||(o.rulesSelected={});const u=Array.isArray(o.rulesSelected[s])?[...o.rulesSelected[s]]:[],f=u.indexOf(t);n&&f===-1&&u.push(t),!n&&f!==-1&&u.splice(f,1),o.rulesSelected[s]=u}function ue(o){o.__showDependency=!o.__showDependency,o.__showDependency||(o.dependsOn="",o.rulesSelected={},o.rules={})}const pe=()=>{try{const o=Array.isArray(c.product.variants)?c.product.variants:[];if(o.length===0)return;const s=new Set;o.forEach(l=>{Object.keys(l?.options||{}).forEach(n=>s.add(n))});const t=[];s.forEach(l=>{const n=new Set;o.forEach(f=>{const p=(f?.options||{})[l];p!=null&&String(p).trim()!==""&&n.add(String(p))});const u=Array.from(n).join(", ");t.push({name:l,valuesText:u,dependsOn:"",rules:{},rulesSelected:{}})}),t.length>0&&(b.value=t)}catch{}},me=()=>{try{const o=c.product?.variant_attributes,s=Array.isArray(o)?o:[];if(s.length===0)return!1;const t=s.map(l=>{const n=Array.isArray(l?.values)?l.values:$(l?.valuesText||""),u=String(l?.dependsOn||"").trim(),f=typeof l?.rulesSelected=="object"&&l.rulesSelected?l.rulesSelected:{},p=typeof l?.rules=="object"&&l.rules?l.rules:{},x=!!(u||Object.keys(f).length||Object.keys(p).length);return{name:String(l?.name||""),valuesText:n.join(", "),dependsOn:u,rulesSelected:f,rules:p,__showDependency:x}}).filter(l=>l.name);if(t.length>0)return b.value=t,!0}catch{}return!1},he=()=>{try{const o=c.product?.variant_attributes||[];if(!Array.isArray(o)||o.length===0)return;const s=Object.fromEntries(b.value.map(t=>[t.name,t]));for(const t of o){const l=s[t.name];l&&(t.dependsOn&&(l.dependsOn=t.dependsOn,l.__showDependency=!0),t.rulesSelected&&typeof t.rulesSelected=="object"?(l.rulesSelected=t.rulesSelected,Object.keys(l.rulesSelected||{}).length>0&&(l.__showDependency=!0)):t.rules&&typeof t.rules=="object"&&(l.rules=t.rules,Object.keys(l.rules||{}).length>0&&(l.__showDependency=!0)))}}catch{}},h=g([...c.product.images]),L=o=>{r.images_to_delete.push(o.id),h.value=h.value.filter(s=>s.id!==o.id)},I=g(!1),y=g(0),H=g(!1);function T(){H.value=window.innerWidth<768}Se(()=>{T(),window.addEventListener("resize",T),se(),me()||(pe(),he())}),je(()=>window.removeEventListener("resize",T));const B=z(()=>H.value?1:4),fe=z(()=>h.value.slice(0,B.value)),R=z(()=>h.value.slice(B.value));function Q(o=0){y.value=o,I.value=!0}function W(){I.value=!1}function ve(){const o=h.value.length;o!==0&&(y.value=(y.value-1+o)%o)}function _e(){const o=h.value.length;o!==0&&(y.value=(y.value+1)%o)}function ge(o){o<0||o>=h.value.length||(y.value=o)}const be=z(()=>{if(r.variants.length>0){let o=0;return r.variants.forEach(s=>{o+=Number(s.stock)||0}),o}return Number(r.quantity)||0});Ae(be,o=>{r.variants.length>0&&(r.quantity=o)});const ye=()=>{try{const o=b.value.map(s=>({name:String(s.name||"").trim(),values:$(s.valuesText),dependsOn:String(s.dependsOn||"").trim(),rules:s.rules||{},rulesSelected:s.rulesSelected||{}})).filter(s=>s.name&&s.values.length>0);if(r.variant_attributes=o,o.length>0){let n=function(p){l.has(p.name)||(p.dependsOn&&s[p.dependsOn]&&n(s[p.dependsOn]),l.add(p.name),t.push(p))},f=function(p,x){if(p===t.length){u.push({...x});return}const S=t[p];let X=S.values;if(S.dependsOn){const D=x[S.dependsOn];if(D!=null){const q=S.rulesSelected?.[D]??S.rules?.[D]??[],Y=Array.isArray(q)?q:$(q);Y.length>0&&(X=S.values.filter(we=>Y.includes(we)))}}for(const D of X)x[S.name]=D,f(p+1,x);delete x[S.name]};const s=Object.fromEntries(o.map(p=>[p.name,p])),t=[],l=new Set;o.forEach(n);const u=[];f(0,{}),r.variants=u.map(p=>({id:null,options_text:t.map(x=>`${x.name}:${p[x.name]}`).join(", "),price:"",purchase_price:null,stock:0,alert:null}))}else r.variants=[]}catch{}E.value=!0},J=()=>{E.value=!1},xe=()=>{r.post(route("admin.products.update",c.product.id),{onError:async()=>{const o=[];for(const[s,t]of Object.entries(r.errors))s.startsWith("new_gallery_files.")&&String(t).toLowerCase().includes("image")?o.push("Una o más imágenes nuevas superan el tamaño máximo permitido (2 MB) o no son válidas."):o.push(String(t));U.value=o,V.value=o.length>0},onFinish:()=>{E.value=!1}})};return(o,s)=>(i(),a(k,null,[A(d(Oe),{title:"Editar Producto"}),A($e,null,{header:M(()=>[e("h2",ze,"Editar Producto: "+C(d(r).name),1)]),default:M(()=>[e("div",Pe,[e("div",Ue,[e("div",Ie,[e("div",Te,[e("form",{onSubmit:_(ye,["prevent"])},[e("div",Be,[e("div",null,[e("div",qe,[Ne,v(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=t=>d(r).name=t),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,d(r).name]])]),e("div",Fe,[Ge,v(e("input",{id:"price","onUpdate:modelValue":s[1]||(s[1]=t=>d(r).price=t),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[w,d(r).price]])]),e("label",Le,[v(e("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=t=>d(r).track_inventory=t),class:"rounded"},null,512),[[Ve,d(r).track_inventory]]),He]),d(r).track_inventory?(i(),a("div",Re,[e("div",null,[Qe,v(e("input",{id:"quantity","onUpdate:modelValue":s[3]||(s[3]=t=>d(r).quantity=t),type:"number",class:N(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,required:"",title:"Stock si no hay variantes. Con variantes, se suma automáticamente."},null,10,We),[[w,d(r).quantity]])]),e("div",null,[Je,v(e("input",{id:"alert_general","onUpdate:modelValue":s[4]||(s[4]=t=>d(r).alert=t),type:"number",class:N(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,title:"Se considera bajo stock cuando cantidad ≤ alerta."},null,10,Xe),[[w,d(r).alert]])]),e("div",null,[Ye,v(e("input",{id:"purchase_price","onUpdate:modelValue":s[5]||(s[5]=t=>d(r).purchase_price=t),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[w,d(r).purchase_price]])])])):O("",!0),Ke,e("div",Ze,[(i(!0),a(k,null,j(m.value,(t,l)=>(i(),a("div",{key:l,class:"mb-1"},[v(e("select",{class:"block w-full rounded-md shadow-sm border-gray-300","onUpdate:modelValue":n=>t.selected=n,onChange:n=>le(l)},[tt,(i(!0),a(k,null,j(t.options,n=>(i(),a("option",{key:n.id,value:n.id},C(n.name),9,st))),128))],40,et),[[K,t.selected]])]))),128))])]),e("div",null,[e("div",ot,[lt,v(e("textarea",{id:"short_description","onUpdate:modelValue":s[6]||(s[6]=t=>d(r).short_description=t),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3"},null,512),[[w,d(r).short_description]])]),e("div",nt,[rt,v(e("textarea",{id:"long_description","onUpdate:modelValue":s[7]||(s[7]=t=>d(r).long_description=t),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"5"},null,512),[[w,d(r).long_description]])]),e("div",at,[it,v(e("input",{id:"specifications","onUpdate:modelValue":s[8]||(s[8]=t=>d(r).specifications=t),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[w,d(r).specifications]])])])]),e("div",dt,[ct,ut,e("div",pt,[e("div",mt,[(i(!0),a(k,null,j(b.value,(t,l)=>(i(),a("div",{key:`attr-${l}`,class:"grid grid-cols-1 md:grid-cols-5 gap-3 items-center"},[e("div",ht,[ft,v(e("input",{"onUpdate:modelValue":n=>t.name=n,type:"text",placeholder:"Color",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,vt),[[w,t.name]])]),e("div",_t,[gt,v(e("input",{"onUpdate:modelValue":n=>t.valuesText=n,type:"text",placeholder:"Rojo, Verde, Azul",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,bt),[[w,t.valuesText]])]),e("div",yt,[e("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:n=>ue(t),title:t.__showDependency?"Ocultar dependencia":"Configurar dependencia","aria-label":t.__showDependency?"Ocultar dependencia":"Configurar dependencia"},[t.__showDependency?(i(),a("svg",St,At)):(i(),a("svg",wt,Ct))],8,xt),e("span",{class:"text-xs text-blue-600 md:hidden",textContent:C(t.__showDependency?"Ocultar":"Depend.")},null,8,Ot)]),t.__showDependency?(i(),a("div",Vt,[e("div",$t,[Dt,v(e("select",{"onUpdate:modelValue":n=>t.dependsOn=n,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},[Et,(i(!0),a(k,null,j(b.value,(n,u)=>(i(),a("option",{key:`dep-${l}-${u}`,value:n.name,disabled:n===t||!n.name},C(n.name||"(sin nombre)"),9,zt))),128))],8,Mt),[[K,t.dependsOn]])]),t.dependsOn?(i(),a("div",Pt,[Ut,e("div",It,[(i(!0),a(k,null,j($(b.value.find(n=>n.name===t.dependsOn)?.valuesText||""),n=>(i(),a("div",{key:`pv-${l}-${n}`,class:"border rounded p-2"},[e("div",Tt,[F(C(t.dependsOn)+" = ",1),e("strong",null,C(n),1)]),e("div",Bt,[(i(!0),a(k,null,j($(t.valuesText),u=>(i(),a("label",{key:`cv-${l}-${n}-${u}`,class:"inline-flex items-center gap-1 text-sm"},[e("input",{type:"checkbox",checked:de(t,n,u),onChange:f=>ce(t,n,u,f),class:"rounded"},null,40,qt),e("span",null,C(u),1)]))),128))])]))),128))])])):O("",!0)])):O("",!0)]))),128))]),e("div",Nt,[e("div",{class:"flex items-center gap-2"},[e("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:ae,title:"Añadir atributo","aria-label":"Añadir atributo"},Gt),Lt]),e("div",Ht,[e("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300",onClick:s[9]||(s[9]=t=>ie(b.value.length-1)),title:"Quitar atributo","aria-label":"Quitar atributo"},Qt),Wt])])])]),e("div",Jt,[e("div",Xt,[e("div",Yt,[Kt,e("span",Zt,C(h.value.length)+" imagen(es)",1)]),h.value.length>0?(i(),a("div",es,[(i(!0),a(k,null,j(fe.value,(t,l)=>(i(),a("div",{key:t.id,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer",onClick:n=>Q(l)},[e("img",{src:t.path,class:"w-full h-full aspect-[4/3] object-cover",alt:"Imagen del producto"},null,8,ss),e("button",{onClick:_(n=>L(t),["stop","prevent"]),type:"button",class:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center shadow-md hover:bg-red-700"}," × ",8,os)],8,ts))),128)),R.value.length>0?(i(),a("div",{key:0,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer flex items-center justify-center text-gray-800 font-bold text-base h-full min-h-[90px]",onClick:s[10]||(s[10]=t=>Q(B.value))}," +"+C(R.value.length),1)):O("",!0)])):(i(),a("p",ls,"Este producto no tiene imágenes."))]),e("div",ns,[rs,e("input",{id:"new_gallery_files",onInput:s[11]||(s[11]=t=>te(t)),type:"file",multiple:"",class:"block mt-1 w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),as])]),I.value?(i(),a("div",{key:0,class:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",style:{"pointer-events":"auto"},onClick:_(W,["self"])},[e("div",{class:"bg-white rounded-lg p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden relative",onClick:s[17]||(s[17]=_(()=>{},["stop"]))},[e("button",{type:"button",class:"absolute top-3 right-3 bg-gray-900 text-white rounded-full w-8 h-8 flex items-center justify-center z-30",onClick:_(W,["stop","prevent"]),onMousedown:s[12]||(s[12]=_(()=>{},["stop","prevent"]))},"×",32),e("div",is,[e("button",{class:"absolute left-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:_(ve,["stop","prevent"]),onMousedown:s[13]||(s[13]=_(()=>{},["stop","prevent"]))},"‹",32),e("img",{src:h.value[y.value]?.path,class:"max-w-full max-h-full object-contain",alt:"Imagen"},null,8,ds),e("button",{class:"absolute right-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:_(_e,["stop","prevent"]),onMousedown:s[14]||(s[14]=_(()=>{},["stop","prevent"]))},"›",32),h.value[y.value]?(i(),a("button",{key:0,class:"absolute top-2 right-12 bg-red-600 text-white rounded px-2 py-1 text-xs z-20",type:"button",onClick:s[15]||(s[15]=_(t=>L(h.value[y.value]),["stop","prevent"])),onMousedown:s[16]||(s[16]=_(()=>{},["stop","prevent"]))},"Eliminar",32)):O("",!0)]),e("div",cs,[(i(!0),a(k,null,j(h.value,(t,l)=>(i(),a("div",{key:t.id,class:N(["border rounded p-1 cursor-pointer flex-shrink-0",{"ring-2 ring-blue-500":l===y.value}]),onClick:n=>ge(l)},[e("img",{src:t.path,class:"w-20 h-20 object-cover rounded",alt:"thumb"},null,8,ps)],10,us))),128))])])])):O("",!0),e("div",ms,[e("button",{type:"submit",disabled:d(r).processing,class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},_s,8,hs)])],32)])])])])]),_:1}),A(De,{show:E.value,onClose:J},{default:M(()=>[e("div",gs,[bs,ys,e("div",xs,[A(Me,{onClick:J},{default:M(()=>[F("Cancelar")]),_:1}),A(Ee,{class:"ms-3",onClick:xe,disabled:d(r).processing},{default:M(()=>[F(" Guardar cambios ")]),_:1},8,["disabled"])])])]),_:1},8,["show"]),A(Z,{show:P.value,type:"success",title:"Producto actualizado","primary-text":"Entendido",onPrimary:s[18]||(s[18]=t=>P.value=!1),onClose:s[19]||(s[19]=t=>P.value=!1)},null,8,["show"]),A(Z,{show:V.value,type:"error",title:"No pudimos actualizar el producto",message:"Revisá los siguientes puntos:",messages:U.value,"primary-text":"Entendido",onPrimary:s[20]||(s[20]=t=>V.value=!1),onClose:s[21]||(s[21]=t=>V.value=!1)},null,8,["show","messages"])],64))}};export{Vs as default};
