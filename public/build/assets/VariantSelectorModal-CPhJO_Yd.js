import{_ as j}from"./Modal-CeUYkVjj.js";import{_ as A}from"./SecondaryButton-CsdLUJtp.js";import{_ as P}from"./PrimaryButton-BkNxEDiy.js";import{r as M,c,w as T,y as E,o as n,e as _,f as o,a as i,i as w,t as d,p as h,F as C,n as V,b as D,m as O}from"./app-BbGXU1BN.js";const I={class:"p-6"},z={class:"text-lg font-medium text-gray-900 mb-4"},L={key:0,class:"mb-4 p-3 bg-blue-50 rounded-lg flex justify-between items-center text-blue-800"},q={class:"flex flex-col"},G=o("span",{class:"font-medium text-sm"},"Precio:",-1),H={class:"flex items-center gap-2"},J={key:0,class:"text-sm text-gray-500 line-through"},K={class:"flex flex-col text-right"},Q=o("span",{class:"font-medium text-sm"},"Stock Disponible:",-1),R={class:"text-xl font-bold"},U={key:1,class:"space-y-6"},W={class:"text-sm font-semibold text-gray-700 mb-2"},X={class:"flex flex-wrap gap-2"},Y=["onClick"],Z={key:2,class:"py-4 text-center text-gray-500"},tt={class:"mt-6 flex justify-end gap-3"},nt={__name:"VariantSelectorModal",props:{show:Boolean,product:Object},emits:["close","add-to-cart"],setup(l,{emit:S}){const r=l,g=S,u=M({}),x=c(()=>r.product?.variants||[]),f=c(()=>r.product?.variant_options||[]);T(()=>r.show,t=>{t&&(u.value={})});const $=(t,s)=>u.value[t]===s,F=(t,s)=>{u.value[t]=s},y=c(()=>f.value.length?f.value.every(t=>!!u.value[t.name]):!0),b=()=>x.value.length?x.value.find(t=>{const s=t.options;return s?Object.entries(u.value).every(([a,e])=>{const v=s[a];return v==null||e==null?v==e:String(v).trim()===String(e).trim()}):!1}):null,m=c(()=>b()),N=c(()=>m.value?m.value.stock:null),p=c(()=>{let t=r.product?.price;if(m.value){const e=m.value.price;e!==null&&e!==""&&e!==void 0&&(t=e)}t=parseFloat(t||0);let s=t,a=!1;if(r.product?.promo_active&&r.product?.promo_discount_percent>0){const e=parseFloat(r.product.promo_discount_percent);s=Math.round(t*(1-e/100)),a=!0}return{original:t,final:s,hasDiscount:a}}),k=t=>t==null?"":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),B=()=>{const t=b();t?(g("add-to-cart",r.product,t),g("close")):alert("Esta combinación de variantes no está disponible.")};return(t,s)=>(n(),E(j,{show:l.show,onClose:s[1]||(s[1]=a=>t.$emit("close"))},{default:_(()=>[o("div",I,[o("h2",z," Seleccionar Variante: "+d(l.product?.name),1),m.value?(n(),i("div",L,[o("div",q,[G,o("div",H,[p.value.hasDiscount?(n(),i("span",J,d(k(p.value.original)),1)):w("",!0),o("span",{class:h(["text-xl font-bold",p.value.hasDiscount?"text-blue-600":"text-gray-900"])},d(k(p.value.final)),3)])]),o("div",K,[Q,o("span",R,d(!l.product?.track_inventory||l.product?.track_inventory==="0"||l.product?.track_inventory===0?"Ilimitado":N.value??"N/A"),1)])])):w("",!0),f.value.length>0?(n(),i("div",U,[(n(!0),i(C,null,V(f.value,a=>(n(),i("div",{key:a.id},[o("h3",W,d(a.name),1),o("div",X,[(n(!0),i(C,null,V(a.children,e=>(n(),i("button",{key:e.id,onClick:v=>F(a.name,e.name),class:h(["px-4 py-2 text-sm rounded-md border transition-colors",[$(a.name,e.name)?"bg-indigo-600 text-white border-indigo-600 shadow-sm":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"]])},d(e.name),11,Y))),128))])]))),128))])):(n(),i("div",Z," No hay opciones disponibles para este producto. ")),o("div",tt,[D(A,{onClick:s[0]||(s[0]=a=>t.$emit("close"))},{default:_(()=>[O(" Cancelar ")]),_:1}),D(P,{onClick:B,disabled:!y.value,class:h({"opacity-50 cursor-not-allowed":!y.value})},{default:_(()=>[O(" Agregar al Carrito ")]),_:1},8,["disabled","class"])])])]),_:1},8,["show"]))}};export{nt as default};
