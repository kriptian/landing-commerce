import{c as F,z as D,r as y,b as l,d as i,e as v,g as e,f as V,i as b,u as a,h as q,t as c,s as j,j as p,v as g,F as h,l as w,k as E}from"./app-oUIW5Gez.js";import{_ as O}from"./AlertModal-CcpJFjPK.js";import"./Modal-DwpvmuMs.js";const U=["href"],z={class:"bg-white shadow-sm sticky top-0 z-40"},I={class:"container mx-auto px-6 py-4 flex items-center gap-3"},B=["src","alt"],M={class:"text-lg font-medium text-gray-600"},T={class:"container mx-auto px-6 py-12"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-12"},A=e("h1",{class:"text-xl sm:text-2xl font-medium text-gray-600 mb-6"},"Datos de Envío",-1),S=e("label",{for:"customer_name",class:"block font-medium text-sm text-gray-700 mb-2"},"Nombre Completo",-1),L=e("label",{for:"customer_phone",class:"block font-medium text-sm text-gray-700 mb-2"},"Teléfono (WhatsApp)",-1),R=e("label",{for:"customer_email",class:"block font-medium text-sm text-gray-700 mb-2"},"Correo Electrónico",-1),W=e("label",{for:"customer_address",class:"block font-medium text-sm text-gray-700 mb-2"},"Dirección Completa (con ciudad y detalles)",-1),H=["disabled"],G={class:"bg-white/95 backdrop-blur-sm p-8 lg:p-10 rounded-2xl shadow-2xl border border-gray-100 sticky top-24 transform transition-all hover:shadow-3xl"},J=e("h2",{class:"text-xl sm:text-2xl font-medium text-gray-600 mb-6"},"Resumen de tu Pedido",-1),K={class:"space-y-4"},Q={class:"flex items-start gap-3 flex-1 min-w-0"},X=["src"],Y={class:"min-w-0"},Z={class:"font-semibold text-gray-900 break-words"},ee={key:0,class:"text-sm text-gray-500 break-words mt-1"},te={class:"text-sm text-gray-600 mt-1"},re={class:"font-semibold text-gray-900 whitespace-nowrap shrink-0 sm:text-right mt-2 sm:mt-0"},oe={class:"border-t border-gray-200 mt-6 pt-6"},se={class:"flex justify-between items-center"},ae=e("span",{class:"text-lg font-medium text-gray-600"},"Total",-1),ne={class:"text-2xl font-bold text-gray-900"},ue={__name:"CheckoutPage",props:{cartItems:Array,store:Object},setup(n){const u=n,k=o=>{const r=o?.variant||null,t=o?.product||null;if(r&&t&&t.track_inventory!==!1){const m=r.price!=null&&r.price!==""?Number(r.price):null;if(m!==null)return m}return t&&t.price!=null?Number(t.price):0},N=o=>{try{return u.store?.promo_active&&Number(u.store?.promo_discount_percent||0)>0?Number(u.store.promo_discount_percent):o?.product?.promo_active&&Number(o?.product?.promo_discount_percent||0)>0?Number(o.product.promo_discount_percent):0}catch{return 0}},_=o=>{const r=k(o),t=N(o);return t>0?Math.round(r*(100-t)/100):r},C=F(()=>u.cartItems.reduce((o,r)=>o+_(r)*r.quantity,0)),s=D({customer_name:"",customer_phone:"",customer_email:"",customer_address:""}),d=y(!1),f=y(""),P=()=>{s.post(route("checkout.store",{store:u.store.slug}),{onSuccess:()=>{},onError:o=>{f.value="Hubo un error al procesar tu pedido. Por favor verificá tus datos.",d.value=!0}})};return(o,r)=>(i(),l(h,null,[v(a(q),{title:"Finalizar Compra"},{default:V(()=>[n.store?.logo_url?(i(),l("link",{key:0,rel:"icon",type:"image/png",href:n.store.logo_url},null,8,U)):b("",!0)]),_:1}),e("header",z,[e("nav",I,[n.store?.logo_url?(i(),l("img",{key:0,src:n.store.logo_url,alt:`Logo de ${n.store.name}`,class:"h-10 w-10 rounded-full object-cover ring-2 ring-gray-100"},null,8,B)):b("",!0),e("h1",M,c(n.store.name),1)])]),e("main",T,[e("div",$,[e("div",null,[A,e("form",{onSubmit:j(P,["prevent"]),class:"space-y-6 bg-white p-8 lg:p-10 shadow-2xl rounded-2xl border border-gray-100 backdrop-blur-sm transform transition-all hover:shadow-3xl"},[e("div",null,[S,p(e("input",{id:"customer_name","onUpdate:modelValue":r[0]||(r[0]=t=>a(s).customer_name=t),type:"text",class:"block w-full rounded-xl shadow-sm border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all py-3 px-4 bg-gray-50 hover:bg-white",required:""},null,512),[[g,a(s).customer_name]])]),e("div",null,[L,p(e("input",{id:"customer_phone","onUpdate:modelValue":r[1]||(r[1]=t=>a(s).customer_phone=t),type:"tel",class:"block w-full rounded-xl shadow-sm border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all py-3 px-4 bg-gray-50 hover:bg-white",required:""},null,512),[[g,a(s).customer_phone]])]),e("div",null,[R,p(e("input",{id:"customer_email","onUpdate:modelValue":r[2]||(r[2]=t=>a(s).customer_email=t),type:"email",class:"block w-full rounded-xl shadow-sm border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all py-3 px-4 bg-gray-50 hover:bg-white",required:""},null,512),[[g,a(s).customer_email]])]),e("div",null,[W,p(e("textarea",{id:"customer_address","onUpdate:modelValue":r[3]||(r[3]=t=>a(s).customer_address=t),class:"block w-full rounded-xl shadow-sm border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all py-3 px-4 bg-gray-50 hover:bg-white resize-none",rows:"3",required:""},null,512),[[g,a(s).customer_address]])]),e("button",{type:"submit",disabled:a(s).processing,class:"w-full bg-green-600 text-white font-bold py-4 px-6 rounded-xl text-center hover:bg-green-700 disabled:opacity-50 transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-xl"},c(a(s).processing?"Procesando...":"Realizar Pedido por WhatsApp"),9,H)],32)]),e("div",G,[J,e("div",K,[(i(!0),l(h,null,w(n.cartItems,t=>(i(),l("div",{key:t.id,class:"flex flex-col sm:flex-row sm:items-start sm:justify-between sm:gap-4 p-3 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",Q,[e("img",{src:t.product.main_image_url,class:"w-16 h-16 object-cover rounded-lg shadow-sm ring-1 ring-gray-200"},null,8,X),e("div",Y,[e("p",Z,c(t.product.name),1),t.variant?(i(),l("div",ee,[(i(!0),l(h,null,w(t.variant.options,(m,x)=>(i(),l("span",{key:x,class:"mr-2 inline-block"},[e("strong",null,c(x)+":",1),E(" "+c(m),1)]))),128))])):b("",!0),e("p",te,"Cantidad: "+c(t.quantity),1)])]),e("p",re,c(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(_(t)*t.quantity)),1)]))),128))]),e("div",oe,[e("div",se,[ae,e("span",ne,c(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(C.value)),1)])])])])]),v(O,{show:d.value,type:"error",title:"No pudimos procesar tu pedido",message:f.value,"primary-text":"Entendido",onPrimary:r[4]||(r[4]=t=>d.value=!1),onClose:r[5]||(r[5]=t=>d.value=!1)},null,8,["show","message"])],64))}};export{ue as default};
