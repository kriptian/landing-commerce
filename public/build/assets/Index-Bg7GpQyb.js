const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BiOBv8GB.js","assets/app-0egssrK_.js","assets/app-CA4S4Tw8.css"])))=>i.map(i=>d[i]);
import{H as je,c as H,r as u,u as _t,w as Se,B as mt,z as de,D as ft,a as l,o as a,b as g,d as $e,h as gt,e as y,i as h,f as e,s as xt,m as b,j as B,A as Pe,q as J,p as Y,F as j,n as L,t as r,g as bt,x as Ee,y as yt,C as Ge,_ as wt}from"./app-0egssrK_.js";import{_ as kt}from"./AuthenticatedLayout-CtszKNy0.js";import{d as Ct,s as Mt}from"./pdfUtils-BLIKRL3P.js";import{_ as Tt}from"./AlertModal-DsyfJp1a.js";import{_ as Z}from"./Modal-Dhxr8x_F.js";import{_ as ue}from"./SecondaryButton-Be1aOt7J.js";import{_ as he}from"./PrimaryButton-CyRZBzGC.js";import jt from"./ExpenseModal-CWeNXmL4.js";import St from"./VariantSelectorModal-465dKVFE.js";import"./InputError-Bl7KzXZu.js";const $t={key:0,class:"font-semibold text-xl text-gray-800 leading-tight"},Pt={key:0,class:"hidden lg:flex fixed inset-0 bg-white flex-row",style:{"margin-top":"0","z-index":"10"}},Et={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},Dt={class:"flex items-center gap-3 mb-3"},Nt=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),Ft=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),qt={class:"flex-1 relative"},Bt=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),Ot=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),Vt=[Ot],Lt={class:"flex items-center gap-2 overflow-x-auto"},Rt=["onClick"],At={class:"flex-1 overflow-y-auto p-4"},zt={key:0,class:"text-center py-12 text-gray-500"},It=e("p",null,"No se encontraron productos",-1),Xt=[It],Ht={key:1,class:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3"},Kt=["onClick"],Ut={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},Gt=["src","alt"],Wt={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qt=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),Jt=[Qt],Yt={class:"p-2 flex-1 flex flex-col"},Zt={class:"mb-1"},es={class:"text-xs line-through text-red-600"},ts={class:"text-sm font-bold text-green-600"},ss={key:1,class:"text-sm font-bold text-gray-900"},os=["title"],ns=e("div",{class:"h-8 w-1 bg-gray-400 rounded-full group-hover:bg-white"},null,-1),as=[ns],ls={class:"flex-1 h-full flex flex-col bg-white overflow-hidden",style:{"min-width":"300px"}},rs={class:"bg-blue-50 border-b border-blue-100 px-4 py-3 flex-shrink-0"},is={class:"flex items-center gap-3"},cs=e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),ds={class:"text-blue-700 font-semibold"},us=e("span",{class:"text-blue-400"},"|",-1),hs=["src","alt"],ps={key:1,class:"text-blue-700 font-medium text-sm"},vs={class:"flex-1 overflow-y-auto px-3 py-2"},_s={key:0,class:"text-center py-12 text-gray-500"},ms=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),fs=e("p",null,"El carrito está vacío",-1),gs=[ms,fs],xs={key:1,class:"overflow-x-auto"},bs={class:"w-full text-sm"},ys=e("thead",{class:"bg-gray-50 border-b border-gray-200"},[e("tr",null,[e("th",{class:"px-3 py-3 text-left text-xs font-semibold text-gray-700"},"Producto"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"},"Stock"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-20"},"Cant"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-40"},"Valor"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-32"},"Desc"),e("th",{class:"px-3 py-3 text-right text-xs font-semibold text-gray-700 w-36"},"SubTotal"),e("th",{class:"px-3 py-3 text-center text-xs font-semibold text-gray-700 w-16"})])],-1),ws={class:"divide-y divide-gray-200 bg-white"},ks=["title"],Cs={class:"min-w-0",style:{"max-width":"140px"}},Ms={class:"font-medium text-gray-900"},Ts={key:0,class:"text-xs text-gray-500 ml-1"},js=["title"],Ss=["title"],$s=["value","onChange"],Ps=["title"],Es=["value","onInput"],Ds=["title"],Ns=["onClick"],Fs={key:1,class:"relative"},qs=["value","onChange","onClick"],Bs=e("span",{class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm font-medium pointer-events-none"},"%",-1),Os=["title"],Vs={class:"font-semibold text-gray-900 text-sm"},Ls={class:"px-3 py-3 text-center align-middle w-16"},Rs=["onClick"],As=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),zs=[As],Is={key:0,class:"border-t border-gray-200 px-4 py-3 bg-gray-50 space-y-3 flex-shrink-0"},Xs={class:"flex justify-between text-sm"},Hs=e("span",{class:"text-gray-700"},"Total Bruto:",-1),Ks={class:"font-medium"},Us={class:"flex justify-between text-sm items-center"},Gs=e("span",{class:"text-gray-700"},"Descuento:",-1),Ws=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),Qs={class:"pt-2 border-t border-gray-300"},Js={class:"flex justify-between items-center mb-3"},Ys=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),Zs={class:"text-base font-bold text-green-600"},eo={class:"flex gap-3"},to={key:1,class:"lg:hidden fixed inset-0 bg-white flex flex-col",style:{"margin-top":"0","z-index":"10"}},so={class:"bg-blue-500 px-4 py-3 flex-shrink-0"},oo={class:"flex items-center justify-between"},no={class:"flex items-center gap-2"},ao=e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),lo={class:"text-white font-semibold"},ro=e("span",{class:"text-white"},"|",-1),io=["src","alt"],co={key:1,class:"text-white font-medium text-sm"},uo={class:"bg-gray-100 px-4 py-3 flex-shrink-0 border-b border-gray-200"},ho={class:"flex items-center gap-2"},po=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1),vo=[po],_o=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),mo=[_o],fo={class:"flex-1 relative"},go=e("svg",{class:"absolute left-3 top-3 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),xo=e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2.01M8 8h.01M12 8h.01M16 8h.01M20 8h.01M5 12h2.01M8 12h.01M12 12h2.01M16 12h.01M20 12h.01M5 16h2.01M8 16h.01M12 16h.01M16 16h.01M20 16h.01"})],-1),bo=[xo],yo={key:0,class:"mt-3 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto"},wo=["onClick"],ko={class:"w-12 h-12 bg-gray-100 rounded flex items-center justify-center flex-shrink-0"},Co=["src","alt"],Mo={key:1,class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},To=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),jo=[To],So={class:"flex-1 min-w-0"},$o={class:"font-medium text-sm text-gray-900 truncate"},Po={class:"text-xs line-through text-red-600"},Eo={class:"text-xs text-green-600 font-semibold"},Do={key:1,class:"text-xs text-gray-500"},No=e("svg",{class:"w-5 h-5 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Fo=e("div",{class:"bg-gray-200 px-4 py-2 flex-shrink-0"},[e("div",{class:"flex items-center gap-2"},[e("div",{class:"w-8 h-8 bg-blue-400 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})])]),e("h3",{class:"text-gray-700 font-semibold text-sm"},"INFORMACION DE LA VENTA")])],-1),qo={class:"flex-1 overflow-y-auto bg-white"},Bo={key:0,class:"text-center py-12 text-gray-500"},Oo=e("svg",{class:"w-16 h-16 mx-auto mb-4 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 3h2l.4 2M7 13h10l3.6-7H6.4M7 13L5.4 6M7 13l-2 9m12-9l2 9M9 22a1 1 0 100-2 1 1 0 000 2zm8 0a1 1 0 100-2 1 1 0 000 2z"})],-1),Vo=e("p",null,"No hay productos en el carrito",-1),Lo=e("p",{class:"text-xs text-gray-400 mt-2"},"Busca o escanea un producto para comenzar",-1),Ro=[Oo,Vo,Lo],Ao={key:1,class:"divide-y divide-gray-200"},zo={class:"flex items-start justify-between gap-3"},Io={class:"flex-1 min-w-0"},Xo={class:"flex items-center gap-2 mb-1"},Ho={key:0,class:"text-xs text-red-600 font-semibold"},Ko={class:"font-medium text-sm text-gray-900 mb-1"},Uo={class:"text-xs text-gray-500"},Go={class:"flex items-center gap-3"},Wo={class:"flex flex-col items-center gap-1"},Qo=e("span",{class:"text-xs text-gray-500"},"Cant",-1),Jo={class:"flex items-center gap-1"},Yo=["onClick"],Zo={class:"w-10 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full font-semibold text-sm"},en=["onClick"],tn={class:"flex flex-col items-end gap-1 min-w-[80px]"},sn=e("span",{class:"text-xs text-gray-500"},"Total",-1),on={class:"font-semibold text-sm text-gray-900"},nn=["onClick"],an=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),ln=[an],rn=["onClick"],cn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),dn=[cn],un={key:0,class:"border-t border-gray-300 bg-white px-4 py-4 flex-shrink-0"},hn={class:"space-y-2 mb-4"},pn={class:"flex justify-between text-sm"},vn=e("span",{class:"text-gray-700"},"Subtotal:",-1),_n={class:"font-medium text-green-600"},mn={class:"flex justify-between text-sm"},fn=e("span",{class:"text-gray-700"},"Descuento:",-1),gn=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1),xn={class:"flex justify-between items-center pt-2 border-t border-gray-300"},bn=e("span",{class:"text-base font-bold text-gray-900"},"Total Compra:",-1),yn={class:"text-base font-bold text-green-600"},wn={class:"flex gap-3"},kn={class:"p-6"},Cn=e("h2",{class:"text-lg font-semibold mb-4"},"Confirmar Venta",-1),Mn={class:"mb-4"},Tn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Método de Pago",-1),jn=e("option",{value:"efectivo"},"Efectivo",-1),Sn=e("option",{value:"tarjeta"},"Tarjeta",-1),$n=e("option",{value:"transferencia"},"Transferencia",-1),Pn=e("option",{value:"mixto"},"Mixto",-1),En=[jn,Sn,$n,Pn],Dn={key:0,class:"mb-4 p-4 bg-green-50 rounded-lg border border-green-100"},Nn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Dinero Recibido",-1),Fn={class:"relative"},qn=e("span",{class:"absolute left-3 top-2 text-gray-500"},"$",-1),Bn={key:0,class:"mt-3 flex justify-between items-center text-lg"},On=e("span",{class:"font-medium text-gray-700"},"Cambio a devolver:",-1),Vn={class:"font-bold text-green-700"},Ln={class:"mb-4"},Rn=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Notas (Opcional)",-1),An={key:1,class:"mb-4 p-3 bg-green-50 border border-green-200 rounded"},zn=e("h4",{class:"text-sm font-semibold text-green-800 mb-2"},"Descuentos por Producto:",-1),In={class:"space-y-1"},Xn={class:"text-green-700"},Hn={class:"text-green-700 font-medium"},Kn={class:"mb-4 p-3 bg-gray-50 rounded"},Un={class:"flex justify-between mb-2"},Gn=e("span",null,"Subtotal:",-1),Wn={key:0,class:"flex justify-between mb-2 text-red-600"},Qn={class:"flex justify-between font-bold text-lg pt-2 border-t"},Jn=e("span",null,"Total:",-1),Yn={class:"flex gap-3"},Zn={class:"p-6"},ea=e("h2",{class:"text-lg font-semibold mb-4 text-green-600"},"¡Venta registrada exitosamente!",-1),ta={key:0,class:"mb-4"},sa={class:"text-sm text-gray-600 mb-2"},oa={class:"font-semibold"},na={class:"text-sm text-gray-600 mb-2"},aa={class:"font-semibold"},la={class:"flex gap-2 sm:gap-3 justify-center sm:justify-end"},ra=e("span",{class:"sm:hidden"},"✕",-1),ia=e("span",{class:"hidden sm:inline"},"Cerrar",-1),ca=["disabled"],da={key:0,class:"animate-pulse"},ua={key:1},ha=e("span",{class:"hidden sm:inline ml-1"},"Descargar PDF",-1),pa=["disabled"],va={key:0,class:"animate-pulse"},_a={key:1},ma=e("span",{class:"hidden sm:inline ml-1"},"Compartir",-1),fa=e("span",{class:"hidden sm:inline ml-1"},"Imprimir",-1),ga={id:"invoice-content-pos",class:"fixed top-0 left-0 w-[80mm] bg-white z-[-100] opacity-0 pointer-events-none"},xa={class:"bg-white text-black p-2 font-mono text-[11px] leading-tight",style:{width:"80mm",margin:"0 auto","font-family":"'Courier New', Courier, monospace"}},ba={class:"text-center mb-4"},ya=["src"],wa={class:"font-bold text-base uppercase mb-1"},ka={class:"text-[10px] space-y-0.5",style:{"font-size":"10px"}},Ca={key:0},Ma={key:1,class:"whitespace-normal"},Ta={key:2,class:"whitespace-normal"},ja={key:3,class:"whitespace-normal break-words"},Sa=e("div",{class:"border-b-2 border-dashed border-black my-2"},null,-1),$a={class:"mb-3 text-[10px] grid grid-cols-2 gap-x-2 gap-y-1"},Pa={class:"col-span-2 text-center mb-1"},Ea={class:"text-sm font-bold"},Da={class:"text-[9px] text-gray-500"},Na=e("span",{class:"font-bold block text-gray-600"},"Vendedor:",-1),Fa={class:"text-right"},qa=e("span",{class:"font-bold block text-gray-600"},"Método de Pago:",-1),Ba={class:"capitalize"},Oa={key:0,class:"col-span-2 mt-1 border-t border-dotted border-gray-300 pt-1"},Va=e("span",{class:"font-bold text-gray-600"},"Cliente:",-1),La={key:0},Ra=e("span",{class:"font-bold text-gray-600"},"NIT/CC:",-1),Aa=e("div",{class:"border-b border-black my-2"},null,-1),za={class:"mb-4"},Ia=e("div",{class:"flex justify-between text-[9px] font-bold mb-2 uppercase text-gray-800"},[e("span",null,"Descripción"),e("span",null,"Total")],-1),Xa={class:"font-bold text-[11px] leading-tight mb-0.5"},Ha={key:0,class:"text-[9px] text-gray-500 italic mb-1"},Ka={class:"flex justify-between items-start text-[10px] mt-1"},Ua={class:"flex flex-col"},Ga={class:"text-gray-800"},Wa={key:0,class:"flex flex-col mt-0.5"},Qa={style:{"text-decoration":"line-through",color:"#9ca3af"},class:"text-[9px]"},Ja={class:"text-[9px] font-bold text-gray-800"},Ya={class:"font-bold text-[11px] mt-0.5"},Za=e("div",{class:"border-t border-black my-2 dashed"},null,-1),el={class:"text-right text-[11px] space-y-1"},tl={key:0,class:"flex justify-between text-gray-600"},sl=e("span",null,"Subtotal",-1),ol={key:1,class:"flex justify-between text-gray-600"},nl=e("span",null,"Descuento",-1),al={class:"flex justify-between text-base font-black pt-1"},ll=e("span",null,"TOTAL",-1),rl={key:2,class:"flex justify-between text-[10px] mt-1 text-green-700 font-bold"},il=e("span",null,"Efectivo:",-1),cl={key:3,class:"flex justify-between text-[10px] text-green-700 font-bold"},dl=e("span",null,"Cambio:",-1),ul={class:"text-center mt-6 text-[10px] space-y-1 mb-4"},hl=e("p",{class:"font-medium"},"¡Gracias por su compra!",-1),pl={key:0,class:"mt-2 pt-2 border-t border-dotted border-gray-300 text-left"},vl=e("p",{class:"font-bold text-[9px] text-gray-500"},"Notas:",-1),_l={class:"italic"},ml={class:"p-6"},fl=e("h2",{class:"text-lg font-semibold mb-4"},"Escanear Código de Barras",-1),gl=e("p",{class:"text-sm text-gray-600 mb-4"}," Apunta la cámara hacia el código de barras. El producto se agregará automáticamente al carrito. ",-1),xl=e("div",{id:"barcode-scanner-sales",class:"w-full rounded-lg overflow-hidden",style:{"min-height":"300px"}},null,-1),bl={class:"p-6"},yl={class:"flex items-center justify-between mb-4"},wl={class:"text-lg font-semibold"},kl=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Cl=[kl],Ml={class:"space-y-4"},Tl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cantidad",-1),jl=["value"],Sl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Valor",-1),$l=["value"],Pl=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),El=e("option",{value:"percentage"},"Porcentaje",-1),Dl=e("option",{value:"amount"},"Monto",-1),Nl=[El,Dl],Fl={class:"block text-sm font-medium text-gray-700 mb-2"},ql=["step","max","placeholder"],Bl={key:0,class:"p-4 bg-gray-50 rounded-lg space-y-2"},Ol={class:"flex justify-between text-sm"},Vl=e("span",{class:"text-gray-700"},"Subtotal:",-1),Ll={class:"font-semibold"},Rl={class:"flex justify-between text-sm"},Al=e("span",{class:"text-gray-700"},"Descuento:",-1),zl={class:"font-semibold"},Il={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},Xl=e("span",null,"Total:",-1),Hl={class:"flex gap-3 mt-6"},Kl={class:"p-6 max-h-[90vh] flex flex-col"},Ul={class:"flex items-center justify-between mb-4 flex-shrink-0"},Gl=e("h2",{class:"text-lg font-semibold"},"Catálogo de Productos",-1),Wl=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Ql=[Wl],Jl={class:"mb-4 relative flex-shrink-0"},Yl=e("svg",{class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),Zl={class:"mb-4 flex items-center gap-2 overflow-x-auto pb-2 flex-shrink-0"},er=["onClick"],tr={class:"flex-1 overflow-y-auto"},sr={key:0,class:"text-center py-12 text-gray-500"},or=e("p",null,"No se encontraron productos",-1),nr=[or],ar={key:1,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3"},lr=["onClick"],rr={class:"aspect-square bg-gray-100 flex items-center justify-center",style:{"min-height":"120px"}},ir=["src","alt"],cr={key:1,class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dr=e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1),ur=[dr],hr={class:"p-2 flex-1 flex flex-col"},pr={class:"mb-1"},vr={class:"text-xs line-through text-red-600"},_r={class:"text-sm font-bold text-green-600"},mr={key:1,class:"text-sm font-bold text-gray-900"},fr={class:"font-medium text-xs text-gray-900 line-clamp-2"},gr={class:"p-6"},xr={class:"flex items-center justify-between mb-4"},br=e("h2",{class:"text-lg font-semibold"},"Descuento general de la factura",-1),yr=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),wr=[yr],kr={class:"space-y-4"},Cr=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tipo",-1),Mr=e("option",{value:"percentage"},"Porcentaje",-1),Tr=e("option",{value:"amount"},"Monto",-1),jr=[Mr,Tr],Sr={class:"block text-sm font-medium text-gray-700 mb-2"},$r=["step","max","placeholder"],Pr={class:"p-4 bg-gray-50 rounded-lg space-y-2"},Er={class:"flex justify-between text-sm"},Dr=e("span",{class:"text-gray-700"},"Subtotal:",-1),Nr={class:"font-semibold"},Fr={class:"flex justify-between text-sm"},qr=e("span",{class:"text-gray-700"},"Descuento:",-1),Br={class:"font-semibold"},Or={class:"flex justify-between text-base font-bold pt-2 border-t border-gray-300"},Vr=e("span",null,"Total:",-1),Lr={class:"flex gap-3 mt-6"},Rr={class:"p-6"},Ar={class:"flex items-center justify-between mb-4"},zr=e("h2",{class:"text-lg font-semibold text-red-600"},"⚠️ Stock Insuficiente",-1),Ir=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Xr=[Ir],Hr={class:"mb-4"},Kr=["innerHTML"],Ur={class:"flex justify-end"},ni={__name:"Index",props:{sales:Object,stats:Object,filters:Object,products:Array,categories:Array,store:Object},setup(_){const R=_,xe=je(),We=H(()=>(xe.props.auth?.roles||[]).includes("physical-sales")),De=()=>{We.value?de.post(route("logout"),{},{onSuccess:()=>{window.location.href=route("login")},onError:()=>{window.location.href=route("login")}}):de.visit(route("dashboard"))},be=u("sales");_t({start_date:R.filters?.start_date||"",end_date:R.filters?.end_date||"",search:R.filters?.search||""});const Ne=u("");u(!1);const p=u(null),ae=u(!1),A=u(!1),Qe=async()=>{if(p.value){A.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await Ct(o,`factura-${p.value.sale_number}.pdf`)}catch(o){console.error(o),alert("Error al generar el PDF")}finally{A.value=!1}}},Je=async()=>{if(p.value){A.value=!0;try{const o=document.getElementById("invoice-content-pos");o&&await Mt(o,`factura-${p.value.sale_number}.pdf`,`Factura #${p.value.sale_number}`)}catch(o){console.error(o)}finally{A.value=!1}}},pe=u(!1),Fe=u(null),Ye=o=>{Fe.value=o,pe.value=!0},Ze=(o,s)=>{ge(o,s)},ee=o=>{o.variant_options&&o.variant_options.length>0?Ye(o):ge(o)},d=o=>!o&&o!==0?"$0":new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0,maximumFractionDigits:0}).format(o),et=o=>new Date(o).toLocaleString("es-CO",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),tt=o=>{o&&de.visit(route("admin.physical-sales.show",o.id)+"?print=true")};H(()=>{if(!R.sales||!R.sales.data)return[];const o=new Date;o.setHours(0,0,0,0);const s=new Date(o);s.setHours(23,59,59,999);let t=R.sales.data.filter(n=>{const i=new Date(n.created_at);return i>=o&&i<=s});if(Ne.value.trim()){const n=Ne.value.toLowerCase();t=t.filter(i=>i.sale_number.toLowerCase().includes(n))}return t});const c=u([]),x=u(""),ye=u(null),O=u([]),qe=u(!1),K=()=>{window.innerWidth>=1024&&Ge(()=>{ye.value&&ye.value.focus()})},le=u(!1),Be=u(""),z=u(!1),te=u("efectivo"),N=u(0);Se(z,o=>{o&&(N.value=0)});const ve=u(""),F=u(0),E=u("amount"),D=u(null);u(null),u(!1),u(!1);const U=u(!1),G=u(!1),se=u(!1),v=u(null),S=u("percentage"),$=u(0),I=u(!1),_e=u(""),W=u(null),st=H(()=>{if(S.value==="percentage")return 100;if(v.value===null)return 0;const o=c.value[v.value];return o&&(o.original_price||o.unit_price)||0}),ot=H(()=>{if(te.value!=="efectivo"||!N.value)return 0;const o=parseFloat(N.value);return Math.max(0,o-oe.value)}),re=u(!1),me=u(!1),nt=()=>{me.value=!0},we=()=>{try{const o=new(window.AudioContext||window.webkitAudioContext),s=o.createOscillator(),t=o.createGain();s.connect(t),t.connect(o.destination),s.frequency.value=800,s.type="sine",t.gain.setValueAtTime(.3,o.currentTime),t.gain.exponentialRampToValueAtTime(.01,o.currentTime+.2),s.start(o.currentTime),s.stop(o.currentTime+.2)}catch{}},X=H(()=>c.value.reduce((o,s)=>o+s.quantity*s.unit_price,0)),Q=H(()=>E.value==="percentage"?X.value*F.value/100:F.value),oe=H(()=>X.value-Q.value),fe=H(()=>{if(!R.products)return[];let o=R.products;if(D.value&&(o=o.filter(s=>s.category_id===D.value)),x.value.trim()){const s=x.value.toLowerCase();o=o.filter(t=>t.name.toLowerCase().includes(s)||t.id.toString().includes(s)||t.barcode&&t.barcode.toLowerCase().includes(s))}return o}),ne=async()=>{if(!x.value.trim()){O.value=[];return}qe.value=!0;try{const s=(await window.axios.get(route("admin.physical-sales.search-products"),{params:{q:x.value}})).data?.products||[];O.value=s,s.length===1&&window.innerWidth<1024&&(ee(s[0]),x.value="",O.value=[])}catch{O.value=[]}finally{qe.value=!1}},Oe=async o=>{const s=o.replace(/\s+/g,"").trim();if(s)try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(P=>P.options&&Object.values(P.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?(ge(n,f),Be.value=""):(ee(n),Be.value="")}else alert("Producto no encontrado con ese código de barras"),K()}catch{alert("Error al buscar producto"),K()}},q=(o,s=null)=>{const t=s?.price??o.price;let n=parseFloat(t),i=0;return o.promo_active&&o.promo_discount_percent>0&&(i=parseFloat(o.promo_discount_percent),n=Math.round(n*(100-i)/100)),{originalPrice:parseFloat(t),finalPrice:n,discountPercent:i}},ge=(o,s=null)=>{const t=c.value.find(n=>n.product_id===o.id&&n.variant_id===(s?.id||null));if(t)t.quantity+=1;else{const n=q(o,s);c.value.push({product_id:o.id,product_name:o.name,variant_id:s?.id||null,variant_options:s?.options||null,quantity:1,unit_price:n.finalPrice,original_price:n.originalPrice,discount_percent:n.discountPercent,product:o,variant:s})}x.value="",O.value=[],K()},V=o=>{if(o.product){const s=o.product.track_inventory;if(!s||s==="0"||s===0||s===!1)return"Ilimitado"}return o.variant&&o.variant.stock!==null&&o.variant.stock!==void 0?o.variant.stock:o.product&&o.product.quantity!==null&&o.product.quantity!==void 0?o.product.quantity:"N/A"},ke=o=>{const s=V(o);return s==="Ilimitado"||s==="N/A"?!0:s>=o.quantity},at=o=>{if(!ke(o))return"bg-red-50";const s=V(o);return s===0||typeof s=="number"&&s<o.quantity?"bg-yellow-50":""},Ve=o=>{const s=V(o);return s===0||typeof s=="number"&&s<o.quantity?"text-red-600 font-semibold text-xs":typeof s=="number"&&s<5?"text-yellow-600 font-medium text-xs":"text-gray-600 text-xs"},lt=()=>{c.value=[],F.value=0,E.value="amount",K()},Le=o=>{c.value.splice(o,1),K()},Re=(o,s)=>{const t=c.value[o],n=t.quantity+s;if(n>0){const i=V(t);if(typeof i=="number"&&n>i){_e.value=`No hay suficiente stock para el producto "${t.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${n}`,I.value=!0;return}t.quantity=n}},rt=(o,s)=>{const t=parseInt(s.target.value);if(t>0){const n=c.value[o],i=V(n);if(typeof i=="number"&&t>i){_e.value=`No hay suficiente stock para el producto "${n.product_name}".<br><br>Stock disponible: ${i}<br>Cantidad solicitada: ${t}`,I.value=!0,s.target.value=n.quantity;return}c.value[o].quantity=t}},Ce=o=>o==null||o===""?"":new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0,useGrouping:!0}).format(o),it=o=>{if(typeof o=="number")return o;if(!o)return 0;const s=o.toString().replace(/\./g,"").replace(/[^0-9]/g,"");return parseFloat(s)||0},ct=(o,s)=>{let t=s.target.value;const n=it(t),i=c.value[o];i.discount_percent>0?(i.unit_price=n,i.original_price=n/(1-i.discount_percent/100)):(i.unit_price=n,i.original_price=n),t!==""&&(s.target.value=Ce(n))},dt=(o,s)=>{let t=parseFloat(s.target.value)||0;t=Math.round(t*100)/100;const n=Math.min(100,Math.max(0,t)),i=c.value[o];i.original_price||(i.original_price=i.unit_price),i.discount_type="percentage",i.discount_value=n,i.discount_percent=n,i.unit_price=i.original_price*(1-n/100),t!==n&&(s.target.value=n)},Me=o=>{v.value=o;const s=c.value[o];s.discount_type?(S.value=s.discount_type,$.value=s.discount_value||0):s.discount_percent>0?(S.value="percentage",$.value=s.discount_percent):(S.value="percentage",$.value=0),U.value=!0},ut=()=>{if(v.value===null)return;const o=c.value[v.value];o.original_price||(o.original_price=o.unit_price);const s=o.original_price;if(S.value==="percentage"){const t=Math.min(100,Math.max(0,$.value)),n=Math.round(t*100)/100;o.discount_type="percentage",o.discount_value=n,o.discount_percent=n,o.unit_price=s*(1-n/100)}else{const t=Math.min(s,Math.max(0,$.value));o.discount_type="amount",o.discount_value=t,o.discount_percent=t/s*100,o.unit_price=s-t}U.value=!1,v.value=null,$.value=0},Ae=()=>{G.value=!0},ht=()=>{G.value=!1},ze=async()=>{try{le.value=!0,await Ge();const{Html5Qrcode:o}=await wt(async()=>{const{Html5Qrcode:n}=await import("./index-BiOBv8GB.js");return{Html5Qrcode:n}},__vite__mapDeps([0,1,2])),s=document.getElementById("barcode-scanner-sales");if(!s)return;W.value=new o(s.id);const t={fps:10,qrbox:{width:250,height:250}};try{await W.value.start({facingMode:"environment"},t,async n=>{we(),await Oe(n),ie()},n=>{})}catch{try{await W.value.start({facingMode:"user"},t,async i=>{we(),await Oe(i),ie()},i=>{})}catch{alert("No se pudo acceder a la cámara. Por favor, permite el acceso a la cámara en la configuración del navegador."),le.value=!1}}}catch{alert("Error al inicializar el escáner. Por favor, intenta nuevamente."),le.value=!1}},ie=async()=>{if(W.value){try{await W.value.stop(),await W.value.clear()}catch{}W.value=null}le.value=!1},ce=()=>{const o=document.head.querySelector('meta[name="csrf-token"]');if(o&&o.content)return window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=o.content,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=o.content),o.content;const t=(n=>{const f=`; ${document.cookie}`.split(`; ${n}=`);return f.length===2?f.pop().split(";").shift():null})("XSRF-TOKEN");if(t&&window.axios){const n=decodeURIComponent(t);return window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,n}return null};mt(()=>{K(),setTimeout(()=>{ce(),window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{ce()},300)},100)}),de.on("finish",()=>{setTimeout(()=>{const s=je().props.csrf_token;if(s){const t=document.head.querySelector('meta[name="csrf-token"]');t&&t.setAttribute("content",s),window.axios&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=s,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=s)}ce(),window.updateCsrfToken&&window.updateCsrfToken()},200)});const pt=async()=>{if(c.value.length===0){alert("El carrito está vacío");return}const o=[];for(let t=0;t<c.value.length;t++){const n=c.value[t];if(!ke(n)){const i=V(n);o.push({name:n.product_name,requested:n.quantity,available:i})}}if(o.length>0){let t=`No se puede procesar la venta. Los siguientes productos no tienen stock suficiente:

`;o.forEach(n=>{t+=`• ${n.name}: Solicitado ${n.requested}, Disponible ${n.available}
`}),_e.value=t.replace(/\n/g,"<br>"),I.value=!0;return}const s={items:c.value.map(t=>({product_id:t.product_id,variant_id:t.variant_id,quantity:t.quantity,unit_price:t.unit_price,original_price:t.original_price,discount_percent:t.discount_percent})),subtotal:X.value,tax:0,discount:Q.value,total:oe.value,payment_method:te.value,notes:ve.value};try{if(!window.axios){alert("Error: No se pudo inicializar la conexión. Por favor, recarga la página.");return}let n=je().props.csrf_token;if(n){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",n)}else n=ce();if(n||(await new Promise(m=>setTimeout(m,200)),n=ce()),!n){alert("Error: No se pudo obtener el token de seguridad. Por favor, recarga la página.");return}window.axios.defaults.headers.common["X-CSRF-TOKEN"]=n,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=n;const i=()=>{const m=document.head.querySelector('meta[name="csrf-token"]');if(m&&m.content)return m.content;const w=(M=>{const Ue=`; ${document.cookie}`.split(`; ${M}=`);return Ue.length===2?Ue.pop().split(";").shift():null})("XSRF-TOKEN");return w?decodeURIComponent(w):null},f=async(m=0)=>{try{let C=i();if(!C&&m===0)try{const M=await window.axios.get(route("dashboard"),{headers:{"X-Requested-With":"XMLHttpRequest"}});await new Promise(T=>setTimeout(T,100)),C=i()}catch{}if(!C)throw new Error("No se pudo obtener el token CSRF. Por favor, recarga la página.");window.axios.defaults.headers.common["X-CSRF-TOKEN"]=C,window.axios.defaults.headers.common["X-XSRF-TOKEN"]=C;const w=await window.axios.post(route("admin.physical-sales.store"),s,{headers:{"X-CSRF-TOKEN":C,"X-XSRF-TOKEN":C,"X-Requested-With":"XMLHttpRequest"}});if(w&&w.headers){const M=w.headers["x-csrf-token"]||w.headers["X-CSRF-TOKEN"];if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}}return w}catch(C){if(C.response){if(C.response.status===419&&m===0){const w=C.response.headers||{},M=w["x-csrf-token"]||w["X-CSRF-TOKEN"]||null;if(M){const T=document.head.querySelector('meta[name="csrf-token"]');T&&T.setAttribute("content",M),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=M}else{const T=i();T&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=T)}return await new Promise(T=>setTimeout(T,200)),await f(1)}}else if(m===0){const w=i();return w&&(window.axios.defaults.headers.common["X-CSRF-TOKEN"]=w),await new Promise(M=>setTimeout(M,200)),await f(1)}throw C}},k=await f(),P=k.headers?.["x-csrf-token"]||k.headers?.["X-CSRF-TOKEN"];if(P){const m=document.head.querySelector('meta[name="csrf-token"]');m&&m.setAttribute("content",P),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=P}k.data&&k.data.success?(p.value=k.data.sale,z.value=!1,c.value=[],x.value="",F.value=0,E.value="amount",ve.value="",te.value="efectivo",D.value=null,window.updateCsrfToken&&window.updateCsrfToken(),ae.value=!0,de.reload()):alert("Error: "+(k.data?.message||"No se pudo procesar la venta"))}catch(t){console.error("Error completo al procesar la venta:",{error:t,message:t.message,response:t.response,status:t.response?.status,data:t.response?.data,headers:t.response?.headers});let n="Error al procesar la venta";if(t.response){const i=t.response.status,f=t.response.data;i===419?(n="Tu sesión ha expirado. Por favor, recarga la página e intenta nuevamente.",window.updateCsrfToken&&window.updateCsrfToken(),setTimeout(()=>{window.location.reload()},2e3)):i===422?f?.message?n=f.message:f?.errors?n=`Error de validación:
${Object.entries(f.errors).map(([P,m])=>Array.isArray(m)?`${P}: ${m.join(", ")}`:`${P}: ${m}`).join(`
`)}`:n="Error de validación. Verifica los datos e intenta nuevamente.":f?.message?n=f.message:n=`Error del servidor (${i}). Por favor, intenta nuevamente.`}else t.request?n="No se pudo conectar con el servidor. Verifica tu conexión a internet.":t.message&&(n=t.message);alert(n)}};ft(()=>{ie()});let Ie;Se(x,async o=>{clearTimeout(Ie);const s=o.replace(/\s+/g,"").trim();if(s.length>=8&&/^\d+$/.test(s))try{const t=await window.axios.get(route("admin.physical-sales.get-product-by-barcode"),{params:{barcode:s}});if(t.data?.product){const n=t.data.product,i=t.data.matched_variant_option;let f=null;if(i&&n.variants&&n.variants.length>0){const k=n.variants.filter(P=>P.options&&Object.values(P.options).some(m=>m===i.name));k.length===1&&(f=k[0])}f?ge(n,f):ee(n),x.value="",we();return}}catch{}Ie=setTimeout(()=>{x.value.trim().length>=2?ne():O.value=[]},300)}),Se([pe,se,U,G,z,ae,re,I],(o,s)=>{o.some((n,i)=>!n&&s[i])&&setTimeout(()=>{K()},150)});const Xe=u(50),Te=u(!1),vt=()=>{Te.value=!0,document.addEventListener("mousemove",He),document.addEventListener("mouseup",Ke),document.body.style.userSelect="none",document.body.style.cursor="col-resize"},He=o=>{if(!Te.value)return;const s=window.innerWidth,t=o.clientX/s*100;t>20&&t<80&&(Xe.value=t)},Ke=()=>{Te.value=!1,document.removeEventListener("mousemove",He),document.removeEventListener("mouseup",Ke),document.body.style.userSelect="",document.body.style.cursor=""};return(o,s)=>(a(),l(j,null,[g($e(gt),{title:"Ventas Físicas"}),g(kt,null,{header:y(()=>[be.value!=="sales"?(a(),l("h2",$t,"Ventas Físicas")):h("",!0)]),default:y(()=>[be.value==="sales"?(a(),l("div",Pt,[e("div",{style:xt({width:Xe.value+"%"}),class:"h-full flex flex-col border-r border-gray-300"},[e("div",Et,[e("div",Dt,[e("button",{onClick:De,class:"px-3 py-2 bg-white text-gray-700 rounded-lg hover:bg-gray-100 text-sm font-medium flex items-center gap-2 border border-gray-200"},[Nt,b(" Salir ")]),e("button",{onClick:s[0]||(s[0]=t=>re.value=!0),class:"px-3 py-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 text-sm font-medium flex items-center gap-2 border border-red-200",title:"Registrar Gasto / Salida"},[Ft,b(" Gasto ")]),e("div",qt,[B(e("input",{ref_key:"searchInput",ref:ye,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:Pe(ne,["enter"])},null,544),[[J,x.value]]),Bt,e("button",{onClick:ze,class:"absolute right-2 top-1.5 p-1 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},Vt)])]),e("div",Lt,[e("button",{onClick:s[2]||(s[2]=t=>{D.value=null,x.value=""}),class:Y(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(j,null,L(_.categories,t=>(a(),l("button",{key:t.id,onClick:n=>{D.value=t.id,x.value=""},class:Y(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,Rt))),128))])]),e("div",At,[fe.value.length===0?(a(),l("div",zt,Xt)):(a(),l("div",Ht,[(a(!0),l(j,null,L(fe.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>ee(t)},[e("div",Ut,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,Gt)):(a(),l("svg",Wt,Jt))]),e("div",Yt,[e("div",Zt,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",es,r(d(q(t).originalPrice)),1),e("p",ts,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",ss,r(d(q(t).finalPrice)),1))]),e("h3",{class:"font-medium text-xs text-gray-900 line-clamp-2",title:t.name},r(t.name),9,os)])],8,Kt))),128))]))])],4),e("div",{class:"w-1 hover:w-2 bg-gray-200 hover:bg-blue-400 cursor-col-resize flex items-center justify-center transition-all z-20 group",onMousedown:vt,title:"Arrastra para ajustar el tamaño"},as,32),e("div",ls,[e("div",rs,[e("div",is,[cs,e("span",ds,r($e(xe).props.auth?.user?.name||"Usuario"),1),us,_.store&&_.store.logo_url?(a(),l("img",{key:0,src:_.store.logo_url,alt:`Logo de ${_.store.name}`,class:"h-6 w-6 rounded-full object-cover"},null,8,hs)):h("",!0),_.store?(a(),l("span",ps,r(_.store.name),1)):h("",!0)])]),e("div",vs,[c.value.length===0?(a(),l("div",_s,gs)):(a(),l("div",xs,[e("table",bs,[ys,e("tbody",ws,[(a(!0),l(j,null,L(c.value,(t,n)=>(a(),l("tr",{key:n,class:Y(["hover:bg-gray-50",at(t)])},[e("td",{class:"px-3 py-3 text-left align-middle",title:t.product_name},[e("div",Cs,[e("div",Ms,[b(r(t.product_name)+" ",1),t.variant_options?(a(),l("span",Ts," ("+r(Object.values(t.variant_options).join(" / "))+") ",1)):h("",!0)])])],8,ks),e("td",{class:"px-3 py-3 text-center align-middle w-16",title:`Stock disponible: ${V(t)}`},[e("span",{class:Y(Ve(t))},r(V(t)),3)],8,js),e("td",{class:"px-3 py-3 text-center align-middle w-20",title:`Cantidad: ${t.quantity}`},[e("input",{type:"number",value:t.quantity,onChange:i=>rt(n,i),class:"w-full text-center border border-gray-300 rounded text-sm py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"1"},null,40,$s)],8,Ss),e("td",{class:"px-3 py-3 text-right align-middle w-40",title:`Precio unitario: ${d(t.unit_price)}`},[e("input",{type:"text",value:Ce(t.original_price||t.unit_price),onInput:i=>ct(n,i),class:"w-full text-right border border-gray-300 rounded text-sm py-2 px-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"},null,40,Es)],8,Ps),e("td",{class:"px-3 py-3 text-right align-middle w-32",title:t.discount_type==="amount"?`Descuento: $${t.discount_value}`:`Descuento: ${t.discount_percent}%`},[t.discount_type==="amount"?(a(),l("button",{key:0,onClick:i=>Me(n),class:"w-full text-right border border-blue-200 bg-blue-50 text-blue-700 font-semibold rounded text-sm py-2 px-2 hover:bg-blue-100 transition-colors"}," $ "+r(Ce(t.discount_value)),9,Ns)):(a(),l("div",Fs,[e("input",{type:"number",value:t.discount_percent,onChange:i=>dt(n,i),onClick:bt(i=>Me(n),["self"]),class:"w-full text-right border border-gray-300 rounded text-sm py-2 pl-2 pr-6 cursor-pointer focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",max:"100",step:"0.01"},null,40,qs),Bs]))],8,Ds),e("td",{class:"px-3 py-3 text-right align-middle w-36",title:`Subtotal: ${d(t.quantity*t.unit_price)}`},[e("span",Vs,r(d(t.quantity*t.unit_price)),1)],8,Os),e("td",Ls,[e("button",{onClick:i=>Le(n),class:"flex items-center justify-center w-8 h-8 bg-red-500 text-white rounded hover:bg-red-600 transition-colors mx-auto",title:"Eliminar producto"},zs,8,Rs)])],2))),128))])])]))]),c.value.length>0?(a(),l("div",Is,[e("div",Xs,[Hs,e("span",Ks,r(d(X.value)),1)]),e("div",Us,[Gs,e("span",{onClick:Ae,class:"font-medium cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(F.value>0?"-"+d(Q.value):d(0))+" ",1),Ws])]),e("div",Qs,[e("div",Js,[Ys,e("span",Zs,r(d(oe.value)),1)]),e("div",eo,[e("button",{onClick:s[3]||(s[3]=t=>z.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base"}," Procesar Venta "),e("button",{onClick:lt,class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base border border-red-300"}," Cancelar ")])])])):h("",!0)])])):h("",!0),be.value==="sales"?(a(),l("div",to,[e("div",so,[e("div",oo,[e("div",no,[ao,e("span",lo,r($e(xe).props.auth?.user?.name||"Usuario"),1),ro,_.store&&_.store.logo_url?(a(),l("img",{key:0,src:_.store.logo_url,alt:`Logo de ${_.store.name}`,class:"h-5 w-5 rounded-full object-cover"},null,8,io)):h("",!0),_.store?(a(),l("span",co,r(_.store.name),1)):h("",!0)]),e("button",{onClick:De,class:"px-3 py-1.5 bg-teal-500 text-white rounded text-sm font-medium"}," « Regresar ")])]),e("div",uo,[e("div",ho,[e("button",{onClick:s[4]||(s[4]=t=>se.value=!0),class:"px-3 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center flex-shrink-0",title:"Ver catálogo de productos"},vo),e("button",{onClick:s[5]||(s[5]=t=>re.value=!0),class:"px-3 py-2.5 bg-red-50 text-red-600 rounded-lg hover:bg-red-100 flex items-center justify-center flex-shrink-0 border border-red-200",title:"Registrar Gasto"},mo),e("div",fo,[B(e("input",{"onUpdate:modelValue":s[6]||(s[6]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-12 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm bg-white",onKeyup:Pe(ne,["enter"]),onInput:ne},null,544),[[J,x.value]]),go,e("button",{onClick:ze,class:"absolute right-2 top-2 p-1.5 text-blue-600 hover:text-blue-700",title:"Escanear código de barras"},bo)])]),O.value.length>0&&x.value.trim()?(a(),l("div",yo,[(a(!0),l(j,null,L(O.value,t=>(a(),l("div",{key:t.id,onClick:n=>{ee(t),x.value="",O.value=[]},class:"px-4 py-3 border-b border-gray-100 hover:bg-blue-50 cursor-pointer flex items-center gap-3"},[e("div",ko,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover rounded"},null,8,Co)):(a(),l("svg",Mo,jo))]),e("div",So,[e("p",$o,r(t.name),1),e("div",null,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",Po,r(d(q(t).originalPrice)),1),e("p",Eo,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",Do,r(d(q(t).finalPrice)),1))])]),No],8,wo))),128))])):h("",!0)]),Fo,e("div",qo,[c.value.length===0?(a(),l("div",Bo,Ro)):(a(),l("div",Ao,[(a(!0),l(j,null,L(c.value,(t,n)=>(a(),l("div",{key:n,class:"px-4 py-3 bg-white"},[e("div",zo,[e("div",Io,[e("div",Xo,[e("span",{class:Y(Ve(t))}," Stock: "+r(V(t)),3),ke(t)?h("",!0):(a(),l("span",Ho," ⚠ Sin stock "))]),e("p",Ko,r(t.product_name),1),e("p",Uo,r(d(t.unit_price)),1)]),e("div",Go,[e("div",Wo,[Qo,e("div",Jo,[e("button",{onClick:i=>Re(n,-1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," - ",8,Yo),e("span",Zo,r(t.quantity),1),e("button",{onClick:i=>Re(n,1),class:"w-8 h-8 flex items-center justify-center bg-blue-600 text-white rounded-full hover:bg-blue-700 font-medium text-sm"}," + ",8,en)])]),e("div",tn,[sn,e("span",on,r(d(t.quantity*t.unit_price)),1)]),e("button",{onClick:i=>Me(n),class:"w-8 h-8 flex items-center justify-center bg-gray-200 text-gray-600 rounded hover:bg-gray-300",title:"Aplicar descuento"},ln,8,nn),e("button",{onClick:i=>Le(n),class:"w-8 h-8 flex items-center justify-center bg-red-500 text-white rounded hover:bg-red-600"},dn,8,rn)])])]))),128))]))]),c.value.length>0?(a(),l("div",un,[e("div",hn,[e("div",pn,[vn,e("span",_n,r(d(X.value)),1)]),e("div",mn,[fn,e("span",{onClick:Ae,class:"font-medium text-green-600 cursor-pointer hover:text-blue-600 flex items-center gap-1"},[b(r(F.value>0?"-"+d(Q.value):d(0))+" ",1),gn])]),e("div",xn,[bn,e("span",yn,r(d(oe.value)),1)])]),e("div",wn,[e("button",{onClick:s[7]||(s[7]=t=>z.value=!0),class:"flex-1 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-base transition-colors"}," PROCESAR VENTA "),e("button",{onClick:s[8]||(s[8]=t=>{c.value=[],F.value=0,E.value="amount"}),class:"flex-1 py-3 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 font-semibold text-base transition-colors border border-red-300"}," CANCELAR ")])])):h("",!0)])):h("",!0),g(Z,{show:z.value,onClose:s[13]||(s[13]=t=>z.value=!1)},{default:y(()=>[e("div",kn,[Cn,e("div",Mn,[Tn,B(e("select",{"onUpdate:modelValue":s[9]||(s[9]=t=>te.value=t),class:"w-full rounded-md border-gray-300"},En,512),[[Ee,te.value]])]),te.value==="efectivo"?(a(),l("div",Dn,[Nn,e("div",Fn,[qn,B(e("input",{"onUpdate:modelValue":s[10]||(s[10]=t=>N.value=t),type:"number",step:"0.01",class:"w-full pl-7 rounded-md border-gray-300 focus:ring-green-500 focus:border-green-500",placeholder:"0.00"},null,512),[[J,N.value]])]),N.value?(a(),l("div",Bn,[On,e("span",Vn,r(d(ot.value)),1)])):h("",!0)])):h("",!0),e("div",Ln,[Rn,B(e("textarea",{"onUpdate:modelValue":s[11]||(s[11]=t=>ve.value=t),class:"w-full rounded-md border-gray-300",rows:"3",placeholder:"Notas adicionales sobre la venta..."},null,512),[[J,ve.value]])]),c.value.some(t=>t.discount_percent>0)?(a(),l("div",An,[zn,e("div",In,[(a(!0),l(j,null,L(c.value.filter(t=>t.discount_percent>0),(t,n)=>(a(),l("div",{key:n,class:"flex justify-between text-sm"},[e("span",Xn,r(t.product_name)+":",1),e("span",Hn,"-"+r(t.discount_percent)+"% ("+r(d((t.original_price-t.unit_price)*t.quantity))+")",1)]))),128))])])):h("",!0),e("div",Kn,[e("div",Un,[Gn,e("span",null,r(d(X.value)),1)]),Q.value>0?(a(),l("div",Wn,[e("span",null,"Descuento ("+r(E.value==="percentage"?F.value+"%":"Monto")+"):",1),e("span",null,"-"+r(d(Q.value)),1)])):h("",!0),e("div",Qn,[Jn,e("span",null,r(d(oe.value)),1)])]),e("div",Yn,[g(ue,{onClick:s[12]||(s[12]=t=>z.value=!1)},{default:y(()=>[b("Cancelar")]),_:1}),g(he,{onClick:pt},{default:y(()=>[b("Confirmar Venta")]),_:1})])])]),_:1},8,["show"]),g(Z,{show:ae.value,onClose:s[16]||(s[16]=t=>ae.value=!1)},{default:y(()=>[e("div",Zn,[ea,p.value?(a(),l("div",ta,[e("p",sa,[b(" Número de venta: "),e("span",oa,"#"+r(p.value.sale_number),1)]),e("p",na,[b(" Total: "),e("span",aa,r(d(p.value.total)),1)])])):h("",!0),e("div",la,[g(ue,{onClick:s[14]||(s[14]=t=>ae.value=!1),class:"!px-3 sm:!px-4"},{default:y(()=>[ra,ia]),_:1}),p.value?(a(),l("button",{key:0,onClick:Qe,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring ring-gray-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:A.value,title:"Descargar PDF"},[A.value?(a(),l("span",da,"⏳")):(a(),l("span",ua,[b("⬇️ "),ha]))],8,ca)):h("",!0),p.value?(a(),l("button",{key:1,onClick:Je,class:"inline-flex items-center px-3 sm:px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring ring-indigo-300 disabled:opacity-25 transition ease-in-out duration-150",disabled:A.value,title:"Compartir Factura"},[A.value?(a(),l("span",va,"⏳")):(a(),l("span",_a,[b("🔗 "),ma]))],8,pa)):h("",!0),p.value?(a(),yt(he,{key:2,onClick:s[15]||(s[15]=t=>tt(p.value)),class:"!px-3 sm:!px-4",title:"Imprimir Factura"},{default:y(()=>[b(" 🖨️ "),fa]),_:1})):h("",!0)]),e("div",ga,[e("div",xa,[e("div",ba,[_.store?.logo_url?(a(),l("img",{key:0,src:_.store.logo_url,alt:"Logo",class:"h-12 w-auto object-contain mx-auto mb-2 grayscale",crossorigin:"anonymous"},null,8,ya)):h("",!0),e("h2",wa,r(_.store?.name),1),e("div",ka,[_.store?.nit?(a(),l("p",Ca,"NIT: "+r(_.store.nit),1)):h("",!0),_.store?.phone?(a(),l("p",Ma,"Tel: "+r(_.store.phone),1)):h("",!0),_.store?.address?(a(),l("p",Ta,r(_.store.address),1)):h("",!0),_.store?.email?(a(),l("p",ja,r(_.store.email),1)):h("",!0)])]),Sa,e("div",$a,[e("div",Pa,[e("p",Ea,"Venta #"+r(p.value?.sale_number),1),e("p",Da,r(p.value?et(p.value.created_at):""),1)]),e("div",null,[Na,e("span",null,r(p.value?.user?.name||o.$page.props.auth.user.name),1)]),e("div",Fa,[qa,e("span",Ba,r(p.value?.payment_method),1)]),p.value?.customer_name?(a(),l("div",Oa,[e("p",null,[Va,b(" "+r(p.value.customer_name),1)]),p.value.customer_nit?(a(),l("p",La,[Ra,b(" "+r(p.value.customer_nit),1)])):h("",!0)])):h("",!0)]),Aa,e("div",za,[Ia,(a(!0),l(j,null,L(p.value?.items,t=>(a(),l("div",{key:t.id,class:"mb-3 border-b border-gray-200 last:border-0 pb-2"},[e("div",Xa,r(t.product_name),1),t.variant_options?(a(),l("div",Ha,r(Object.values(t.variant_options).join(" / ")),1)):h("",!0),e("div",Ka,[e("div",Ua,[e("span",Ga,r(t.quantity)+" x "+r(d(t.unit_price)),1),t.discount_percent>0||t.original_price&&t.original_price>t.unit_price?(a(),l("div",Wa,[e("span",Qa," Precio Normal: "+r(d(t.original_price||t.unit_price*100/(100-t.discount_percent))),1),e("span",Ja," Desc: "+r(t.discount_percent||Math.round((1-t.unit_price/t.original_price)*100))+"% ",1)])):h("",!0)]),e("div",Ya,r(d(t.subtotal)),1)])]))),128))]),Za,e("div",el,[p.value?.discount>0?(a(),l("div",tl,[sl,e("span",null,r(d(p.value.subtotal)),1)])):h("",!0),p.value?.discount>0?(a(),l("div",ol,[nl,e("span",null,"-"+r(d(p.value.discount)),1)])):h("",!0),e("div",al,[ll,e("span",null,r(d(p.value?.total)),1)]),N.value>0&&p.value?(a(),l("div",rl,[il,e("span",null,r(d(N.value)),1)])):h("",!0),N.value>p.value?.total?(a(),l("div",cl,[dl,e("span",null,r(d(N.value-p.value.total)),1)])):h("",!0)]),e("div",ul,[hl,p.value?.notes?(a(),l("div",pl,[vl,e("p",_l,r(p.value.notes),1)])):h("",!0)])])])])]),_:1},8,["show"]),g(Z,{show:le.value,onClose:ie},{default:y(()=>[e("div",ml,[fl,gl,xl,g(ue,{onClick:ie,class:"mt-4"},{default:y(()=>[b("Cerrar")]),_:1})])]),_:1},8,["show"]),g(Z,{show:U.value,onClose:s[21]||(s[21]=t=>U.value=!1)},{default:y(()=>[e("div",bl,[e("div",yl,[e("h2",wl,r(v.value!==null?c.value[v.value]?.product_name:"Descuento de Producto"),1),e("button",{onClick:s[17]||(s[17]=t=>U.value=!1),class:"text-gray-400 hover:text-gray-600"},Cl)]),e("div",Ml,[e("div",null,[Tl,e("input",{type:"number",value:v.value!==null?c.value[v.value]?.quantity:1,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,jl)]),e("div",null,[Sl,e("input",{type:"number",value:v.value!==null?c.value[v.value]?.original_price||c.value[v.value]?.unit_price:0,disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100"},null,8,$l)]),e("div",null,[Pl,B(e("select",{"onUpdate:modelValue":s[18]||(s[18]=t=>S.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},Nl,512),[[Ee,S.value]])]),e("div",null,[e("label",Fl," Descuento "+r(S.value==="percentage"?"%":""),1),B(e("input",{"onUpdate:modelValue":s[19]||(s[19]=t=>$.value=t),type:"number",step:(S.value==="percentage","0.01"),min:0,max:st.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:S.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,ql),[[J,$.value,void 0,{number:!0}]])]),v.value!==null?(a(),l("div",Bl,[e("div",Ol,[Vl,e("span",Ll,r(d((c.value[v.value]?.original_price||c.value[v.value]?.unit_price)*c.value[v.value]?.quantity)),1)]),e("div",Rl,[Al,e("span",zl,r(d(S.value==="percentage"?(c.value[v.value]?.original_price||c.value[v.value]?.unit_price)*c.value[v.value]?.quantity*$.value/100:$.value*c.value[v.value]?.quantity)),1)]),e("div",Il,[Xl,e("span",null,r(d((c.value[v.value]?.original_price||c.value[v.value]?.unit_price)*c.value[v.value]?.quantity-(S.value==="percentage"?(c.value[v.value]?.original_price||c.value[v.value]?.unit_price)*c.value[v.value]?.quantity*$.value/100:$.value*c.value[v.value]?.quantity))),1)])])):h("",!0)]),e("div",Hl,[g(ue,{onClick:s[20]||(s[20]=t=>U.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(he,{onClick:ut},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(jt,{show:re.value,onClose:s[22]||(s[22]=t=>re.value=!1),onSuccess:nt},null,8,["show"]),g(St,{show:pe.value,product:Fe.value,onClose:s[23]||(s[23]=t=>pe.value=!1),onAddToCart:Ze},null,8,["show","product"]),g(Z,{show:se.value,onClose:s[27]||(s[27]=t=>se.value=!1),"max-width":"4xl"},{default:y(()=>[e("div",Kl,[e("div",Ul,[Gl,e("button",{onClick:s[24]||(s[24]=t=>se.value=!1),class:"text-gray-400 hover:text-gray-600"},Ql)]),e("div",Jl,[B(e("input",{"onUpdate:modelValue":s[25]||(s[25]=t=>x.value=t),type:"text",placeholder:"Buscar producto...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",onKeyup:Pe(ne,["enter"]),onInput:ne},null,544),[[J,x.value]]),Yl]),e("div",Zl,[e("button",{onClick:s[26]||(s[26]=t=>D.value=null),class:Y(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===null?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])}," TODOS ",2),(a(!0),l(j,null,L(_.categories,t=>(a(),l("button",{key:t.id,onClick:n=>D.value=t.id,class:Y(["px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap border",D.value===t.id?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"])},r(t.name),11,er))),128))]),e("div",tr,[fe.value.length===0?(a(),l("div",sr,nr)):(a(),l("div",ar,[(a(!0),l(j,null,L(fe.value,t=>(a(),l("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md cursor-pointer flex flex-col",onClick:n=>{ee(t),se.value=!1}},[e("div",rr,[t.main_image_url?(a(),l("img",{key:0,src:t.main_image_url,alt:t.name,class:"w-full h-full object-cover"},null,8,ir)):(a(),l("svg",cr,ur))]),e("div",hr,[e("div",pr,[t.promo_active&&t.promo_discount_percent>0?(a(),l(j,{key:0},[e("p",vr,r(d(q(t).originalPrice)),1),e("p",_r,r(d(q(t).finalPrice)),1)],64)):(a(),l("p",mr,r(d(q(t).finalPrice)),1))]),e("h3",fr,r(t.name),1)])],8,lr))),128))]))])])]),_:1},8,["show"]),g(Z,{show:G.value,onClose:s[32]||(s[32]=t=>G.value=!1)},{default:y(()=>[e("div",gr,[e("div",xr,[br,e("button",{onClick:s[28]||(s[28]=t=>G.value=!1),class:"text-gray-400 hover:text-gray-600"},wr)]),e("div",kr,[e("div",null,[Cr,B(e("select",{"onUpdate:modelValue":s[29]||(s[29]=t=>E.value=t),class:"w-full px-3 py-2 border border-gray-300 rounded-md"},jr,512),[[Ee,E.value]])]),e("div",null,[e("label",Sr," Descuento "+r(E.value==="percentage"?"%":""),1),B(e("input",{"onUpdate:modelValue":s[30]||(s[30]=t=>F.value=t),type:"number",step:(E.value==="percentage","0.01"),min:0,max:E.value==="percentage"?100:X.value,class:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:E.value==="percentage"?"Porcentaje Descuento":"Monto Descuento"},null,8,$r),[[J,F.value,void 0,{number:!0}]])]),e("div",Pr,[e("div",Er,[Dr,e("span",Nr,r(d(X.value)),1)]),e("div",Fr,[qr,e("span",Br,r(d(Q.value)),1)]),e("div",Or,[Vr,e("span",null,r(d(oe.value)),1)])])]),e("div",Lr,[g(ue,{onClick:s[31]||(s[31]=t=>G.value=!1)},{default:y(()=>[b("Cerrar")]),_:1}),g(he,{onClick:ht},{default:y(()=>[b("Aplicar")]),_:1})])])]),_:1},8,["show"]),g(Z,{show:I.value,onClose:s[35]||(s[35]=t=>I.value=!1)},{default:y(()=>[e("div",Rr,[e("div",Ar,[zr,e("button",{onClick:s[33]||(s[33]=t=>I.value=!1),class:"text-gray-400 hover:text-gray-600"},Xr)]),e("div",Hr,[e("div",{class:"text-sm text-gray-700 whitespace-pre-line",innerHTML:_e.value},null,8,Kr)]),e("div",Ur,[g(he,{onClick:s[34]||(s[34]=t=>I.value=!1)},{default:y(()=>[b("Entendido")]),_:1})])])]),_:1},8,["show"]),g(Tt,{show:me.value,type:"success",title:"¡Gasto Guardado!",message:"El gasto se ha registrado correctamente en el sistema.","primary-text":"Entendido",onClose:s[36]||(s[36]=t=>me.value=!1),onPrimary:s[37]||(s[37]=t=>me.value=!1)},null,8,["show"])]),_:1})],64))}};export{ni as default};
