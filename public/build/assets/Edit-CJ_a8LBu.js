import{A as ke,r as g,z as Ce,o as Se,a as je,c as P,w as Ae,b as a,d as i,e as A,u as d,h as Oe,f as E,g as t,s as _,i as O,j as v,v as x,O as Ve,m as N,F as k,l as j,t as C,C as K,k as F}from"./app-DSOEodqv.js";import{_ as $e}from"./AuthenticatedLayout-CIdVDnfy.js";import{_ as Z}from"./AlertModal-PUHbo1QC.js";import{_ as De}from"./Modal-DkZHA6uo.js";import{_ as Ee}from"./SecondaryButton-DS6zJKLS.js";import{D as Me}from"./DangerButton-V7Dgwovn.js";const Pe={class:"font-semibold text-xl text-gray-800 leading-tight"},ze={class:"py-12"},Ue={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ie={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Te={class:"p-6 text-gray-900"},Be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qe={class:"mb-4"},Ne=t("label",{for:"name",class:"block font-medium text-sm text-gray-700"},"Nombre",-1),Fe={class:"mb-4"},Ge=t("label",{for:"price",class:"block font-medium text-sm text-gray-700"},"Precio (Principal)",-1),Le={class:"inline-flex items-center gap-2 mb-3 select-none"},He=t("span",{class:"font-semibold"},"Controlar inventario",-1),Re={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Qe=t("label",{for:"quantity",class:"block font-medium text-sm text-gray-700"},"Inventario (Total)",-1),We=["disabled"],Je=t("label",{for:"alert_general",class:"block font-medium text-sm text-gray-700"},"Alerta (Opcional)",-1),Xe=["disabled"],Ye=t("label",{for:"purchase_price",class:"block font-medium text-sm text-gray-700"},"Precio de compra",-1),Ke=t("div",{class:"mb-2"},[t("label",{class:"block font-medium text-sm text-gray-700"},"Categorías")],-1),Ze={class:"space-y-3"},et=["onUpdate:modelValue","onChange"],tt=t("option",{value:null},"Seleccione una categoría",-1),st=["value"],ot={class:"mb-4"},lt=t("label",{for:"short_description",class:"block font-medium text-sm text-gray-700"},"Descripción Corta",-1),nt={class:"mb-4"},rt=t("label",{for:"long_description",class:"block font-medium text-sm text-gray-700"},"Descripción Larga",-1),at={class:"mb-4"},it=t("label",{for:"specifications",class:"block font-medium text-sm text-gray-700"},"Especificaciones (separadas por comas)",-1),dt={class:"md:col-span-2 mt-6 border-t pt-6"},ct=t("h3",{class:"text-lg font-medium text-gray-900"},"Atributos de variantes",-1),ut=t("p",{class:"text-sm text-gray-600 mb-4"},'Definí atributos como "Color" y "Talla" y sus valores separados por comas. Podés regenerar combinaciones.',-1),pt={class:"mb-4 p-4 border rounded-md bg-gray-50"},mt={class:"space-y-2"},ht={class:"md:col-span-2"},ft=t("label",{class:"block text-sm font-medium text-gray-700"},"Nombre",-1),vt=["onUpdate:modelValue"],_t={class:"md:col-span-3"},gt=t("label",{class:"block text-sm font-medium text-gray-700"},"Valores (separados por coma)",-1),bt=["onUpdate:modelValue"],yt={class:"md:col-span-5 flex items-center gap-2"},xt=["onClick","title","aria-label"],wt={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},kt=t("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"},null,-1),Ct=[kt],St={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},jt=t("path",{d:"M5 12a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1z"},null,-1),At=[jt],Ot=["textContent"],Vt={key:0,class:"md:col-span-5 grid grid-cols-1 md:grid-cols-5 gap-3 items-start"},$t={class:"md:col-span-2"},Dt=t("label",{class:"block text-sm font-medium text-gray-700"},"Depende de",-1),Et=["onUpdate:modelValue"],Mt=t("option",{value:""},"(sin dependencia)",-1),Pt=["value","disabled"],zt={key:0,class:"md:col-span-3"},Ut=t("label",{class:"block text-sm font-medium text-gray-700"},"Permitir valores del hijo según el valor del padre",-1),It={class:"mt-2 space-y-3"},Tt={class:"text-xs font-semibold text-gray-700 mb-2"},Bt={class:"flex flex-wrap gap-3"},qt=["checked","onChange"],Nt=t("p",{class:"text-xs text-gray-500 mt-2"},"Si no seleccionas nada para un valor del padre, se permiten todos los valores del hijo.",-1),Ft={class:"md:col-span-5 flex items-center gap-4"},Gt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[t("path",{d:"M11 11V5a1 1 0 1 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6z"})],-1),Lt=[Gt],Ht=t("span",{class:"text-xs md:hidden"},"Añadir",-1),Rt={class:"flex items-center gap-2"},Qt=["onClick"],Wt=t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"w-4 h-4",fill:"currentColor"},[t("path",{d:"M7 7h10l-1 12a2 2 0 0 1-2 2H10a2 2 0 0 1-2-2L7 7zm9-3a1 1 0 0 1 1 1v1H7V5a1 1 0 0 1 1-1h8zM9 5V4a3 3 0 0 1 3-3 3 3 0 0 1 3 3v1H9z"})],-1),Jt=[Wt],Xt=t("span",{class:"text-xs md:hidden"},"Quitar",-1),Yt={class:"mt-6 border-t pt-6"},Kt={class:"p-4 border rounded-md bg-gray-50 col-span-2"},Zt={class:"flex items-center justify-between mb-2"},es=t("label",{class:"block font-medium text-sm text-gray-700"},"Imágenes actuales",-1),ts={class:"text-xs text-gray-500"},ss={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3"},os=["onClick"],ls=["src"],ns=["onClick"],rs={key:1,class:"text-sm text-gray-500 mt-2"},as={class:"mt-4 col-span-2"},is=t("label",{for:"new_gallery_files",class:"block font-medium text-sm text-gray-700"},"Añadir más imágenes",-1),ds=t("p",{class:"mt-1 text-xs text-gray-500"},"Formatos de imagen y hasta 2 MB por archivo.",-1),cs={class:"relative flex items-center justify-center bg-gray-50 border rounded-lg h-[60vh] min-h-[320px] mb-3 select-none"},us=["src"],ps={class:"flex items-center gap-2 overflow-x-auto py-2"},ms=["onClick"],hs=["src"],fs={class:"flex items-center justify-end mt-6 border-t pt-6"},vs=["disabled"],_s={class:"p-6"},gs=t("h2",{class:"text-lg font-medium text-gray-900"}," ¿Deseás guardar los cambios del producto? ",-1),bs=t("p",{class:"mt-1 text-sm text-gray-600"}," Se actualizará la información y variantes del producto. ",-1),ys={class:"mt-6 flex justify-end"},xs=2*1024*1024,Os={__name:"Edit",props:{product:Object,categories:Array,selectedCategoryPath:Array},setup(ee){const c=ee,G=ke(),z=g(!!G?.props?.flash?.success);g(G?.props?.flash?.success||"");const M=g(!1),V=g(!1),U=g([]),te=o=>{const s=Array.from(o?.target?.files||[]),e=[],l=[];for(const n of s){if(!(n?.type||"").startsWith("image/")){e.push(`${n.name}: no es una imagen válida.`);continue}if(n.size>xs){e.push(`${n.name}: supera el límite de 2 MB.`);continue}l.push(n)}if(e.length){U.value=["Problemas con las imágenes seleccionadas:",...e],V.value=!0,o?.target&&(o.target.value=""),r.new_gallery_files=[];return}r.new_gallery_files=l},m=g([{options:c.categories,selected:null}]),se=async()=>{if(!Array.isArray(c.selectedCategoryPath)||c.selectedCategoryPath.length===0)return;for(let s=0;s<c.selectedCategoryPath.length;s++){const e=c.selectedCategoryPath[s];if(m.value[s]||(m.value[s]={options:[],selected:null}),s>0&&m.value[s].options.length===0){const l=m.value[s-1].selected;if(l){const u=await(await fetch(route("admin.categories.children",l))).json();m.value[s].options=Array.isArray(u.data)?u.data:[]}}m.value[s].selected=e.id,r.category_id=e.id,s<c.selectedCategoryPath.length-1&&(m.value[s+1]||(m.value[s+1]={options:[],selected:null}))}const o=r.category_id;if(o){const e=await(await fetch(route("admin.categories.children",o))).json(),l=Array.isArray(e.data)?e.data:[];l.length>0&&m.value.push({options:l,selected:null})}},oe=o=>{m.value.splice(o+1)},le=async o=>{const s=m.value[o].selected;if(oe(o),r.category_id=s||null,!s)return;const e=await fetch(route("admin.categories.children",s));if(!e.ok)return;const l=await e.json(),n=Array.isArray(l.data)?l.data:[];n.length>0&&m.value.push({options:n,selected:null})},ne=o=>Object.entries(o).map(([s,e])=>`${s}:${e}`).join(", "),re=c.product.variants.map(o=>({id:o.id,options_text:ne(o.options),price:o.price??"",purchase_price:o.purchase_price??null,retail_price:o.retail_price??null,stock:o.stock,alert:o.alert??null})),r=Ce({_method:"PUT",name:c.product.name,price:c.product.price,purchase_price:c.product.purchase_price??null,track_inventory:c.product.track_inventory??!0,quantity:c.product.quantity,alert:c.product.alert??null,category_id:c.product.category_id,short_description:c.product.short_description,long_description:c.product.long_description,specifications:c.product.specifications?JSON.parse(c.product.specifications).join(", "):"",new_gallery_files:[],images_to_delete:[],variants:re,variants_to_delete:[],variant_attributes:[]}),w=g([{name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}}]),ae=()=>{w.value.push({name:"",valuesText:"",dependsOn:"",rules:{},rulesSelected:{}})},ie=o=>{w.value.splice(o,1)},$=o=>String(o||"").split(",").map(s=>s.trim()).filter(Boolean);function de(o,s,e){return(o.rulesSelected&&Array.isArray(o.rulesSelected[s])?o.rulesSelected[s]:[]).includes(e)}function ce(o,s,e,l){const n=!!l?.target?.checked;o.rulesSelected||(o.rulesSelected={});const u=Array.isArray(o.rulesSelected[s])?[...o.rulesSelected[s]]:[],f=u.indexOf(e);n&&f===-1&&u.push(e),!n&&f!==-1&&u.splice(f,1),o.rulesSelected[s]=u}function ue(o){o.__showDependency=!o.__showDependency,o.__showDependency||(o.dependsOn="",o.rulesSelected={},o.rules={})}const pe=()=>{try{const o=Array.isArray(c.product.variants)?c.product.variants:[];if(o.length===0)return;const s=new Set;o.forEach(l=>{Object.keys(l?.options||{}).forEach(n=>s.add(n))});const e=[];s.forEach(l=>{const n=new Set;o.forEach(f=>{const p=(f?.options||{})[l];p!=null&&String(p).trim()!==""&&n.add(String(p))});const u=Array.from(n).join(", ");e.push({name:l,valuesText:u,dependsOn:"",rules:{},rulesSelected:{}})}),e.length>0&&(w.value=e)}catch{}},me=()=>{try{const o=c.product?.variant_attributes,s=Array.isArray(o)?o:[];if(s.length===0)return!1;const e=s.map(l=>{const n=Array.isArray(l?.values)?l.values:$(l?.valuesText||""),u=String(l?.dependsOn||"").trim(),f=typeof l?.rulesSelected=="object"&&l.rulesSelected?l.rulesSelected:{},p=typeof l?.rules=="object"&&l.rules?l.rules:{},y=!!(u||Object.keys(f).length||Object.keys(p).length);return{name:String(l?.name||""),valuesText:n.join(", "),dependsOn:u,rulesSelected:f,rules:p,__showDependency:y}}).filter(l=>l.name);if(e.length>0)return w.value=e,!0}catch{}return!1},he=()=>{try{const o=c.product?.variant_attributes||[];if(!Array.isArray(o)||o.length===0)return;const s=Object.fromEntries(w.value.map(e=>[e.name,e]));for(const e of o){const l=s[e.name];l&&(e.dependsOn&&(l.dependsOn=e.dependsOn,l.__showDependency=!0),e.rulesSelected&&typeof e.rulesSelected=="object"?(l.rulesSelected=e.rulesSelected,Object.keys(l.rulesSelected||{}).length>0&&(l.__showDependency=!0)):e.rules&&typeof e.rules=="object"&&(l.rules=e.rules,Object.keys(l.rules||{}).length>0&&(l.__showDependency=!0)))}}catch{}},h=g([...c.product.images]),L=o=>{r.images_to_delete.push(o.id),h.value=h.value.filter(s=>s.id!==o.id)},I=g(!1),b=g(0),H=g(!1);function T(){H.value=window.innerWidth<768}Se(()=>{T(),window.addEventListener("resize",T),se(),me()||(pe(),he())}),je(()=>window.removeEventListener("resize",T));const B=P(()=>H.value?1:4),fe=P(()=>h.value.slice(0,B.value)),R=P(()=>h.value.slice(B.value));function Q(o=0){b.value=o,I.value=!0}function W(){I.value=!1}function ve(){const o=h.value.length;o!==0&&(b.value=(b.value-1+o)%o)}function _e(){const o=h.value.length;o!==0&&(b.value=(b.value+1)%o)}function ge(o){o<0||o>=h.value.length||(b.value=o)}const be=P(()=>{if(r.variants.length>0){let o=0;return r.variants.forEach(s=>{o+=Number(s.stock)||0}),o}return Number(r.quantity)||0});Ae(be,o=>{r.variants.length>0&&(r.quantity=o)});const ye=()=>{try{const o=w.value.map(s=>({name:String(s.name||"").trim(),values:$(s.valuesText),dependsOn:String(s.dependsOn||"").trim(),rules:s.rules||{},rulesSelected:s.rulesSelected||{}})).filter(s=>s.name&&s.values.length>0);if(r.variant_attributes=o,o.length>0){let n=function(p){l.has(p.name)||(p.dependsOn&&s[p.dependsOn]&&n(s[p.dependsOn]),l.add(p.name),e.push(p))},f=function(p,y){if(p===e.length){u.push({...y});return}const S=e[p];let X=S.values;if(S.dependsOn){const D=y[S.dependsOn];if(D!=null){const q=S.rulesSelected?.[D]??S.rules?.[D]??[],Y=Array.isArray(q)?q:$(q);Y.length>0&&(X=S.values.filter(we=>Y.includes(we)))}}for(const D of X)y[S.name]=D,f(p+1,y);delete y[S.name]};const s=Object.fromEntries(o.map(p=>[p.name,p])),e=[],l=new Set;o.forEach(n);const u=[];f(0,{}),r.variants=u.map(p=>({id:null,options_text:e.map(y=>`${y.name}:${p[y.name]}`).join(", "),price:"",purchase_price:null,stock:0,alert:null}))}else r.variants=[]}catch{}M.value=!0},J=()=>{M.value=!1},xe=()=>{r.post(route("admin.products.update",c.product.id),{onError:async()=>{const o=[];for(const[s,e]of Object.entries(r.errors))s.startsWith("new_gallery_files.")&&String(e).toLowerCase().includes("image")?o.push("Una o más imágenes nuevas superan el tamaño máximo permitido (2 MB) o no son válidas."):o.push(String(e));U.value=o,V.value=o.length>0},onFinish:()=>{M.value=!1}})};return(o,s)=>(i(),a(k,null,[A(d(Oe),{title:"Editar Producto"}),A($e,null,{header:E(()=>[t("h2",Pe,"Editar Producto: "+C(d(r).name),1)]),default:E(()=>[t("div",ze,[t("div",Ue,[t("div",Ie,[t("div",Te,[t("form",{onSubmit:_(ye,["prevent"])},[t("div",Be,[t("div",null,[t("div",qe,[Ne,v(t("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=e=>d(r).name=e),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[x,d(r).name]])]),t("div",Fe,[Ge,v(t("input",{id:"price","onUpdate:modelValue":s[1]||(s[1]=e=>d(r).price=e),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",required:""},null,512),[[x,d(r).price]])]),t("label",Le,[v(t("input",{type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=e=>d(r).track_inventory=e),class:"rounded"},null,512),[[Ve,d(r).track_inventory]]),He]),d(r).track_inventory?(i(),a("div",Re,[t("div",null,[Qe,v(t("input",{id:"quantity","onUpdate:modelValue":s[3]||(s[3]=e=>d(r).quantity=e),type:"number",class:N(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,required:"",title:"Stock si no hay variantes. Con variantes, se suma automáticamente."},null,10,We),[[x,d(r).quantity]])]),t("div",null,[Je,v(t("input",{id:"alert_general","onUpdate:modelValue":s[4]||(s[4]=e=>d(r).alert=e),type:"number",class:N(["block mt-1 w-full rounded-md shadow-sm border-gray-300",{"bg-gray-100":d(r).track_inventory===!1}]),disabled:d(r).track_inventory===!1,title:"Se considera bajo stock cuando cantidad ≤ alerta."},null,10,Xe),[[x,d(r).alert]])]),t("div",null,[Ye,v(t("input",{id:"purchase_price","onUpdate:modelValue":s[5]||(s[5]=e=>d(r).purchase_price=e),type:"number",step:"0.01",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[x,d(r).purchase_price]])])])):O("",!0),Ke,t("div",Ze,[(i(!0),a(k,null,j(m.value,(e,l)=>(i(),a("div",{key:l,class:"mb-1"},[v(t("select",{class:"block w-full rounded-md shadow-sm border-gray-300","onUpdate:modelValue":n=>e.selected=n,onChange:n=>le(l)},[tt,(i(!0),a(k,null,j(e.options,n=>(i(),a("option",{key:n.id,value:n.id},C(n.name),9,st))),128))],40,et),[[K,e.selected]])]))),128))])]),t("div",null,[t("div",ot,[lt,v(t("textarea",{id:"short_description","onUpdate:modelValue":s[6]||(s[6]=e=>d(r).short_description=e),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"3"},null,512),[[x,d(r).short_description]])]),t("div",nt,[rt,v(t("textarea",{id:"long_description","onUpdate:modelValue":s[7]||(s[7]=e=>d(r).long_description=e),class:"block mt-1 w-full rounded-md shadow-sm border-gray-300",rows:"5"},null,512),[[x,d(r).long_description]])]),t("div",at,[it,v(t("input",{id:"specifications","onUpdate:modelValue":s[8]||(s[8]=e=>d(r).specifications=e),type:"text",class:"block mt-1 w-full rounded-md shadow-sm border-gray-300"},null,512),[[x,d(r).specifications]])])])]),t("div",dt,[ct,ut,t("div",pt,[t("div",mt,[(i(!0),a(k,null,j(w.value,(e,l)=>(i(),a("div",{key:`attr-${l}`,class:"grid grid-cols-1 md:grid-cols-5 gap-3 items-center"},[t("div",ht,[ft,v(t("input",{"onUpdate:modelValue":n=>e.name=n,type:"text",placeholder:"Color",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,vt),[[x,e.name]])]),t("div",_t,[gt,v(t("input",{"onUpdate:modelValue":n=>e.valuesText=n,type:"text",placeholder:"Rojo, Verde, Azul",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},null,8,bt),[[x,e.valuesText]])]),t("div",yt,[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:n=>ue(e),title:e.__showDependency?"Ocultar dependencia":"Configurar dependencia","aria-label":e.__showDependency?"Ocultar dependencia":"Configurar dependencia"},[e.__showDependency?(i(),a("svg",St,At)):(i(),a("svg",wt,Ct))],8,xt),t("span",{class:"text-xs text-blue-600 md:hidden",textContent:C(e.__showDependency?"Ocultar":"Depend.")},null,8,Ot)]),e.__showDependency?(i(),a("div",Vt,[t("div",$t,[Dt,v(t("select",{"onUpdate:modelValue":n=>e.dependsOn=n,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm"},[Mt,(i(!0),a(k,null,j(w.value,(n,u)=>(i(),a("option",{key:`dep-${l}-${u}`,value:n.name,disabled:n===e||!n.name},C(n.name||"(sin nombre)"),9,Pt))),128))],8,Et),[[K,e.dependsOn]])]),e.dependsOn?(i(),a("div",zt,[Ut,t("div",It,[(i(!0),a(k,null,j($(w.value.find(n=>n.name===e.dependsOn)?.valuesText||""),n=>(i(),a("div",{key:`pv-${l}-${n}`,class:"border rounded p-2"},[t("div",Tt,[F(C(e.dependsOn)+" = ",1),t("strong",null,C(n),1)]),t("div",Bt,[(i(!0),a(k,null,j($(e.valuesText),u=>(i(),a("label",{key:`cv-${l}-${n}-${u}`,class:"inline-flex items-center gap-1 text-sm"},[t("input",{type:"checkbox",checked:de(e,n,u),onChange:f=>ce(e,n,u,f),class:"rounded"},null,40,qt),t("span",null,C(u),1)]))),128))])]))),128))]),Nt])):O("",!0)])):O("",!0),t("div",Ft,[t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-blue-200 text-blue-600 hover:bg-blue-50 hover:border-blue-300",onClick:ae,title:"Añadir atributo","aria-label":"Añadir atributo"},Lt),Ht]),t("div",Rt,[t("button",{type:"button",class:"inline-flex items-center justify-center w-8 h-8 rounded-full border border-red-200 text-red-600 hover:bg-red-50 hover:border-red-300",onClick:n=>ie(l),title:"Quitar atributo","aria-label":"Quitar atributo"},Jt,8,Qt),Xt])])]))),128))])])]),t("div",Yt,[t("div",Kt,[t("div",Zt,[es,t("span",ts,C(h.value.length)+" imagen(es)",1)]),h.value.length>0?(i(),a("div",ss,[(i(!0),a(k,null,j(fe.value,(e,l)=>(i(),a("div",{key:e.id,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer",onClick:n=>Q(l)},[t("img",{src:e.path,class:"w-full h-full aspect-[4/3] object-cover",alt:"Imagen del producto"},null,8,ls),t("button",{onClick:_(n=>L(e),["stop","prevent"]),type:"button",class:"absolute top-2 right-2 bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center shadow-md hover:bg-red-700"}," × ",8,ns)],8,os))),128)),R.value.length>0?(i(),a("div",{key:0,class:"relative rounded-lg overflow-hidden border bg-white shadow-sm hover:shadow-md transition group cursor-pointer flex items-center justify-center text-gray-800 font-bold text-base h-full min-h-[90px]",onClick:s[9]||(s[9]=e=>Q(B.value))}," +"+C(R.value.length),1)):O("",!0)])):(i(),a("p",rs,"Este producto no tiene imágenes."))]),t("div",as,[is,t("input",{id:"new_gallery_files",onInput:s[10]||(s[10]=e=>te(e)),type:"file",multiple:"",class:"block mt-1 w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),ds])]),I.value?(i(),a("div",{key:0,class:"fixed inset-0 bg-black/50 z-[1000] flex items-center justify-center p-4",style:{"pointer-events":"auto"},onClick:_(W,["self"])},[t("div",{class:"bg-white rounded-lg p-4 w-full max-w-5xl max-h-[85vh] overflow-hidden relative",onClick:s[16]||(s[16]=_(()=>{},["stop"]))},[t("button",{type:"button",class:"absolute top-3 right-3 bg-gray-900 text-white rounded-full w-8 h-8 flex items-center justify-center z-30",onClick:_(W,["stop","prevent"]),onMousedown:s[11]||(s[11]=_(()=>{},["stop","prevent"]))},"×",32),t("div",cs,[t("button",{class:"absolute left-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:_(ve,["stop","prevent"]),onMousedown:s[12]||(s[12]=_(()=>{},["stop","prevent"]))},"‹",32),t("img",{src:h.value[b.value]?.path,class:"max-w-full max-h-full object-contain",alt:"Imagen"},null,8,us),t("button",{class:"absolute right-2 bg-white/90 border rounded-full w-9 h-9 flex items-center justify-center z-20",onClick:_(_e,["stop","prevent"]),onMousedown:s[13]||(s[13]=_(()=>{},["stop","prevent"]))},"›",32),h.value[b.value]?(i(),a("button",{key:0,class:"absolute top-2 right-12 bg-red-600 text-white rounded px-2 py-1 text-xs z-20",type:"button",onClick:s[14]||(s[14]=_(e=>L(h.value[b.value]),["stop","prevent"])),onMousedown:s[15]||(s[15]=_(()=>{},["stop","prevent"]))},"Eliminar",32)):O("",!0)]),t("div",ps,[(i(!0),a(k,null,j(h.value,(e,l)=>(i(),a("div",{key:e.id,class:N(["border rounded p-1 cursor-pointer flex-shrink-0",{"ring-2 ring-blue-500":l===b.value}]),onClick:n=>ge(l)},[t("img",{src:e.path,class:"w-20 h-20 object-cover rounded",alt:"thumb"},null,8,hs)],10,ms))),128))])])])):O("",!0),t("div",fs,[t("button",{type:"submit",disabled:d(r).processing,class:"bg-blue-500 text-white font-bold py-2 px-4 rounded hover:bg-blue-700"}," Actualizar Producto ",8,vs)])],32)])])])])]),_:1}),A(De,{show:M.value,onClose:J},{default:E(()=>[t("div",_s,[gs,bs,t("div",ys,[A(Ee,{onClick:J},{default:E(()=>[F("Cancelar")]),_:1}),A(Me,{class:"ms-3",onClick:xe,disabled:d(r).processing},{default:E(()=>[F(" Guardar cambios ")]),_:1},8,["disabled"])])])]),_:1},8,["show"]),A(Z,{show:z.value,type:"success",title:"Producto actualizado","primary-text":"Entendido",onPrimary:s[17]||(s[17]=e=>z.value=!1),onClose:s[18]||(s[18]=e=>z.value=!1)},null,8,["show"]),A(Z,{show:V.value,type:"error",title:"No pudimos actualizar el producto",message:"Revisá los siguientes puntos:",messages:U.value,"primary-text":"Entendido",onPrimary:s[19]||(s[19]=e=>V.value=!1),onClose:s[20]||(s[20]=e=>V.value=!1)},null,8,["show","messages"])],64))}};export{Os as default};
