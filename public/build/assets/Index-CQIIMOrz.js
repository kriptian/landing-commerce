import{M as G,r as a,o as O,n as R,a as W,b as l,d as i,e as n,u as g,h as J,f as c,g as e,j as m,v as K,F as M,l as B,t as p,A as E,k as h,q as V,p as $,i as j,m as Q,s as d}from"./app-D7ttTWGz.js";import{_ as X}from"./AuthenticatedLayout-DDDo1cMT.js";import{_ as Y}from"./Modal-UfrBPs3q.js";import{_ as Z}from"./SecondaryButton-BF1VL4P6.js";import{D as ee}from"./DangerButton-BaZ0rkI2.js";import{_ as te}from"./AlertModal-Bl0CaqCv.js";const se=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Gestionar Productos",-1),oe={class:"py-12"},ae={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ne={class:"p-6 text-gray-900"},le={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4"},ie={class:"flex flex-wrap items-center gap-3"},ce=e("option",{value:""},"Todas las categorías",-1),de=["value"],pe=e("option",{value:""},"Todos",-1),ue=e("option",{value:"active"},"Activos",-1),me=e("option",{value:"inactive"},"Inactivos",-1),he=[pe,ue,me],xe=e("div",{class:"hidden md:block h-6 w-px bg-gray-200"},null,-1),_e={class:"flex items-center gap-2 border rounded-lg px-3 py-2"},ve=e("span",{class:"text-sm text-gray-600"},"Promo Global:",-1),ge={class:"inline-flex items-center gap-1 text-sm"},ye=["checked"],fe=["value"],we=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M4 4a2 2 0 0 1 2-2h7l5 5v13a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4zm9-1.5V7h4.5L13 2.5z"}),e("path",{d:"M8 13h8v2H8zM8 9h5v2H8z"})],-1),be=e("span",null,"Crear",-1),ke={class:"pointer-events-none absolute inset-y-0 left-0 w-6 bg-gradient-to-r from-white to-transparent"},Ce={class:"pointer-events-none absolute inset-y-0 right-0 w-6 bg-gradient-to-l from-white to-transparent"},Pe={class:"min-w-[900px] w-full divide-y divide-gray-200 table-auto"},Se=e("thead",{class:"sticky top-0 z-10 bg-gray-50"},[e("tr",null,[e("th",{class:"sticky left-0 z-20 bg-gray-50 px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Nombre"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Precio"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Cantidad"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Categoría"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Activo"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Promoción"),e("th",{class:"px-3 py-2 sm:px-6 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase whitespace-nowrap"},"Acciones")])],-1),Me={class:"bg-white divide-y divide-gray-200"},ze={key:0},Le=e("td",{colspan:"6",class:"px-3 py-3 sm:px-6 sm:py-4 text-center text-gray-500"},"No hay productos creados.",-1),Ae=[Le],Ne={key:0,class:"ml-2 inline-flex items-center rounded bg-gray-200 text-gray-700 text-xs font-semibold px-2 py-0.5"},Be={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Ee={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Ve={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},$e={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},je={class:"inline-flex items-center gap-1 text-sm"},De=["checked","onChange"],Ie={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap"},Fe={class:"flex items-center gap-2"},Te={class:"inline-flex items-center gap-1 text-sm"},He=["checked","onChange"],qe=["value","onInput"],Ue={class:"px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap text-sm font-medium"},Ge={class:"flex items-center gap-2"},Oe=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M16.862 3.487a2.25 2.25 0 113.182 3.182L9.428 17.284a3.75 3.75 0 01-1.582.992l-2.685.805a.75.75 0 01-.93-.93l.805-2.685a3.75 3.75 0 01.992-1.582L16.862 3.487z"}),e("path",{d:"M15.75 4.5l3.75 3.75"})],-1),Re=["onClick"],We=e("svg",{class:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M16.5 4.5V6h3.75a.75.75 0 010 1.5H3.75A.75.75 0 013 6h3.75V4.5A2.25 2.25 0 019 2.25h6A2.25 2.25 0 0117.25 4.5zM5.625 7.5h12.75l-.701 10.518A2.25 2.25 0 0115.43 20.25H8.57a2.25 2.25 0 01-2.244-2.232L5.625 7.5z","clip-rule":"evenodd"})],-1),Je=[We],Ke={class:"p-6"},Qe=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que querés eliminar este producto? ",-1),Xe=e("p",{class:"mt-1 text-sm text-gray-600"}," Esta acción es irreversible. Se borrará el producto con todas sus variantes e imágenes. ",-1),Ye={class:"mt-6 flex justify-end"},rt={__name:"Index",props:{products:Array,categories:Array,store:Object,filters:Object},setup(y){const r=y,z=G(),f=a(r.filters?.search||""),w=a(r.filters?.category||""),b=a(r.filters?.status||""),k=a(!1),C=a(null),x=a(!!z?.props?.flash?.success),L=a(z?.props?.flash?.success||""),D=s=>{C.value=s,k.value=!0},P=()=>{k.value=!1,C.value=null},I=()=>{d.delete(route("admin.products.destroy",C.value),{onSuccess:()=>{P(),L.value="¡Producto eliminado con éxito!",x.value=!0}})},F=s=>{d.put(route("admin.products.update",s.id),{promo_active:!s.promo_active,promo_discount_percent:s.promo_discount_percent},{preserveScroll:!0})},T=(s,o)=>{const t=Math.max(1,Math.min(90,Number(o)||0));d.put(route("admin.products.update",s.id),{promo_discount_percent:t,promo_active:!0},{preserveScroll:!0})},H=()=>{d.put(route("admin.products.store_promo"),{promo_active:!r.store.promo_active,promo_discount_percent:r.store.promo_discount_percent},{preserveScroll:!0})},q=s=>{const o=Math.max(1,Math.min(90,Number(s)||0));d.put(route("admin.products.store_promo"),{promo_active:!0,promo_discount_percent:o},{preserveScroll:!0})},S=()=>{d.get(route("admin.products.index"),{search:f.value,category:w.value,status:b.value},{preserveState:!0,replace:!0,preserveScroll:!0})},_=a(null),A=a(!1),N=a(!1),u=()=>{const s=_.value;if(!s)return;const o=s.scrollWidth-s.clientWidth,t=s.scrollLeft||0;A.value=t>0,N.value=t<o-1};return O(()=>{R(()=>u()),_.value?.addEventListener("scroll",u,{passive:!0}),window.addEventListener("resize",u)}),W(()=>{_.value?.removeEventListener("scroll",u),window.removeEventListener("resize",u)}),(s,o)=>(i(),l(M,null,[n(g(J),{title:"Gestionar Productos"}),n(X,null,{header:c(()=>[se]),default:c(()=>[e("div",oe,[e("div",ae,[e("div",re,[e("div",ne,[e("div",le,[e("div",ie,[m(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=t=>f.value=t),onInput:S,placeholder:"Buscar productos...",class:"border rounded px-3 py-2 text-sm h-10"},null,544),[[K,f.value]]),m(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>w.value=t),onChange:S,class:"border rounded px-2 py-2 text-sm h-10 min-w-[170px] max-w-[220px]"},[ce,(i(!0),l(M,null,B(r.categories,t=>(i(),l("option",{key:t.id,value:t.id},p(t.name),9,de))),128))],544),[[E,w.value]]),m(e("select",{"onUpdate:modelValue":o[2]||(o[2]=t=>b.value=t),onChange:S,class:"border rounded px-2 py-2 text-sm h-10 min-w-[150px]"},he,544),[[E,b.value]]),xe,e("div",_e,[ve,e("label",ge,[e("input",{type:"checkbox",checked:r.store.promo_active,onChange:H,class:"rounded border-gray-300"},null,40,ye),h(" Activa ")]),e("input",{type:"number",min:"1",max:"90",value:r.store.promo_discount_percent??"",onInput:o[3]||(o[3]=t=>q(t.target.value)),placeholder:"%",class:"w-16 text-sm border rounded px-1 py-0.5"},null,40,fe)]),n(g(V),{href:s.route("admin.products.create"),class:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow"},{default:c(()=>[we,be]),_:1},8,["href"])])]),e("div",{ref_key:"scrollBoxRef",ref:_,class:"relative overflow-x-auto"},[m(e("div",ke,null,512),[[$,A.value]]),m(e("div",Ce,null,512),[[$,N.value]]),e("table",Pe,[Se,e("tbody",Me,[y.products.length===0?(i(),l("tr",ze,Ae)):j("",!0),(i(!0),l(M,null,B(y.products,(t,U)=>(i(),l("tr",{key:t.id,class:"odd:bg-white even:bg-gray-100"},[e("td",{class:Q(["sticky left-0 z-10 px-3 py-3 sm:px-6 sm:py-4 whitespace-nowrap border-r",U%2===1?"bg-gray-100":"bg-white"])},[e("span",null,p(t.name),1),t.is_active?j("",!0):(i(),l("span",Ne,"Inactivo"))],2),e("td",Be,"$ "+p(Number(t.price).toLocaleString("es-CO")),1),e("td",Ee,p(t.quantity),1),e("td",Ve,p(t.category?t.category.name:"Sin Categoría"),1),e("td",$e,[e("label",je,[e("input",{type:"checkbox",checked:t.is_active,onChange:v=>g(d).put(s.route("admin.products.update",t.id),{is_active:!t.is_active},{preserveScroll:!0}),class:"rounded border-gray-300"},null,40,De),h(" "+p(t.is_active?"Sí":"No"),1)])]),e("td",Ie,[e("div",Fe,[e("label",Te,[e("input",{type:"checkbox",checked:t.promo_active,onChange:v=>F(t),class:"rounded border-gray-300"},null,40,He),h(" Activa ")]),e("input",{type:"number",min:"1",max:"90",value:t.promo_discount_percent??"",onInput:v=>T(t,v.target.value),placeholder:"%",class:"w-16 text-sm border rounded px-1 py-0.5"},null,40,qe)])]),e("td",Ue,[e("div",Ge,[n(g(V),{href:s.route("admin.products.edit",t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-indigo-600",title:"Editar"},{default:c(()=>[Oe]),_:2},1032,["href"]),e("button",{onClick:v=>D(t.id),class:"w-8 h-8 inline-flex items-center justify-center rounded hover:bg-gray-100 text-red-600",title:"Eliminar"},Je,8,Re)])])]))),128))])])],512)])])])])]),_:1}),n(Y,{show:k.value,onClose:P},{default:c(()=>[e("div",Ke,[Qe,Xe,e("div",Ye,[n(Z,{onClick:P},{default:c(()=>[h(" Cancelar ")]),_:1}),n(ee,{class:"ms-3",onClick:I},{default:c(()=>[h(" Sí, Eliminar Producto ")]),_:1})])])]),_:1},8,["show"]),n(te,{show:x.value,type:"success",title:"Producto",message:L.value,"primary-text":"Entendido",onPrimary:o[4]||(o[4]=t=>x.value=!1),onClose:o[5]||(o[5]=t=>x.value=!1)},null,8,["show","message"])],64))}};export{rt as default};
