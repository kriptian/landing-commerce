import{r as f,u as H,c as T,a as i,o as d,b as r,d as l,h as Q,e as n,f as e,m as c,F as k,n as S,p as R,i as _,t as p,g as G,j as u,v as C,q as v,k as I,x as J,l as K,z as A}from"./app-BbGXU1BN.js";import{_ as X}from"./AuthenticatedLayout-CMzDSey0.js";import{_ as U}from"./Modal-CeUYkVjj.js";import{_ as V}from"./PrimaryButton-BkNxEDiy.js";import{_ as E}from"./SecondaryButton-CsdLUJtp.js";import{D as N}from"./DangerButton-CrOT-1pB.js";import"./AlertModal-DRMsBwYl.js";const Y={class:"flex items-center justify-between"},Z=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Galería de Imágenes ",-1),ee={class:"py-12"},te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},oe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6"},le={class:"mb-6 flex items-center justify-between"},ae=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Imágenes de la Galería"),e("p",{class:"text-sm text-gray-600 mt-1"}," Gestiona las imágenes que se mostrarán en la galería principal del catálogo. ")],-1),ie={key:0,class:"text-center py-12"},de=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),re=e("p",{class:"mt-4 text-sm text-gray-500"},"No hay elementos en la galería",-1),ne={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ue={class:"relative h-48 bg-gray-100"},ce=["src","alt"],me=["src"],_e={key:2,class:"w-full h-full flex items-center justify-center bg-gray-800"},pe={class:"text-white text-sm text-center px-4"},ve=e("svg",{class:"w-12 h-12 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M8 5v14l11-7z"})],-1),fe=e("p",null,"Video Externo",-1),be={class:"text-xs mt-1 opacity-75 truncate"},ye={key:3,class:"absolute top-2 right-2 bg-gray-600 text-white text-xs px-2 py-1 rounded"},ge={key:4,class:"absolute top-2 left-2 bg-blue-600 text-white text-xs px-2 py-1 rounded"},xe={class:"p-4"},he={class:"font-semibold text-gray-900 mb-1"},we={key:0,class:"text-sm text-gray-600 mb-2 line-clamp-2"},ke={class:"text-xs text-gray-500 space-y-1"},Ce={key:0},Ve=e("strong",null,"Producto:",-1),Ee=e("strong",null,"Botón comprar:",-1),Me=e("strong",null,"Orden:",-1),Se={class:"mt-4 flex gap-2"},Ie={class:"p-6"},Ae=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Agregar Elemento a la Galería",-1),Ue={class:"space-y-4"},je=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tipo de Media * ",-1),De={class:"flex gap-4"},Pe={class:"flex items-center"},$e=e("span",{class:"text-sm text-gray-700"},"Imagen",-1),Be={class:"flex items-center"},Te=e("span",{class:"text-sm text-gray-700"},"Video",-1),Ge={key:0},Ne=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Imagen * ",-1),qe=["required"],ze={key:1},Fe=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Subir Video * ",-1),Le=["required"],Oe=e("p",{class:"mt-1 text-xs text-gray-500"}," Formatos: MP4, WebM, OGG (máx. 50MB) ",-1),We=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Título ",-1),He=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Descripción ",-1),Qe=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Producto (opcional) ",-1),Re={class:"relative"},Je={class:"relative"},Ke=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1),Xe={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},Ye=["onClick"],Ze={class:"text-sm font-medium text-gray-900"},et={key:0,class:"px-4 py-2 text-sm text-gray-500"},tt={key:0,class:"mt-2 flex items-center justify-between bg-blue-50 border border-blue-200 rounded-md px-3 py-2"},ot={class:"text-sm text-blue-900"},st=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),lt=[st],at=e("p",{class:"mt-1 text-xs text-gray-500"},' Si seleccionas un producto, el botón "Comprar ahora" redirigirá a ese producto. ',-1),it={class:"flex items-center"},dt=e("span",{class:"ml-2 text-sm text-gray-700"},'Mostrar botón "Comprar ahora"',-1),rt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Orden ",-1),nt=e("p",{class:"mt-1 text-xs text-gray-500"}," Las imágenes se mostrarán en este orden (menor número primero). ",-1),ut={class:"mt-6 flex justify-end gap-3"},ct={class:"p-6"},mt=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Editar Elemento",-1),_t={class:"space-y-4"},pt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tipo de Media ",-1),vt={class:"flex gap-4"},ft={class:"flex items-center"},bt=e("span",{class:"text-sm text-gray-700"},"Imagen",-1),yt={class:"flex items-center"},gt=e("span",{class:"text-sm text-gray-700"},"Video",-1),xt={key:0},ht=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nueva Imagen (opcional) ",-1),wt=e("p",{class:"mt-1 text-xs text-gray-500"}," Deja vacío para mantener la imagen actual. ",-1),kt={key:1},Ct=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Nuevo Video (opcional) ",-1),Vt=e("p",{class:"mt-1 text-xs text-gray-500"}," Deja vacío para mantener el video actual. Formatos: MP4, WebM, OGG (máx. 50MB) ",-1),Et=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Título ",-1),Mt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Descripción ",-1),St=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Producto (opcional) ",-1),It=e("option",{value:null},"Sin producto",-1),At=["value"],Ut={class:"flex items-center"},jt=e("span",{class:"ml-2 text-sm text-gray-700"},'Mostrar botón "Comprar ahora"',-1),Dt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Orden ",-1),Pt={class:"flex items-center"},$t=e("span",{class:"ml-2 text-sm text-gray-700"},"Activa",-1),Bt={class:"mt-6 flex justify-end gap-3"},Tt={class:"p-6"},Gt=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Eliminar Imagen",-1),Nt=e("p",{class:"text-gray-600 mb-4"}," ¿Estás seguro de que deseas eliminar esta imagen? Esta acción no se puede deshacer. ",-1),qt={class:"flex justify-end gap-3"},Rt={__name:"Index",props:{galleryImages:{type:Array,default:()=>[]},products:{type:Array,default:()=>[]}},setup(b){const y=b,g=f(!1),x=f(!1),h=f(!1),w=f(null),M=f(null),m=f(""),t=H({_method:"PUT",media_type:"image",image:null,video:null,title:"",description:"",product_id:null,show_buy_button:!0,order:0,is_active:!0}),j=()=>{t.reset(),t.order=y.galleryImages?.length||0,g.value=!0},q=a=>{w.value=a,t.media_type=String(a.media_type||"image"),t.title=a.title||"",t.description=a.description||"",t.product_id=a.product_id||null,t.show_buy_button=a.show_buy_button!==void 0?!!a.show_buy_button:!0,t.order=a.order||0,t.is_active=a.is_active!==void 0?!!a.is_active:!0,t.image=null,t.video=null;const s=y.products.find(o=>o.id===a.product_id);m.value=s?s.name:"",x.value=!0},z=a=>{M.value=a,h.value=!0},F=()=>{if(t.media_type==="video"&&!t.video){alert("Debes seleccionar un archivo de video para continuar.");return}if(t.media_type==="image"&&!t.image){alert("Debes seleccionar una imagen para continuar.");return}const a={media_type:String(t.media_type||"image"),title:t.title||"",description:t.description||"",show_buy_button:t.show_buy_button?"1":"0",is_active:t.is_active?"1":"0",order:String(t.order||0)};t.product_id&&(a.product_id=String(t.product_id)),t.image&&(a.image=t.image),t.video&&(a.video=t.video),A.post(route("admin.gallery-images.store"),a,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{g.value=!1,t.reset(),m.value=""},onError:s=>{s.video?alert("Error con el video: "+(Array.isArray(s.video)?s.video[0]:s.video)):s.image?alert("Error con la imagen: "+(Array.isArray(s.image)?s.image[0]:s.image)):s.error?alert("Error: "+(Array.isArray(s.error)?s.error[0]:s.error)):alert("Error al guardar el elemento. Por favor, verifica los datos e intenta nuevamente.")}})},L=()=>{const s={_method:"PUT",media_type:String(t.media_type||w.value?.media_type||"image"),title:t.title||"",description:t.description||"",show_buy_button:t.show_buy_button?"1":"0",is_active:t.is_active?"1":"0",order:String(t.order||0)};t.product_id&&(s.product_id=String(t.product_id)),t.image&&(s.image=t.image),t.video&&(s.video=t.video),A.post(route("admin.gallery-images.update",w.value.id),s,{forceFormData:!0,preserveScroll:!0,onSuccess:()=>{x.value=!1,w.value=null,t.reset(),m.value=""},onError:o=>{o.media_type?alert("Error: El campo tipo de media es requerido. Por favor, selecciona Imagen o Video."):o.video?alert("Error con el video: "+(Array.isArray(o.video)?o.video[0]:o.video)):o.error?alert("Error: "+(Array.isArray(o.error)?o.error[0]:o.error)):alert("Error al actualizar el elemento. Por favor, verifica los datos e intenta nuevamente.")}})},O=()=>{A.delete(route("admin.gallery-images.destroy",M.value.id),{preserveScroll:!0,onSuccess:()=>{h.value=!1,M.value=null}})},D=a=>{t.image=a.target.files[0]},P=a=>{t.video=a.target.files[0]},$=T(()=>{if(!m.value)return y.products.slice(0,10);const a=m.value.toLowerCase();return y.products.filter(s=>s.name.toLowerCase().includes(a)).slice(0,10)}),W=T(()=>{if(!t.product_id)return"";const a=y.products.find(s=>s.id===t.product_id);return a?a.name:""});return(a,s)=>(d(),i(k,null,[r(l(Q),{title:"Galería de Imágenes"}),r(X,null,{header:n(()=>[e("div",Y,[Z,r(l(K),{href:a.route("admin.catalog-customization.index"),class:"text-sm text-gray-600 hover:text-gray-800"},{default:n(()=>[c(" ← Volver a Personalización ")]),_:1},8,["href"])])]),default:n(()=>[e("div",ee,[e("div",te,[e("div",oe,[e("div",se,[e("div",le,[ae,r(V,{onClick:j},{default:n(()=>[c(" + Agregar Elemento ")]),_:1})]),!b.galleryImages||b.galleryImages.length===0?(d(),i("div",ie,[de,re,r(V,{onClick:j,class:"mt-4"},{default:n(()=>[c(" Agregar Primer Elemento ")]),_:1})])):(d(),i("div",ne,[(d(!0),i(k,null,S(b.galleryImages,o=>(d(),i("div",{key:o.id,class:R(["border border-gray-200 rounded-lg overflow-hidden hover:shadow-lg transition-shadow",{"opacity-50":!o.is_active}])},[e("div",ue,[o.media_type==="image"||!o.media_type?(d(),i("img",{key:0,src:o.image_url,alt:o.title||"Imagen de galería",class:"w-full h-full object-cover"},null,8,ce)):o.media_type==="video"&&o.video_url&&!o.video_url.startsWith("http")?(d(),i("video",{key:1,src:o.video_url,class:"w-full h-full object-cover",muted:""},null,8,me)):o.media_type==="video"&&o.video_url&&o.video_url.startsWith("http")?(d(),i("div",_e,[e("div",pe,[ve,fe,e("p",be,p(o.video_url),1)])])):_("",!0),o.is_active?_("",!0):(d(),i("div",ye," Inactiva ")),o.media_type==="video"?(d(),i("div",ge," Video ")):_("",!0)]),e("div",xe,[e("h4",he,p(o.title||"Sin título"),1),o.description?(d(),i("p",we,p(o.description),1)):_("",!0),e("div",ke,[o.product?(d(),i("p",Ce,[Ve,c(" "+p(o.product.name),1)])):_("",!0),e("p",null,[Ee,c(" "+p(o.show_buy_button?"Sí":"No"),1)]),e("p",null,[Me,c(" "+p(o.order),1)])]),e("div",Se,[r(E,{onClick:B=>q(o),class:"flex-1 text-sm"},{default:n(()=>[c(" Editar ")]),_:2},1032,["onClick"]),r(N,{onClick:B=>z(o),class:"flex-1 text-sm"},{default:n(()=>[c(" Eliminar ")]),_:2},1032,["onClick"])])])],2))),128))]))])])])]),r(U,{show:g.value,onClose:s[10]||(s[10]=o=>g.value=!1)},{default:n(()=>[e("div",Ie,[Ae,e("form",{onSubmit:G(F,["prevent"])},[e("div",Ue,[e("div",null,[je,e("div",De,[e("label",Pe,[u(e("input",{type:"radio","onUpdate:modelValue":s[0]||(s[0]=o=>l(t).media_type=o),value:"image",class:"mr-2"},null,512),[[C,l(t).media_type]]),$e]),e("label",Be,[u(e("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=o=>l(t).media_type=o),value:"video",class:"mr-2"},null,512),[[C,l(t).media_type]]),Te])])]),l(t).media_type==="image"?(d(),i("div",Ge,[Ne,e("input",{type:"file",onChange:D,accept:"image/*",required:l(t).media_type==="image",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,40,qe)])):_("",!0),l(t).media_type==="video"?(d(),i("div",ze,[Fe,e("input",{type:"file",onChange:P,accept:"video/*",required:l(t).media_type==="video",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,40,Le),Oe])):_("",!0),e("div",null,[We,u(e("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>l(t).title=o),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm",placeholder:"Título de la imagen"},null,512),[[v,l(t).title]])]),e("div",null,[He,u(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=o=>l(t).description=o),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm",placeholder:"Descripción de la imagen"},null,512),[[v,l(t).description]])]),e("div",null,[Qe,e("div",Re,[e("div",Je,[u(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>m.value=o),type:"text",placeholder:"Buscar producto...",class:"block w-full rounded-md border-gray-300 shadow-sm pl-10 pr-4",onFocus:s[5]||(s[5]=o=>m.value=m.value||"")},null,544),[[v,m.value]]),Ke]),m.value&&!l(t).product_id?(d(),i("div",Xe,[(d(!0),i(k,null,S($.value,o=>(d(),i("div",{key:o.id,onClick:B=>{l(t).product_id=o.id,m.value=o.name},class:"px-4 py-2 hover:bg-gray-100 cursor-pointer"},[e("p",Ze,p(o.name),1)],8,Ye))),128)),$.value.length===0?(d(),i("div",et," No se encontraron productos ")):_("",!0)])):_("",!0)]),l(t).product_id?(d(),i("div",tt,[e("span",ot,p(W.value),1),e("button",{type:"button",onClick:s[6]||(s[6]=o=>{l(t).product_id=null,m.value=""}),class:"text-blue-600 hover:text-blue-800"},lt)])):_("",!0),at]),e("div",null,[e("label",it,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=o=>l(t).show_buy_button=o),class:"rounded border-gray-300 text-blue-600"},null,512),[[I,l(t).show_buy_button]]),dt])]),e("div",null,[rt,u(e("input",{"onUpdate:modelValue":s[8]||(s[8]=o=>l(t).order=o),type:"number",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[v,l(t).order,void 0,{number:!0}]]),nt])]),e("div",ut,[r(E,{type:"button",onClick:s[9]||(s[9]=o=>g.value=!1)},{default:n(()=>[c(" Cancelar ")]),_:1}),r(V,{type:"submit",disabled:l(t).processing},{default:n(()=>[c(" Agregar ")]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),r(U,{show:x.value,onClose:s[20]||(s[20]=o=>x.value=!1)},{default:n(()=>[e("div",ct,[mt,e("form",{onSubmit:G(L,["prevent"])},[e("div",_t,[e("div",null,[pt,e("div",vt,[e("label",ft,[u(e("input",{type:"radio","onUpdate:modelValue":s[11]||(s[11]=o=>l(t).media_type=o),value:"image",class:"mr-2"},null,512),[[C,l(t).media_type]]),bt]),e("label",yt,[u(e("input",{type:"radio","onUpdate:modelValue":s[12]||(s[12]=o=>l(t).media_type=o),value:"video",class:"mr-2"},null,512),[[C,l(t).media_type]]),gt])])]),l(t).media_type==="image"?(d(),i("div",xt,[ht,e("input",{type:"file",onChange:D,accept:"image/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),wt])):_("",!0),l(t).media_type==="video"?(d(),i("div",kt,[Ct,e("input",{type:"file",onChange:P,accept:"video/*",class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),Vt])):_("",!0),e("div",null,[Et,u(e("input",{"onUpdate:modelValue":s[13]||(s[13]=o=>l(t).title=o),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[v,l(t).title]])]),e("div",null,[Mt,u(e("textarea",{"onUpdate:modelValue":s[14]||(s[14]=o=>l(t).description=o),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[v,l(t).description]])]),e("div",null,[St,u(e("select",{"onUpdate:modelValue":s[15]||(s[15]=o=>l(t).product_id=o),class:"block w-full rounded-md border-gray-300 shadow-sm"},[It,(d(!0),i(k,null,S(b.products,o=>(d(),i("option",{key:o.id,value:o.id},p(o.name),9,At))),128))],512),[[J,l(t).product_id]])]),e("div",null,[e("label",Ut,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[16]||(s[16]=o=>l(t).show_buy_button=o),class:"rounded border-gray-300 text-blue-600"},null,512),[[I,l(t).show_buy_button]]),jt])]),e("div",null,[Dt,u(e("input",{"onUpdate:modelValue":s[17]||(s[17]=o=>l(t).order=o),type:"number",min:"0",class:"block w-full rounded-md border-gray-300 shadow-sm"},null,512),[[v,l(t).order,void 0,{number:!0}]])]),e("div",null,[e("label",Pt,[u(e("input",{type:"checkbox","onUpdate:modelValue":s[18]||(s[18]=o=>l(t).is_active=o),class:"rounded border-gray-300 text-blue-600"},null,512),[[I,l(t).is_active]]),$t])])]),e("div",Bt,[r(E,{type:"button",onClick:s[19]||(s[19]=o=>x.value=!1)},{default:n(()=>[c(" Cancelar ")]),_:1}),r(V,{type:"submit",disabled:l(t).processing},{default:n(()=>[c(" Guardar ")]),_:1},8,["disabled"])])],32)])]),_:1},8,["show"]),r(U,{show:h.value,onClose:s[22]||(s[22]=o=>h.value=!1)},{default:n(()=>[e("div",Tt,[Gt,Nt,e("div",qt,[r(E,{onClick:s[21]||(s[21]=o=>h.value=!1)},{default:n(()=>[c(" Cancelar ")]),_:1}),r(N,{onClick:O,disabled:l(t).processing},{default:n(()=>[c(" Eliminar ")]),_:1},8,["disabled"])])])]),_:1},8,["show"])]),_:1})],64))}};export{Rt as default};
