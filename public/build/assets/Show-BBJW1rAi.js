import{r as g,c as O,p as k,q as N,a as r,o as n,b as u,u as m,h as $,d as p,e,F as b,i as f,f as V,t,m as y,n as j,s as M,g as P,x as q,l as z,j as L}from"./app-1McBFp1T.js";import{_ as F}from"./AuthenticatedLayout-D7Yb8bmF.js";import{_ as T}from"./AlertModal-DiQ7T1JD.js";import"./Modal-GP-28cde.js";const B={class:"flex items-center space-x-4"},I={class:"font-semibold text-xl text-gray-800 leading-tight"},A={class:"py-12"},R={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-8"},U={class:"lg:col-span-2 space-y-8"},G={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},H={class:"p-6"},J=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Productos en la Orden",-1),K={class:"divide-y divide-gray-200"},Q={class:"flex-grow"},W={class:"font-bold text-gray-900"},X={key:0,class:"text-sm text-gray-600 mt-1"},Y={class:"font-semibold"},Z={class:"text-sm text-gray-500 mt-2"},ee={class:"font-semibold text-gray-800 shrink-0 ml-4"},te={class:"border-t border-gray-200 pt-4 mt-4 text-right"},se={class:"text-2xl font-bold"},oe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ae={class:"p-6"},de=e("h3",{class:"text-lg font-semibold border-b pb-4 mb-4"},"Datos del Cliente",-1),le={class:"mt-4 space-y-4 text-gray-700"},re=e("p",{class:"font-semibold text-sm text-gray-500"},"Nombre:",-1),ne=e("p",{class:"font-semibold text-sm text-gray-500"},"Teléfono:",-1),ie=e("p",{class:"font-semibold text-sm text-gray-500"},"Correo:",-1),ce=e("p",{class:"font-semibold text-sm text-gray-500"},"Dirección:",-1),ue={class:"space-y-8"},me={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},_e={class:"p-6"},he=e("h3",{class:"text-lg font-semibold mb-4"},"Estado del Pedido",-1),pe={class:"text-center mb-4"},ge={class:"text-sm text-center text-gray-500"},be={class:"mt-6 border-t pt-6"},ve=e("label",{for:"status",class:"block font-medium text-sm text-gray-700 mb-2"},"Cambiar Estado",-1),xe=e("option",{value:"recibido"},"Recibido",-1),fe=e("option",{value:"en_preparacion"},"En Preparación",-1),ye=e("option",{value:"despachado"},"Despachado",-1),we=e("option",{value:"entregado"},"Entregado",-1),Ce=e("option",{value:"cancelado"},"Cancelado",-1),Se=[xe,fe,ye,we,Ce],Ee=["disabled"],De=e("div",{class:"p-6"},[e("div",{class:"mt-6 flex justify-end"})],-1),Ve={__name:"Show",props:{order:Object},setup(s){const l=g(!1),_=g(""),h=g(""),i=s,w=a=>{const d={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(a).toLocaleDateString("es-CO",d)},v=O(()=>({recibido:{text:"Recibido",class:"bg-yellow-100 text-yellow-800"},en_preparacion:{text:"En Preparación",class:"bg-blue-100 text-blue-800"},despachado:{text:"Despachado",class:"bg-purple-100 text-purple-800"},entregado:{text:"Entregado",class:"bg-green-100 text-green-800"},cancelado:{text:"Cancelado",class:"bg-red-100 text-red-800"}})[i.order.status]||{text:i.order.status,class:"bg-gray-100 text-gray-800"}),c=k({status:i.order.status}),C=()=>{const a=c.status;c.put(route("admin.orders.update",i.order.id),{preserveScroll:!0,onSuccess:()=>{_.value="Estado actualizado",h.value="El estado de la orden se guardó correctamente.",l.value=!0,(a==="despachado"||a==="entregado")&&S()}})},S=()=>{L.post(route("admin.orders.confirm",i.order.id),{},{preserveScroll:!0,onSuccess:()=>{_.value="Venta confirmada",h.value="Inventario actualizado correctamente.",l.value=!0},onError:a=>{_.value="Error al confirmar",h.value=Object.values(a).join(`
`),l.value=!0}})};return(a,d)=>{const E=N("Modal");return n(),r(b,null,[u(m($),{title:`Orden #${s.order.sequence_number??s.order.id}`},null,8,["title"]),u(F,null,{header:p(()=>[e("div",B,[u(m(z),{href:a.route("admin.orders.index"),class:"text-blue-600 hover:text-blue-800"},{default:p(()=>[y(" ← Volver a Órdenes ")]),_:1},8,["href"]),e("h2",I," Detalle de la Orden #"+t(s.order.sequence_number??s.order.id),1)])]),default:p(()=>[e("div",A,[e("div",R,[e("div",U,[e("div",G,[e("div",H,[J,e("div",K,[(n(!0),r(b,null,f(s.order.items,o=>(n(),r("div",{key:o.id,class:"py-4 flex justify-between items-start"},[e("div",Q,[e("p",W,t(o.product_name),1),o.variant_options?(n(),r("div",X,[(n(!0),r(b,null,f(o.variant_options,(D,x)=>(n(),r("span",{key:x,class:"mr-2 bg-gray-100 px-2 py-1 rounded"},[e("span",Y,t(x)+":",1),y(" "+t(D),1)]))),128))])):V("",!0),e("p",Z,t(o.quantity)+" x $ "+t(Number(o.unit_price).toLocaleString("es-CO")),1)]),e("p",ee,"$ "+t(Number(o.unit_price*o.quantity).toLocaleString("es-CO")),1)]))),128))]),e("div",te,[e("p",se,"Total: $ "+t(Number(s.order.total_price).toLocaleString("es-CO")),1)])])]),e("div",oe,[e("div",ae,[de,e("div",le,[e("div",null,[re,e("p",null,t(s.order.customer_name),1)]),e("div",null,[ne,e("p",null,t(s.order.customer_phone),1)]),e("div",null,[ie,e("p",null,t(s.order.customer_email),1)]),e("div",null,[ce,e("p",null,t(s.order.customer_address),1)])])])])]),e("div",ue,[e("div",me,[e("div",_e,[he,e("div",pe,[e("span",{class:j(["px-4 py-2 inline-flex text-lg leading-5 font-semibold rounded-full",v.value.class])},t(v.value.text),3)]),e("p",ge," Pedido realizado el: "+t(w(s.order.created_at)),1),e("form",{onSubmit:M(C,["prevent"])},[e("div",be,[ve,P(e("select",{id:"status","onUpdate:modelValue":d[0]||(d[0]=o=>m(c).status=o),class:"block w-full rounded-md shadow-sm border-gray-300"},Se,512),[[q,m(c).status]]),e("button",{type:"submit",disabled:m(c).processing,class:"mt-4 w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 disabled:opacity-50"}," Actualizar Estado ",8,Ee)])],32)])])])])])]),_:1}),u(E,{show:a.confirmingSale,onClose:a.closeSaleModal},{default:p(()=>[De]),_:1},8,["show","onClose"]),u(T,{show:l.value,type:"success",title:_.value,message:h.value,"primary-text":"Entendido",onPrimary:d[1]||(d[1]=o=>l.value=!1),onClose:d[2]||(d[2]=o=>l.value=!1)},null,8,["show","title","message"])],64)}}};export{Ve as default};
